[{"id":714839,"title":"UEFI mixup with previous windows 10 disk on Lenovo","body":"<p>I have a lenovo laptop that originally had one disk with windows 10 using UEFI.\nI decided to replace the HDD with an SSD. Additionally, I replaced my DVD-ROM with an adaptor and put my older windows 10 HDD in there.</p>\n\n<p>I installed linux on the SSD (with the second drive removed) and everything worked fine (UEFI mode). However, when I slide in the second disk, the computer goes into an infinite reboot loop as if it is trying to load from the 2nd drive.</p>\n\n<p>I am only able to boot successfully by pressing the novo button and manually selecting a disk.</p>\n\n<p>However, if I remove the second drive (holding windows 10), everyting works fine. I have tried changing the priority in the bios for UEFI boot order but it makes no difference.</p>\n\n<p>Does anyone have any ideas?</p>\n\n<p>I also tried the utility boot-repair but no luck. Booting from the novo button all the time doesn't seem to be a solution as it's a good way to break that button.</p>\n\n<h2>Update</h2>\n\n<p>Here is the report from boot-repair: <a href=\"http://paste.ubuntu.com/14298897/\" rel=\"nofollow\">http://paste.ubuntu.com/14298897/</a></p>\n\n<p>Is there a chance I could delete the EFI partition from the second disk and solve my problem in that manner?</p>\n\n<h2>Update 2 - tried again</h2>\n\n<p><a href=\"http://paste.ubuntu.com/14299360/\" rel=\"nofollow\">http://paste.ubuntu.com/14299360/</a></p>\n","related_questions":[{"id":714430,"title":"how to configure new disk for UEFI boot using grub2","body":"<p>I am using an ASUS N53J that is currently using MBR boot.  I have enabled UEFI booting in the bios can can seem to boot USB drives that have been configured with gpt tables.  Though I have not figured out how to make use of a dedicated EFI boot partition on the USB drive as yet.</p>\n\n<p>Separately I have connected a second  hdd to the laptop via the external SATA connection, created a gpt partition table, esp boot partition, and the filesystem and swap partitions.</p>\n\n<p>When I run grub-mkconfig on the internal hdd, it finds the new linux image on the external hdd.  I can boot to that external image and confirm that the esp boot partition gets mounted at /boot/efi, so it appears that I should be able to configure grub2.  However, if I run grub-mkconfig when executing from the external drive, its own image does not get found, only the linux and windows images on the internal drive.</p>\n\n<p>I also cannot get efibootmgr to run.  The tutorials I have read either are not clear on both the how and the why so I can troubleshoot myself or use commands that I cannot find in the packages I think they are using.  Does anyone have a good pointer on how to configure the disk before I install it as the primary boot disk?</p>\n\n<p>Thanks.</p>\n\n<p>Update 2015-12-30\nI have progressed to making a USB drive that will at least boot into grub rescue.  I do not know why grub won't run from this drive but it at least allows me to manually boot  to my target OS.  Since I have now booted via a UEFI boot efibootmgr is available.  </p>\n\n<p>I performed a new grub-install targeting the esp partition mounted at /boot/efi.  This completed without errors.  However, when I select the target system for booting the firmware loader stops at a blank screen.  This occurs whether the disk is connected via ESATA or has been moved to be the primary disk in the machine.</p>\n\n<p>the output of efibootmgr -v is:\nmark@mark-N53Jf:~$ efibootmgr -v\nBootCurrent: 0003\nTimeout: 2 seconds\nBootOrder: 0005,0002,0003,0004,0000,0001\nBoot0000  Hard Drive    BBS(HD,,0x0)\nBoot0001  CD/DVD Drive  BBS(CDROM,,0x0)P1: Slimtype BD  E  DS4E1S    .\nBoot0002* ubuntu 15.10  HD(1,GPT,8b6800c2-0b24-4f00-aa66-b1378052604e,0x800,0xfa000)/File(\\bootx64.efi)\nBoot0003* grub  HD(2,GPT,b07e72fd-9168-4924-a17c-b75e55ed685c,0x800,0xfa000)/File(\\Shellx64.efi)\nBoot0004* UEFI: SanDisk Cruzer Micro 1.26   PciRoot(0x0)/Pci(0x1d,0x0)/USB(1,0)/USB(2,0)/HD(2,GPT,b07e72fd-9168-4924-a17c-b75e55ed685c,0x800,0xfa000)\nBoot0005* ubuntu15.10   HD(1,GPT,8b6800c2-0b24-4f00-aa66-b1378052604e,0x800,0xfa000)/File(\\EFI\\ubuntu15.10\\grubx64.efi)</p>\n\n<p>The desired target is Boot0005.  Boot0002 is an experiment copying grubx64.efi to /boot/efi/bootx64.efi.  Both Boot0002 and Boot0005 behave similarly.</p>\n\n<p>Boot0003 (grub) is the USB drive and the only means to boot, though it only starts in grub rescue.</p>\n\n<p>Any ideas where I should explore or what additional information may assist diagnosis?  </p>\n\n<p><strong>More progress:</strong>\ngrub rescue> set<br>\nprefix=(hd0,2)/boot/grub  ... This is the fat32-formatted esp boot partition  </p>\n\n<p>grub rescue>ls (hd0,2)/<br>\nunknown filesystem      ... or similar words to that effect</p>\n\n<p>grub rescue>set prefix=(hd0,1)/boot/grub  ... ext4-formatted partition\ngrub rescue> insmod fat\ngrub rescue>ls (hd0,2)/\n                    .... the directory is now read</p>\n\n<p>setting the root to the target boot system and the prefix to the /boot/grub directory of that target system I can insmod linux search configfile and normal.  If normal does not start the boot option page the following will:<br>\ngrub rescue>configfile /boot/grub/grub.cfg</p>\n\n<p>I can eventually get the target to boot from the menu.</p>\n\n<p>My synopsis is that grubx64.efi on the USB drive is not configured with the necessary modules for the boot method being used.</p>\n\n<p>While efi-booted into my target filesystem I created a new USB drive, also with a gpt partition table, this time with esp boot as partition 1.  I only mention that to assist with reading the bios boot table presented later.</p>\n\n<p>mounting USB partition 2 to an appropriate node:<br>\nmkdir -p /boot/efi\nmount (USB partition 1) to (USB partition 2)/boot/efi\ngrub-install --target=x86_64-efi --efi-directory=(USB partition 2)/boot/efi --removable\n      generates EFI/BOOT/BOOTx64.EFI.  The UEFI: Sandisk entry in the bios  boot table is the means to boot via this loader</p>\n\n<p>grub-install --target=x86_64-efi --efi-directory=(USB partition2)/boot/efi --bootloader-id=USBboot\n     generates EFI/USBboot/grubx64.efi.  The USBboot entry is also written int the bios boot table</p>\n\n<p>cmp -v BOOT/BOOTx64.EFI USBboot/grubx64.efi yields no differences<br>\neither boot option now boots directly to the target filesystem without displaying any grub boot menu.  Since the USB drive does not have a /boot/grub directory or a grub.cfg, grubx64.exe must be configured to search for this directory on the target rather than USB.</p>\n\n<p>efibootmgr -v\nBootOrder: 0007,0004,0005,0002,0003,0008,0000,0001\nBoot0000  Hard Drive    BBS(HD,,0x0)\nBoot0001  CD/DVD Drive  BBS(CDROM,,0x0)P1: Slimtype BD  E  DS4E1S    .\nBoot0002* ubuntu 15.10  HD(1,GPT,8b6800c2-0b24-4f00-aa66-b1378052604e,0x800,0xfa000)/File(\\bootx64.efi)\nBoot0003* grub  HD(2,GPT,b07e72fd-9168-4924-a17c-b75e55ed685c,0x800,0xfa000)/File(\\Shellx64.efi)\nBoot0004* ubuntu_15_10  HD(1,GPT,8b6800c2-0b24-4f00-aa66-b1378052604e,0x800,0xfa000)/File(\\EFI\\ubuntu_15_10\\grubx64.efi)\nBoot0005* ubuntu15.10   HD(1,GPT,8b6800c2-0b24-4f00-aa66-b1378052604e,0x800,0xfa000)/File(\\EFI\\ubuntu15.10\\grubx64.efi)\nBoot0007* USBboot   HD(1,GPT,f887bf87-18a9-40e1-9bca-6c4bfd1cbb4a,0x800,0xc8000)/File(\\EFI\\USBboot\\grubx64.efi)\nBoot0008* UEFI: SanDisk PciRoot(0x0)/Pci(0x1d,0x0)/USB(1,0)/USB(4,0)/HD(1,GPT,f887bf87-18a9-40e1-9bca-6c4bfd1cbb4a,0x800,0xc8000)</p>\n\n<p>I still have not figured out how to even get to grub rescue without booting from the external USB drive.  Is seems as though I have two problems<br>\n1) I don't fully understand how to configure grub for its intended use, how to make sure necessary modules are built in and the prefix is properly set.\n2) I either do not have the bios on the ASUS N53J properly configured or it is not accepting the hard disk configuration as a valid boot configuration.</p>\n\n<p><strong>Any other ideas?  I now this is getting rather long.  How can I document this to be more readable?</strong></p>\n\n<p><strong>Status Update</strong> </p>\n\n<p>Browsing on the web I have discovered grub-mkimage.  I have not started working with this and will report progress once I have done so and can either understand the results or can pose a new question about it.</p>\n"},{"id":650105,"title":"Ubuntu UEFI Dual-Boot without boot repair","body":"<p>I have an HP Pavilion with Windows 8.1 pre-installed. I managed to dual boot Ubuntu 15.04 successfully. Then, I replaced the Windows Boot Loader with the grub loader as default by entering this command in the Windows command prompt:</p>\n\n<p>bcdedit /set \"{bootmgr}\" path \\EFI\\ubuntu\\grubx64.efi</p>\n\n<p>However, I decided to uninstall Ubuntu and unwisely began by deleting the Ubuntu partition from the Windows Disk Manager. Predictably, this led to a corruption in my EFI partition, I could not boot into Windows, and I had to get my HDD replaced. </p>\n\n<p>This time, I want to install Ubuntu and not install the grub loader, instead just booting Ubuntu manually from the boot options during startup. My question is, if I choose to uninstall Ubuntu by deleting partitions again, will I get the same problems with my new scheme i.e. without meddling with the Windows boot process? </p>\n"},{"id":637181,"title":"Ubuntu 15.04 dual boot error with Windows 8.1 with UEFI and SecureBoot","body":"<p>Greeting's, I've tried to install windows 8.1 + ubuntu 15.04 thrice now. But both the time's i'm left with a peculiar problem. I have UEFI and Secureboot enabled. In the UEFI there is no option to disable fastboot, however I have disabled fastboot from windows power options.</p>\n\n<p>I am installing windows 8.1 x64 first. I create a partition for windows and 1 for data. I let the installation complete and reboot using windows. Post first boot, i do another restart without making any changes to the system. Post second login - I selected advance option under update and recovery menu to boot from CD/DVD.</p>\n\n<p>Once I've booted into Ubuntu DVD (as mentioned earlier, I do this through windows options and not by UEFI to BIOS and enabling CD/DVD option) I have non-formatted space on the HDD on which I install Ubuntu. I follow the graphic install. I select install ubuntu besides windows installer. Only custom option I enable is encrypting my home folder. Installation completes error free.</p>\n\n<p>However post installation when I reboot and select windows from ubuntu's bootloader (GNU GRUB), it gives me an error about missing image and hence is unable to boot into windows.</p>\n\n<p>Here is the real mystery, when I change boot options from  UEFI settings to include windows bootloader above Ubuntu. Windows boots perfectly! and same way if i change to Ubuntu - even it loads perfectly!</p>\n\n<p>Here is bit of the text from the entire error:</p>\n\n<p>/Endentire \nFile Path: ACPI (file path to a efi image)</p>\n\n<p>Error: cannot load image</p>\n\n<p>Here is an upload of the image - <a href=\"http://s27.postimg.org/hu4pyksf7/Ubuntu_Dual_Boot.jpg\" rel=\"nofollow\">http://s27.postimg.org/hu4pyksf7/Ubuntu_Dual_Boot.jpg</a></p>\n\n<p>Thank you for all the help till now guys! Here is the URL to boot-repair report: paste.ubuntu.com/11734144</p>\n\n<p>Any idea WHY!</p>\n\n<p>PS: I've checked disc for defects and even tried installing once with a USB stick created using  pendrive linux.</p>\n"},{"id":611031,"title":"problem dual-booting Windows with EFI and 2 hard disks","body":"<p>I've searched everywhere for answers to the problems I'm having, and can't find a solution. I hope someone here can help.</p>\n\n<p>I have a Thinkpad T420 with two hard disks. The first hard disk is internal and contains Windows 10 Technical Preview. The second hard disk is in the DVD bay, and contains Ubuntu. I have reinstalled both operating systems multiple times trying to get this to work. One time I managed to boot Ubuntu, but then Windows was invisible. At this point I can boot Windows, but not Ubuntu.</p>\n\n<p>I'm using EFI, not BIOS. The second disk, with Ubuntu, is partitioned as follows:</p>\n\n<p>(1) Space for BIOS (bios-grub flag) because boot-repair insisted. But when I reinstalled with this partition, boot-repair deleted everything in it.</p>\n\n<p>(2) EFI partition (about 1GB), boot flag.</p>\n\n<p>(3) Swap partition, about 10GB because I have 8GB of RAM. I didn't want to include this because it's an SSD drive, but dire warnings from the Ubuntu install program caused me to include it.</p>\n\n<p>(4) Root, mounted at /.</p>\n\n<p>The first time I did this, I could boot Ubuntu, but Windows was no where to be found. I tried adding Windows to the Grub menu with custom_40 (then run update-grub), but it was (and still is) completely ignored. This is another problem - maybe I should post it separately.</p>\n\n<p>I reinstalled Windows 10, and now Ubuntu is on the Windows boot menu (did boot-repair put it there?). When I choose Ubuntu, the Grub menu comes up. But when I choose Ubuntu (first item) from this menu, it fails to boot. I get the message, \"Booting in insecure mode\", and then it hangs.</p>\n\n<p>This ThinkPad originally came with Windows 7, and it does not have Secure Mode to turn off - no secure mode.</p>\n\n<p>I've tried every boot-repair option, and it is not set up to handle this configuration. I need to edit the Windows and Grub bootloaders manually somehow, but I don't know enough about them to know what's wrong or how to fix it.</p>\n\n<p>Here is the output from boot-repair. I wish I knew what any of it meant. I've spent hours and hours on this. Can anyone help me?</p>\n\n<p>Forget that - I can't paste it here because it's too long. Also, I don't know how to put this in a code block - I'm not going to manually type spaces in front of each line! Here's the link:</p>\n\n<p><a href=\"http://paste.ubuntu.com/10842921\" rel=\"nofollow\">http://paste.ubuntu.com/10842921</a></p>\n"},{"id":499304,"title":"Dual Booting Ubuntu 14.04 from Windows 8 Issues NO ANSWER ANYWHERE","body":"<p>I'm having so many issues installing booting Ubuntu 14.04 on a machine that I installed Windows 8.1 on first.</p>\n\n<p>I created a bootable USB drive, went through the Ubuntu installation setup, and then when I finished I restarted the computer and only the Ubuntu option.</p>\n\n<p>However, the GRUB menu for Ubuntu was the same as the menu pre-installation. The options were \"Try Ubuntu before Install\" and \"Install Ubuntu.\" I removed the USB drive, and after restarting there was no Ubuntu option. Booted directly into Windows 8.</p>\n\n<p>I've tried pretty much everything on the internet, I've boiled my problems down to (I think):\n-Not being able to turn of secure boot. Everyone says enter the windows 8 boot menu and click \"UEFI Firmware Settings,\" but I have no option for that, it doesn't appear in the area it should. Windows is on BIOS Legacy, I think, and when I tried to alter the BIOS setup to just UEFI it wouldn't detect either of Windows or Ubuntu. There is also no option to change secure boot in my BIOS.\n-When I change the order boot options (I have 2 drives, one ssd with Windows 8, and I installed Ubuntu onto partitions of my 1 TB hdd) to start with the hdd first, it doesn't find any operating system.</p>\n\n<p>When I reinsert the USB the grub menu opens up, I can enter the trial version of Ubuntu and if I try to go through reinstall, it informs me that it is already installed. </p>\n\n<p>Any help would be appreciated!</p>\n"},{"id":452835,"title":"Problem while Dual booting windows 8 pro with Ubuntu 13.10","body":"<p>I have a HP Pavilion-15-n004tx laptop. It supports UEFI. However when i installed Windows 8 on it, i disabled the UEFI and installed the Windows in <strong>Legacy</strong> BIOS mode. I wanted to dual boot it with Ubuntu 13.10. I read the Instructions from <a href=\"http://www.everydaylinuxuser.com/2013/09/install-ubuntu-linux-alongside-windows.html\" rel=\"nofollow\">this link.</a> </p>\n\n<p>Now when i tried the live USB then in 'Try Ubuntu without installing' mode , i got the error saying that 'Your system is running in low graphics'. I tried Troubleshooting the problem after reading many questions from this site. They implied that i had to first install the Ubuntu and then open it in Recovery mode.</p>\n\n<p>So when i tried Installing Ubuntu, everything worked fine and Ubuntu 13.10 was successfully installed on my system but when i rebooted the computer then i didn't get any GRUB menu and Windows 8 started automatically. So i made live USB of <strong>BOOT-REPAIR</strong> and ran it. But it didn't solve the problem as instead of GRUB menu, Windows 8 started <strong>automatically like before</strong>. How can i get the GRUB menu to select between Windows and Ubuntu.</p>\n\n<p>I am attaching the <strong>boot-info summary</strong> given by Boot-Repair. Additionally i am uploading the result of 'msinfo32' command in Windows. I am also uploading the Screen obtained while installation of Ubuntu at 'Something Else'.</p>\n\n<p>I would be really obliged to anyone who can help me solve this problem. Thanks in advance.</p>\n\n<p>PS: I am unable to attach Photos so i am providing the links . Thanks! </p>\n\n<p>The link for Boot Info Summary is : \n<a href=\"http://m.uploadedit.com/b033/139817354978.txt\" rel=\"nofollow\">Boot Info Log</a></p>\n"},{"id":403920,"title":"Windows 8.1 repeatedly corrupts GRUB UEFI boot manager","body":"<p>I am trying to get a dual boot Windows 8.1 / Ubuntu Precise installation.  My laptop is a Sony SVT1313Z9ES.  It seems to have a buggy UEFI implementation that always looks for <code>EFI/Microsoft/Boot/bootmgfw.efi</code> regardless of the configured UEFI boot manager.  I have installed Windows 8.1 and Ubuntu and have both EFI managers in my EFI filesystem.</p>\n\n<p>After extensive reading I have tried replacing <code>bootmgfw.efi</code> -- and also the bootmanager in <code>EFI/Boot</code> -- with the GRUB boot manager, <code>grubx64.efi</code>.  This works fine, until I boot Windows from GRUB.  Windows boots fine, but then after shutting down for the first time I find the bootmanager has been damaged.  It looks like Windows 8.1 has tried to replace the GRUB boot manager with its own, and failed to write it somehow.  The FAT32 filesystem that contains the EFI files is damaged.  <code>fsck.vfat</code> reports <code>Free cluster summary wrong</code>, and running <code>md5sum</code> on the EFI file reports <code>Input/output error</code>.  All other files on the EFI filesystem are undamaged, only the currently active boot manager is affected.</p>\n\n<p>FWIW, my EFI partition is a 512MB GPT partition at the very end of the disk -- but with a lot of free space, around 450MB.  Could the partition being so close to the end of the drive cause any problems?</p>\n\n<p>How can I prevent Windows from messing up the boot manager in this way?</p>\n"},{"id":393713,"title":"Windows entry(UEFI) deleted, after installing ubuntu in legacy mode","body":"<p>I haven't found similar posts anywhere so I would be grateful for any help.</p>\n\n<p>I've seen a couple of machines run Ubuntu using legacy mode and Windows using UEFI boot. This requires a switch of boot options in BIOS, which I'm OK with. So the behavior that I'm looking for is exactly this, in legacy mode, boot ubuntu, in UEFI mode, boot windows provided I make the BIOS switch at startup.</p>\n\n<p>However, after a series of installations and running boot-repair, which i've explained below, I can only boot ubuntu in the legacy mode and when I switch to UEFI mode, I go to grub rescue because it says \"no file found\". Now I can't boot into windows in any mode!</p>\n\n<p>This is the sequence that caused this.\n-Windows 8 x64 preinstalled\n-Tried installing ubuntu in uefi, ran boot repair and this seemed to delete everything.\n-Reinstalled ubuntu in legacy mode, ran boot repair which doesn't work in the legacy mode</p>\n\n<p>Now only ubuntu in legacy mode works. There is no grub menu at all in the uefi mode.</p>\n\n<p>Here is the link to my boot info\n<a href=\"http://paste.ubuntu.com/6608333/\" rel=\"nofollow\">http://paste.ubuntu.com/6608333/</a></p>\n\n<p>How can I add a boot menu in the uefi mode while still having my ubuntu running in legacy mode.</p>\n"},{"id":281735,"title":"How to boot over multiple drives on a UEFI motherboard using Grub2","body":"<p>I have an SSD and a HDD, on a UEFI Motherboard. I can switch OS by changing boot order in BIOS, but I would prefer it if Grub2 simply listed Windows7 as a boot option.</p>\n\n<p>Solving should help anyone who has more than one drive on a UEFI motherboard. Have seen <a href=\"http://askubuntu.com/questions/231306/booting-multiple-oss-from-multiple-disks-with-uefi\">Booting multiple OSs from multiple disks with UEFI</a> and rEFInd looks to be a good alternative; this question is about how to correctly configure Grub2 to see the bootloader for Windows7 (or any OS), if at all possible - without using Grub-legacy or another tool such as rEFInd.</p>\n\n<p>I am using Ubuntu 12.10 with Grub2 is on the SSD, the primary boot device, and Windows7 is on the HDD, which it decided to split into three partitions as it installed.</p>\n\n<p>Boot info script gives a lengthy breakdown:</p>\n\n<pre><code>                  Boot Info Script 0.61      [1 April 2012]\n\n\n============================= Boot Info Summary: ===============================\n\n =&gt; Grub2 (v1.99) is installed in the MBR of /dev/sda and looks at sector 1 of \n    the same hard drive for core.img. core.img is at this location and looks \n    in partition 72 for .\n =&gt; No boot loader is installed in the MBR of /dev/sdb.\n\nsda1: __________________________________________________________________________\n\n    File system:       ext4\n    Boot sector type:  -\n    Boot sector info: \n    Operating System:  Ubuntu 12.10\n    Boot files:        /boot/grub/grub.cfg /etc/fstab\n\nsda2: __________________________________________________________________________\n\n    File system:       swap\n    Boot sector type:  -\n    Boot sector info: \n\nsdb1: __________________________________________________________________________\n\n    File system:       vfat\n    Boot sector type:  Windows 7: FAT32\n    Boot sector info:  No errors found in the Boot Parameter Block.\n    Operating System:  \n    Boot files:        /efi/Boot/bootx64.efi\n\nsdb2: __________________________________________________________________________\n\n    File system:       \n    Boot sector type:  -\n    Boot sector info: \n    Mounting failed:   mount: unknown filesystem type ''\n\nsdb3: __________________________________________________________________________\n\n    File system:       ntfs\n    Boot sector type:  Windows Vista/7: NTFS\n    Boot sector info:  No errors found in the Boot Parameter Block.\n    Operating System:  Windows 7\n    Boot files:        /Windows/System32/winload.exe\n\n============================ Drive/Partition Info: =============================\n\nDrive: sda _____________________________________________________________________\n\nDisk /dev/sda: 120.0 GB, 120034123776 bytes\n255 heads, 63 sectors/track, 14593 cylinders, total 234441648 sectors\nUnits = sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\n\nPartition  Boot  Start Sector    End Sector  # of Sectors  Id System\n\n/dev/sda1    *          2,048   218,439,679   218,437,632  83 Linux\n/dev/sda2         218,439,680   234,440,703    16,001,024  82 Linux swap / Solaris\n\n\nDrive: sdb _____________________________________________________________________\n\nDisk /dev/sdb: 1000.2 GB, 1000204886016 bytes\n256 heads, 63 sectors/track, 121126 cylinders, total 1953525168 sectors\nUnits = sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 4096 bytes\n\nPartition  Boot  Start Sector    End Sector  # of Sectors  Id System\n\n/dev/sdb1                   1 4,294,967,295 4,294,967,295  ee GPT\n\n/dev/sdb1 ends after the last sector of /dev/sdb\n\nGUID Partition Table detected.\n\nPartition    Start Sector    End Sector  # of Sectors System\n/dev/sdb1           2,048       206,847       204,800 EFI System partition\n/dev/sdb2         206,848       468,991       262,144 Microsoft Reserved Partition (Windows)\n/dev/sdb3         468,992 1,953,523,711 1,953,054,720 Data partition (Windows/Linux)\n\n\"blkid\" output: ________________________________________________________________\n\nDevice           UUID                                   TYPE       LABEL\n\n/dev/sda1        e20b187a-c3b0-45e1-98df-c955b3cffdde   ext4       \n/dev/sda2        7663b629-19c9-49fc-a744-2beb2dcdb317   swap       \n/dev/sdb1        F428-FB77                              vfat       \n/dev/sdb3        162C36632C363DD5                       ntfs       \n\n================================ Mount points: =================================\n\nDevice           Mount_Point              Type       Options\n\n/dev/sda1        /                        ext4       (rw,errors=remount-ro)\n\n\n=========================== sda1/boot/grub/grub.cfg: ===========================\n\n--------------------------------------------------------------------------------\n#\n# DO NOT EDIT THIS FILE\n#\n# It is automatically generated by grub-mkconfig using templates\n# from /etc/grub.d and settings from /etc/default/grub\n#\n\n### BEGIN /etc/grub.d/00_header ###\nif [ -s $prefix/grubenv ]; then\n  set have_grubenv=true\n  load_env\nfi\nset default=\"0\"\n\nif [ x\"${feature_menuentry_id}\" = xy ]; then\n  menuentry_id_option=\"--id\"\nelse\n  menuentry_id_option=\"\"\nfi\n\nexport menuentry_id_option\n\nif [ \"${prev_saved_entry}\" ]; then\n  set saved_entry=\"${prev_saved_entry}\"\n  save_env saved_entry\n  set prev_saved_entry=\n  save_env prev_saved_entry\n  set boot_once=true\nfi\n\nfunction savedefault {\n  if [ -z \"${boot_once}\" ]; then\n    saved_entry=\"${chosen}\"\n    save_env saved_entry\n  fi\n}\n\nfunction recordfail {\n  set recordfail=1\n  if [ -n \"${have_grubenv}\" ]; then if [ -z \"${boot_once}\" ]; then save_env recordfail; fi; fi\n}\n\nfunction load_video {\n  if [ x$feature_all_video_module = xy ]; then\n    insmod all_video\n  else\n    insmod efi_gop\n    insmod efi_uga\n    insmod ieee1275_fb\n    insmod vbe\n    insmod vga\n    insmod video_bochs\n    insmod video_cirrus\n  fi\n}\n\nterminal_input console\nterminal_output console\nif [ \"${recordfail}\" = 1 ]; then\n  set timeout=-1\nelse\n  set timeout=6\nfi\n### END /etc/grub.d/00_header ###\n\n### BEGIN /etc/grub.d/05_debian_theme ###\nset menu_color_normal=white/black\nset menu_color_highlight=black/light-gray\nif background_color 44,0,30; then\n  clear\nfi\n### END /etc/grub.d/05_debian_theme ###\n\n### BEGIN /etc/grub.d/10_linux ###\nfunction gfxmode {\n  set gfxpayload=\"${1}\"\n  if [ \"${1}\" = \"keep\" ]; then\n    set vt_handoff=vt.handoff=7\n  else\n    set vt_handoff=\n  fi\n}\nif [ \"${recordfail}\" != 1 ]; then\n  if [ -e ${prefix}/gfxblacklist.txt ]; then\n    if hwmatch ${prefix}/gfxblacklist.txt 3; then\n      if [ ${match} = 0 ]; then\n        set linux_gfx_mode=keep\n      else\n        set linux_gfx_mode=text\n      fi\n    else\n      set linux_gfx_mode=text\n    fi\n  else\n    set linux_gfx_mode=keep\n  fi\nelse\n  set linux_gfx_mode=text\nfi\nexport linux_gfx_mode\nif [ \"${linux_gfx_mode}\" != \"text\" ]; then load_video; fi\nmenuentry 'Ubuntu' --class ubuntu --class gnu-linux --class gnu --class os $menuentry_id_option 'gnulinux-simple-e20b187a-c3b0-45e1-98df-c955b3cffdde' {\nrecordfail\n  gfxmode $linux_gfx_mode\n  insmod gzio\n  insmod part_msdos\n  insmod ext2\n  set root='hd0,msdos1'\n  if [ x$feature_platform_search_hint = xy ]; then\n    search --no-floppy --fs-uuid --set=root --hint-bios=hd0,msdos1 --hint-efi=hd0,msdos1 --hint-baremetal=ahci0,msdos1  e20b187a-c3b0-45e1-98df-c955b3cffdde\n  else\n    search --no-floppy --fs-uuid --set=root e20b187a-c3b0-45e1-98df-c955b3cffdde\n  fi\n  linux /boot/vmlinuz-3.5.0-27-generic root=UUID=e20b187a-c3b0-45e1-98df-c955b3cffdde ro   quiet splash $vt_handoff\n  initrd  /boot/initrd.img-3.5.0-27-generic\n}\nsubmenu 'Advanced options for Ubuntu' $menuentry_id_option 'gnulinux-advanced-e20b187a-c3b0-45e1-98df-c955b3cffdde' {\n  menuentry 'Ubuntu, with Linux 3.5.0-27-generic' --class ubuntu --class gnu-linux --class gnu --class os $menuentry_id_option 'gnulinux-3.5.0-27-generic-advanced-e20b187a-c3b0-45e1-98df-c955b3cffdde' {\n  recordfail\n    gfxmode $linux_gfx_mode\n    insmod gzio\n    insmod part_msdos\n    insmod ext2\n    set root='hd0,msdos1'\n    if [ x$feature_platform_search_hint = xy ]; then\n      search --no-floppy --fs-uuid --set=root --hint-bios=hd0,msdos1 --hint-efi=hd0,msdos1 --hint-baremetal=ahci0,msdos1  e20b187a-c3b0-45e1-98df-c955b3cffdde\n    else\n      search --no-floppy --fs-uuid --set=root e20b187a-c3b0-45e1-98df-c955b3cffdde\n    fi\n    echo  'Loading Linux 3.5.0-27-generic ...'\n    linux /boot/vmlinuz-3.5.0-27-generic root=UUID=e20b187a-c3b0-45e1-98df-c955b3cffdde ro   quiet splash $vt_handoff\n    echo  'Loading initial ramdisk ...'\n    initrd  /boot/initrd.img-3.5.0-27-generic\n  }\n  menuentry 'Ubuntu, with Linux 3.5.0-27-generic (recovery mode)' --class ubuntu --class gnu-linux --class gnu --class os $menuentry_id_option 'gnulinux-3.5.0-27-generic-recovery-e20b187a-c3b0-45e1-98df-c955b3cffdde' {\n  recordfail\n    insmod gzio\n    insmod part_msdos\n    insmod ext2\n    set root='hd0,msdos1'\n    if [ x$feature_platform_search_hint = xy ]; then\n      search --no-floppy --fs-uuid --set=root --hint-bios=hd0,msdos1 --hint-efi=hd0,msdos1 --hint-baremetal=ahci0,msdos1  e20b187a-c3b0-45e1-98df-c955b3cffdde\n    else\n      search --no-floppy --fs-uuid --set=root e20b187a-c3b0-45e1-98df-c955b3cffdde\n    fi\n    echo  'Loading Linux 3.5.0-27-generic ...'\n    linux /boot/vmlinuz-3.5.0-27-generic root=UUID=e20b187a-c3b0-45e1-98df-c955b3cffdde ro recovery nomodeset \n    echo  'Loading initial ramdisk ...'\n    initrd  /boot/initrd.img-3.5.0-27-generic\n  }\n  menuentry 'Ubuntu, with Linux 3.5.0-26-generic' --class ubuntu --class gnu-linux --class gnu --class os $menuentry_id_option 'gnulinux-3.5.0-26-generic-advanced-e20b187a-c3b0-45e1-98df-c955b3cffdde' {\n  recordfail\n    gfxmode $linux_gfx_mode\n    insmod gzio\n    insmod part_msdos\n    insmod ext2\n    set root='hd0,msdos1'\n    if [ x$feature_platform_search_hint = xy ]; then\n      search --no-floppy --fs-uuid --set=root --hint-bios=hd0,msdos1 --hint-efi=hd0,msdos1 --hint-baremetal=ahci0,msdos1  e20b187a-c3b0-45e1-98df-c955b3cffdde\n    else\n      search --no-floppy --fs-uuid --set=root e20b187a-c3b0-45e1-98df-c955b3cffdde\n    fi\n    echo  'Loading Linux 3.5.0-26-generic ...'\n    linux /boot/vmlinuz-3.5.0-26-generic root=UUID=e20b187a-c3b0-45e1-98df-c955b3cffdde ro   quiet splash $vt_handoff\n    echo  'Loading initial ramdisk ...'\n    initrd  /boot/initrd.img-3.5.0-26-generic\n  }\n  menuentry 'Ubuntu, with Linux 3.5.0-26-generic (recovery mode)' --class ubuntu --class gnu-linux --class gnu --class os $menuentry_id_option 'gnulinux-3.5.0-26-generic-recovery-e20b187a-c3b0-45e1-98df-c955b3cffdde' {\n  recordfail\n    insmod gzio\n    insmod part_msdos\n    insmod ext2\n    set root='hd0,msdos1'\n    if [ x$feature_platform_search_hint = xy ]; then\n      search --no-floppy --fs-uuid --set=root --hint-bios=hd0,msdos1 --hint-efi=hd0,msdos1 --hint-baremetal=ahci0,msdos1  e20b187a-c3b0-45e1-98df-c955b3cffdde\n    else\n      search --no-floppy --fs-uuid --set=root e20b187a-c3b0-45e1-98df-c955b3cffdde\n    fi\n    echo  'Loading Linux 3.5.0-26-generic ...'\n    linux /boot/vmlinuz-3.5.0-26-generic root=UUID=e20b187a-c3b0-45e1-98df-c955b3cffdde ro recovery nomodeset \n    echo  'Loading initial ramdisk ...'\n    initrd  /boot/initrd.img-3.5.0-26-generic\n  }\n  menuentry 'Ubuntu, with Linux 3.5.0-17-generic' --class ubuntu --class gnu-linux --class gnu --class os $menuentry_id_option 'gnulinux-3.5.0-17-generic-advanced-e20b187a-c3b0-45e1-98df-c955b3cffdde' {\n  recordfail\n    gfxmode $linux_gfx_mode\n    insmod gzio\n    insmod part_msdos\n    insmod ext2\n    set root='hd0,msdos1'\n    if [ x$feature_platform_search_hint = xy ]; then\n      search --no-floppy --fs-uuid --set=root --hint-bios=hd0,msdos1 --hint-efi=hd0,msdos1 --hint-baremetal=ahci0,msdos1  e20b187a-c3b0-45e1-98df-c955b3cffdde\n    else\n      search --no-floppy --fs-uuid --set=root e20b187a-c3b0-45e1-98df-c955b3cffdde\n    fi\n    echo  'Loading Linux 3.5.0-17-generic ...'\n    linux /boot/vmlinuz-3.5.0-17-generic root=UUID=e20b187a-c3b0-45e1-98df-c955b3cffdde ro   quiet splash $vt_handoff\n    echo  'Loading initial ramdisk ...'\n    initrd  /boot/initrd.img-3.5.0-17-generic\n  }\n  menuentry 'Ubuntu, with Linux 3.5.0-17-generic (recovery mode)' --class ubuntu --class gnu-linux --class gnu --class os $menuentry_id_option 'gnulinux-3.5.0-17-generic-recovery-e20b187a-c3b0-45e1-98df-c955b3cffdde' {\n  recordfail\n    insmod gzio\n    insmod part_msdos\n    insmod ext2\n    set root='hd0,msdos1'\n    if [ x$feature_platform_search_hint = xy ]; then\n      search --no-floppy --fs-uuid --set=root --hint-bios=hd0,msdos1 --hint-efi=hd0,msdos1 --hint-baremetal=ahci0,msdos1  e20b187a-c3b0-45e1-98df-c955b3cffdde\n    else\n      search --no-floppy --fs-uuid --set=root e20b187a-c3b0-45e1-98df-c955b3cffdde\n    fi\n    echo  'Loading Linux 3.5.0-17-generic ...'\n    linux /boot/vmlinuz-3.5.0-17-generic root=UUID=e20b187a-c3b0-45e1-98df-c955b3cffdde ro recovery nomodeset \n    echo  'Loading initial ramdisk ...'\n    initrd  /boot/initrd.img-3.5.0-17-generic\n  }\n}\n\n### END /etc/grub.d/10_linux ###\n\n### BEGIN /etc/grub.d/20_linux_xen ###\n\n### END /etc/grub.d/20_linux_xen ###\n\n### BEGIN /etc/grub.d/30_os-prober ###\n### END /etc/grub.d/30_os-prober ###\n\n### BEGIN /etc/grub.d/30_uefi-firmware ###\n### END /etc/grub.d/30_uefi-firmware ###\n\n### BEGIN /etc/grub.d/40_custom ###\n# This file provides an easy way to add custom menu entries.  Simply type the\n# menu entries you want to add after this comment.  Be careful not to change\n# the 'exec tail' line above.\n### END /etc/grub.d/40_custom ###\n\n### BEGIN /etc/grub.d/41_custom ###\nif [ -f  ${config_directory}/custom.cfg ]; then\n  source ${config_directory}/custom.cfg\nelif [ -z \"${config_directory}\" -a -f  $prefix/custom.cfg ]; then\n  source $prefix/custom.cfg;\nfi\n### END /etc/grub.d/41_custom ###\n--------------------------------------------------------------------------------\n\n=============================== sda1/etc/fstab: ================================\n\n--------------------------------------------------------------------------------\n# /etc/fstab: static file system information.\n#\n# Use 'blkid' to print the universally unique identifier for a\n# device; this may be used with UUID= as a more robust way to name devices\n# that works even if disks are added and removed. See fstab(5).\n#\n# &lt;file system&gt; &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;       &lt;dump&gt;  &lt;pass&gt;\n# / was on /dev/sda1 during installation\nUUID=e20b187a-c3b0-45e1-98df-c955b3cffdde /               ext4    errors=remount-ro 0       1\n# swap was on /dev/sda2 during installation\nUUID=7663b629-19c9-49fc-a744-2beb2dcdb317 none            swap    sw              0       0\n--------------------------------------------------------------------------------\n\n=================== sda1: Location of files loaded by Grub: ====================\n\n           GiB - GB             File                                 Fragment(s)\n\n               =                boot/grub/grub.cfg                             1\n               =                boot/initrd.img-3.5.0-17-generic               1\n               =                boot/initrd.img-3.5.0-26-generic               1\n               =                boot/initrd.img-3.5.0-27-generic               1\n               =                boot/vmlinuz-3.5.0-17-generic                  1\n               =                boot/vmlinuz-3.5.0-26-generic                  1\n               =                boot/vmlinuz-3.5.0-27-generic                  2\n               =                initrd.img                                     1\n               =                initrd.img.old                                 1\n               =                vmlinuz                                        2\n               =                vmlinuz.old                                    2\n\n=============================== StdErr Messages: ===============================\n\nawk: cmd. line:36: Math support is not compiled in\nawk: cmd. line:36: Math support is not compiled in\nawk: cmd. line:36: Math support is not compiled in\nawk: cmd. line:36: Math support is not compiled in\nawk: cmd. line:36: Math support is not compiled in\nawk: cmd. line:36: Math support is not compiled in\nawk: cmd. line:36: Math support is not compiled in\nawk: cmd. line:36: Math support is not compiled in\nawk: cmd. line:36: Math support is not compiled in\nawk: cmd. line:36: Math support is not compiled in\nawk: cmd. line:36: Math support is not compiled in\n</code></pre>\n\n<p>In summary, Ubuntu has a swap partition (sda2) in addition to its root partition (sda1) where it resides. Everything is fine there. Windows7 made 3 partitions, the first (sdb1) being for EFI, the second (sdb2) being reserved for windows which is not relevant, the third (sdb3) being the actual windows installation.</p>\n\n<p>The file hierarchy of sdb1 is</p>\n\n<pre><code>&gt; ls -aR\n.:\n.  ..  EFI\n\n./EFI:\n.  ..  Boot  Microsoft\n\n./EFI/Boot:\n.  ..  bootx64.efi\n\n./EFI/Microsoft:\n.  ..  Boot\n\n./EFI/Microsoft/Boot:\n.   BCD      BCD.LOG1  bootmgfw.efi  BOOTSTAT.DAT  da-DK  el-GR  es-ES  Fonts  hu-HU  ja-JP  memtest.efi  nl-NL  pt-BR  ru-RU  tr-TR  zh-HK\n..  BCD.LOG  BCD.LOG2  bootmgr.efi   cs-CZ         de-DE  en-US  fi-FI  fr-FR  it-IT  ko-KR  nb-NO        pl-PL  pt-PT  sv-SE  zh-CN  zh-TW\netc\n</code></pre>\n\n<p>Through using</p>\n\n<pre><code>grub-mkdevicemap\n</code></pre>\n\n<p>The file \"device.map\" was generated in \"/boot/grub\" which identified that the SSD is (hd0) and the HDD is (hd1). hd0 is primary boot device, Grub2 lives here.</p>\n\n<p>In grub-customizer I tried to create an entry which would direct grub2 to the Windows7 bootloader:</p>\n\n<pre><code>set root='(hd1,1)'\nsearch-no-floppy-fs-uuid-set F428-FB77\ndrivemap -s (hd1) ${root}\nchainloader +1\n</code></pre>\n\n<p>However selecting it from grub on restart gave this error:</p>\n\n<pre><code>error: no such device: F428-FB77.\nerror: invalid signature.\n\nPress any key to continue..._\n</code></pre>\n\n<p>Am I close?</p>\n"},{"id":245354,"title":"Grub2 does not have entry of ubuntu 12.10 at boot menu in UEFI system?","body":"<p>I have UEFI based computer (I dont know the UEFI in detail but I guess it is a replacement of BIOS). In the Grub2 boot list there are 3 different Windows entry but none Ubuntu 12.10 entry. I m booting ubuntu by using grub console. I tried to use boot-repair program. When it starts it gives an warning <code>EFI detected. Please check the options.</code>. Then I ignore the warning and choose the <code>Recommended Repair</code> option. However it did not work too. Still no entry on boot list. I tried to use Windows bootloader to deal with the problem by using EASYbcd program but after I add ubuntu entry, windows bootloader failed too and I cannot boot windows now on. I guess my all settings amiss about EFI system. Do I need to do something special to grub with respect to the EFI? What is special about EFI and how can I solve the problem on GRUB?</p>\n\n<p>Here all my grub information generated by BootRepair <a href=\"http://paste.ubuntu.com/1552273/\" rel=\"nofollow\">http://paste.ubuntu.com/1552273/</a></p>\n\n<p>After now, I am getting an error from BootRepair:</p>\n\n<pre><code>An error occurred during the repair.\n\nPlease write on a paper the following URL:\nhttp://paste.ubuntu.com/1552313/\n\nIn case you still experience boot problem, indicate this URL to:\nboot.repair@gmail.com \n\nYou can now reboot your computer.\nPlease do not forget to make your BIOS boot on sda4/EFI/ubuntu/grubx64.efi file!\n\nThe boot files of [The OS now in use - Ubuntu 12.10] are far from the start of the disk. Your BIOS may not detect them. You may want to retry after creating a /boot/efi partition (FAT32, 100MB~250MB, start of the disk, boot flag). This can be performed via tools such as gParted. Then select this partition via the [Separate /boot/efi partition:] option of [Boot Repair].\n</code></pre>\n\n<p>My PC specs:</p>\n\n<pre><code>x64 Ubuntu 12.10\nAsus K55V notebook\nWindows 8 Installed on another partition (Currenty not bootable)\n</code></pre>\n"}]}]