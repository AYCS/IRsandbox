[{"id":711980,"title":"MySQL doesn&#39;t start after reboot","body":"<p>I've got a problem on one of my servers: MySQL doesn't (didn't) start after a reboot. So I have (had) to do a</p>\n\n<pre><code>sudo service mysql start/restart\n</code></pre>\n\n<p>My MySQL-Version:</p>\n\n<pre><code>mysql  Ver 14.14 Distrib 5.5.46, for debian-linux-gnu (x86_64) using readline 6.3\n</code></pre>\n\n<p>I've installed the MySQL-server out of the sources (Ubuntu 14.04).</p>\n\n<p>A</p>\n\n<pre><code>sudo update-rc.d mysql defaults\n</code></pre>\n\n<p>solved the problem that mysql did not get started. But now it is not handled by upstart (?). Because of this</p>\n\n<pre><code>sudo service mysql status\n</code></pre>\n\n<p>shows me</p>\n\n<pre><code>mysql stop/waiting\n</code></pre>\n\n<p>What can I do to solve this properly?</p>\n","related_questions":[{"id":711085,"title":"Service Start Order?","body":"<p>So I have tried reading and reading but I am so lost at this point around upstart. I have this service which exists in /etc/init/nzbdrone.conf. I \"think\" part of this runs upstart and some doesn't maybe so that's why I can't figure this out?</p>\n\n<pre><code>author \"Simon Tallmyr - Nosscire\"\ndescription \"Upstart Script to run Sonarr as a service on Ubuntu/Debian     based s$\n\n#Set username for the process. Should probably be what you use for logging in\nsetuid dulanic\n\nenv DIR=/opt/NzbDrone\n#This is the install directory. If you installed using a deb package or the Son$\n\nsetgid nogroup\npre-start exec sleep 10\nstart on runlevel [2345]\nstop on runlevel [016]\n\nrespawn\n\nexec mono --debug $DIR/NzbDrone.exe\n</code></pre>\n\n<p>I also have this service running under sudo service --status-all. This is a autoinstalled service and I don't know the specifics as to how it runs. It looks like it's in init.d where as nzbdrone is in init?</p>\n\n<p>[ ? ]  raidf</p>\n\n<p>Im not the master of services unfortunately. Here is my issue, raidf needs to mount to a directory that is empty, the problem is nzbdrone creates some files when it loads inside this directory which then prevent raidf from loading. Is there a command I can out within nzbdrone.conf to make it wait for raidf to load? This is the raidf conf.</p>\n\n<pre><code>#! /bin/sh\n\n# By Brahim Bakayoko\n# Adapted from original script by wyld (https://wiki.amahi.org/index.php/FlexRAID)\n### BEGIN INIT INFO\n# Provides:          FlexRAID RAID over File System (RAID-F) Application Instance\n# Required-Start:    $all\n# Required-Stop:     $all\n# Default-Start:     2 3 4 5\n# Default-Stop:      0 1 6\n# Short-Description: starts RAID-F\n# Description:       starts instance of RAID-F using start-stop-daemon\n### END INIT INFO\n\n############### EDIT ME ##################\n\n#Edit installation paths only if you installed to a different path\nHOST_ROOT=/opt/raidf/host\n\n############### END EDIT ME ##################\n\nSHORTNAME=raidf\nNAME=\"RAID over File System (RAID-F)\"\nDESC=\"RAID over File System (RAID-F) Service\"\n\nPATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:$HOST_ROOT\n\ntest -x $DAEMON || exit 0\n\nset -e\n\ncase \"$1\" in\n  start)\n        echo \"Starting $DESC...\"\n                if [ -e \"$HOST_ROOT\" ]; then\n                        start-stop-daemon --start --oknodo --background --chdir $HOST_ROOT --exec FlexRAID\n                        echo \"Started $DESC.\"\n                fi\n        ;;\n  stop)\n        echo \"Stopping $DESC...\"\n                if [ -e \"$HOST_ROOT\" ]; then\n                        start-stop-daemon --stop --oknodo --exec $HOST_ROOT/FlexRAID\n                        echo \"Stopped $DESC.\"\n                Fi\n       ;;\n  restart)\n        echo \"Restarting $DESC...\"\n                if [ -e \"$HOST_ROOT\" ]; then\n                        start-stop-daemon --stop --oknodo --exec $HOST_ROOT/FlexRAID\n                        echo \"Stopped $DESC.\"\n                fi\n        sleep 6\n                if [ -e \"$HOST_ROOT\" ]; then\n                        start-stop-daemon --start --oknodo --background --chdir $HOST_ROOT --exec FlexRAID\n                        echo \"Started $DESC.\"\n                fi\n        ;;\n  *)\n        N=$SHORTNAME\n        echo \"Usage: sudo service $N {start|stop|restart}\" &gt;&amp;2\n        exit 1\n        ;;\nesac\n\nexit 0\n</code></pre>\n"},{"id":62812,"title":"Why isn&#39;t my upstart service starting on system boot?","body":"<p>Following on from <a href=\"http://askubuntu.com/questions/62729/how-do-i-set-up-a-service\">this question</a>, I have written a simple upstart service (<em>/etc/init/pms.conf</em>) for my headless Ubuntu Server 11.04 box as follows:</p>\n\n<pre><code>start on filesystem and net-device-up IFACE=eth0\nstop on runlevel [016]\nrespawn\n\nexec /home/administrator/pms-current/PMS.sh\n</code></pre>\n\n<p>I can start (or stop) this service at will from the command line:</p>\n\n<pre><code>service pms start\n</code></pre>\n\n<p>And I can see that it is indeed running.</p>\n\n<p>However, when I first boot my machine the service does not start. If I SSH into the box and check the service status I get:</p>\n\n<pre><code>$ service pms status\npms stop/waiting\n</code></pre>\n\n<p>My question is why is this happening? Why isn't my service starting on boot?</p>\n\n<p><strong>UPDATE 1</strong>: unsure whether my service was being started and subsequently dying or just wasn't being start at all, I added the following to PMS.sh:</p>\n\n<pre><code>echo \"STARTED\" &gt; $STARTLOG\n</code></pre>\n\n<p>This obviously just gives me <em>something</em> to look for. I tested this by starting the service myself and then checking <em>start.log</em>. I then deleted the <em>start.log</em> and rebooted. It wasn't there after the restart, so it seems as though upstart definitely isn't starting my service. I suppose it could be dying at an earlier point in the process, but that seems rather unlikely given the simplicity of it all.</p>\n\n<p><strong>UPDATE 2</strong>: I've just upgraded to 11.10 which includes an upstart upgrade, but this problem still occurs.</p>\n\n<p><strong>UPDATE 3</strong>: As requested, I've booted with <code>--debug</code>. The output of cat <code>/var/log/syslog | grep init</code> is too long to place in the question, but you view it <a href=\"http://paste.ubuntu.com/719640/\">here</a>.</p>\n\n<p><strong>UPDATE 4</strong>: More logs, this time the upstart conf is included at the top. <a href=\"http://paste.ubuntu.com/719735/\">Run 1</a> and <a href=\"http://paste.ubuntu.com/719737/\">run 2</a>.</p>\n"},{"id":680607,"title":"After updating MySQL password in safe mode, I still cannot login to phpmyadmin","body":"<p><strong>Server info</strong>\nI'm running an Ubuntu 14.04 server with apache and some other goodies installed.</p>\n\n<p><strong>Problem</strong>\nI previously had a plesk trial installed but it expired so I uninstalled it. Ever since then mysql has been messed up. The issue I'm having is that I cannot login to the root user. I think that I may have accidentally skipped the part where I add the password for that user.</p>\n\n<p><strong>Things I've Tried</strong>\nFrom what I understand, I need to stop mysql and start it in safe mode so I do not need to enter a password.</p>\n\n<p>I have used set password for root@localhost\nWhen logged in with the root user in mysql safe mode I tried set password with no user specified, thinking this would edit the current user's password.\nAfter I change the password and restart the mysql server it seems that nothing has been changed.</p>\n\n<p>I have also tried logging into phpmyadmin in safemode and creating another user with all privileges. When safe mode is disabled, these changes are non-existant.</p>\n\n<p>All of my attempts have been made from a remote location.</p>\n\n<p>At this point in time I'm starting to think that I should just reinstall mysql completely so that it can possibly be reset. Should I just restart from scratch? Or shall I give it another try? I think that if I cannot get it to work I will just wipe the server and start again with an open source control panel.</p>\n\n<p>Thanks!</p>\n"},{"id":648998,"title":"Mysql didn&#39;t startup after rebooting","body":"<p>After I rebooted my server, everything started up normally except for \"mysql\", i tried to start it up manually \"<code>/etc/init.d/mysql restart</code>\" or with \"<code>service mysql restart</code>\", it fails</p>\n\n<p>In log file it says:</p>\n\n<pre><code>Jul 16 08:13:38 localhost /etc/init.d/mysql[18136]: error: 'Can't connect to local MySQL server through socket '/var/run/mysqld/mysqld.sock' (2)'\nJul 16 08:13:38 localhost /etc/init.d/mysql[18136]: Check that mysqld is running and that the socket: '/var/run/mysqld/mysqld.sock' exists!\n</code></pre>\n\n<p>I checked that path, but i didn't find that socket file, please advise?</p>\n\n<p><strong>Edit:</strong></p>\n\n<pre><code>root@myserver:/var/log# service mysql restart\n * Stopping MySQL database server mysqld                   [ OK ] \n * Starting MySQL database server mysqld                   [fail]\n</code></pre>\n"},{"id":444393,"title":"Networking doesn&#39;t start after upgrade with new upstart system","body":"<p>I have upgraded to the stable version of ubuntu server and my network doesn't start. There should be some problem with the new upstart service, because the network seems to try to load a dhcp, but i have configured a static ip in the networking configuration files.</p>\n\n<p>I try to run <code>/etc/init.d/networking start</code>, but the response is that this is not the correct command. So I try <code>service networking start</code> and the answer is that the job doesn't exists.</p>\n\n<p>However, I can see the networking file in the <code>init.d</code> and in the <code>init</code> folders. I try <code>service networking status</code> and the process response is that the service is stopped.</p>\n\n<p>I have rebooted the server and the problem persists.</p>\n\n<p>I only get the network working manually with the <code>ifconfig</code> command line</p>\n\n<p>Suggestions?</p>\n"},{"id":430306,"title":"No reaction on service mysql start, init script works","body":"<p>After upgrading Ubuntu from 12.04 to 13.10, the MySQL server (now 5.5) does not start/stop with <code>service mysql start|stop</code>. When typing <code>/etc/init.d/mysql start</code>, everything works fine.</p>\n\n<p>Once it does nothing, when pressing ^C and retrying it says:</p>\n\n<blockquote>\n  <p>start: Job is already running: mysql</p>\n</blockquote>\n\n<p>while it is not.</p>\n\n<p>After trying to start the service with the upstart syntax, I took a look into the <code>htop</code> statuses:</p>\n\n<blockquote>\n  <p>19973 root       20   0  2272   552   480 S  0.0  0.0  0:00.00 /bin/sh /usr/sbin/service mysql restart<br>\n  19979 root       20   0  6280  1064   936 S  0.0  0.0  0:00.00 stop mysql</p>\n</blockquote>\n\n<p>and it stays like this.</p>\n"},{"id":96548,"title":"MySQL doesn&#39;t start due to a missing binary","body":"<p>I need to install mysql 5.6 on my ubuntu machine for development reasons (the newest version contains features that I need to incorporate into some web projects). But I am having some issues. I've been following this tutorial which is not specific for version 5.6 but I figured it would be about the same: <a href=\"http://www.ovaistariq.net/490/a-step-by-step-guide-to-upgrading-to-mysql-5-5/\" rel=\"nofollow\">http://www.ovaistariq.net/490/a-step-by-step-guide-to-upgrading-to-mysql-5-5/</a></p>\n\n<p>I'm not sure if i'm setting up my /etc/my.cnf file properly. Here is what I have:</p>\n\n<pre><code># Example MySQL config file for large systems.\n#\n# This is for a large system with memory = 512M where the system runs mainly\n# MySQL.\n#\n# MySQL programs look for option files in a set of\n# locations which depend on the deployment platform.\n\n# You can copy this option file to one of those\n# locations. For information about these locations, see:\n# http://dev.mysql.com/doc/mysql/en/option-files.html\n#\n# In this file, you can use all long options that a program supports.\n# If you want to know which options a program supports, run the program\n# with the \"--help\" option.\n\n# The following options will be passed to all MySQL clients\n[client]\n#password   = your_password\nport        = 3306\nsocket      = /var/run/mysqld/mysqld.sock\n\n# Here follows entries for some specific programs\n\n# The MySQL server\n[mysqld]\nport        = 3306\nsocket      = /var/run/mysqld/mysqld.sock\nskip-external-locking\nkey_buffer_size = 256M\nmax_allowed_packet = 1M\ntable_open_cache = 256\nsort_buffer_size = 1M\nread_buffer_size = 1M\nread_rnd_buffer_size = 4M\nmyisam_sort_buffer_size = 64M\nthread_cache_size = 8\nquery_cache_size= 16M\npid_file    = /usr/local/mysql/data/dev.pid\nbasedir         = /usr/local/mysql\ndatadir         = /usr/local/mysql/data\ntmpdir          = /tmp\nlog_error       = /var/log/mysql/error.log\nuser        = mysql\n\n# Try number of CPU's*2 for thread_concurrency\nthread_concurrency = 8\n\n# Don't listen on a TCP/IP port at all. This can be a security enhancement,\n# if all processes that need to connect to mysqld run on the same host.\n# All interaction with mysqld must be made via Unix sockets or named pipes.\n# Note that using this option without enabling named pipes on Windows\n# (via the \"enable-named-pipe\" option) will render mysqld useless!\n# \n#skip-networking\n\n# Replication Master Server (default)\n# binary logging is required for replication\nlog-bin=mysql-bin\n\n# binary logging format - mixed recommended\nbinlog_format=mixed\n\n# required unique id between 1 and 2^32 - 1\n# defaults to 1 if master-host is not set\n# but will not function as a master if omitted\nserver-id   = 1\n\n# Replication Slave (comment out master section to use this)\n#\n# To configure this host as a replication slave, you can choose between\n# two methods :\n#\n# 1) Use the CHANGE MASTER TO command (fully described in our manual) -\n#    the syntax is:\n#\n#    CHANGE MASTER TO MASTER_HOST=&lt;host&gt;, MASTER_PORT=&lt;port&gt;,\n#    MASTER_USER=&lt;user&gt;, MASTER_PASSWORD=&lt;password&gt; ;\n#\n#    where you replace &lt;host&gt;, &lt;user&gt;, &lt;password&gt; by quoted strings and\n#    &lt;port&gt; by the master's port number (3306 by default).\n#\n#    Example:\n#\n#    CHANGE MASTER TO MASTER_HOST='125.564.12.1', MASTER_PORT=3306,\n#    MASTER_USER='joe', MASTER_PASSWORD='secret';\n#\n# OR\n#\n# 2) Set the variables below. However, in case you choose this method, then\n#    start replication for the first time (even unsuccessfully, for example\n#    if you mistyped the password in master-password and the slave fails to\n#    connect), the slave will create a master.info file, and any later\n#    change in this file to the variables' values below will be ignored and\n#    overridden by the content of the master.info file, unless you shutdown\n#    the slave server, delete master.info and restart the slaver server.\n#    For that reason, you may want to leave the lines below untouched\n#    (commented) and instead use CHANGE MASTER TO (see above)\n#\n# required unique id between 2 and 2^32 - 1\n# (and different from the master)\n# defaults to 2 if master-host is set\n# but will not function as a slave if omitted\n#server-id       = 2\n#\n# The replication master for this slave - required\n#master-host     =   &lt;hostname&gt;\n#\n# The username the slave will use for authentication when connecting\n# to the master - required\n#master-user     =   &lt;username&gt;\n#\n# The password the slave will authenticate with when connecting to\n# the master - required\n#master-password =   &lt;password&gt;\n#\n# The port the master is listening on.\n# optional - defaults to 3306\n#master-port     =  &lt;port&gt;\n#\n# binary logging - not required for slaves, but recommended\n#log-bin=mysql-bin\n\n# Uncomment the following if you are using InnoDB tables\n#innodb_data_home_dir = /usr/local/mysql/data\n#innodb_data_file_path = ibdata1:10M:autoextend\n#innodb_log_group_home_dir = /usr/local/mysql/data\n# You can set .._buffer_pool_size up to 50 - 80 %\n# of RAM but beware of setting memory usage too high\n#innodb_buffer_pool_size = 256M\n#innodb_additional_mem_pool_size = 20M\n# Set .._log_file_size to 25 % of buffer pool size\n#innodb_log_file_size = 64M\n#innodb_log_buffer_size = 8M\n#innodb_flush_log_at_trx_commit = 1\n#innodb_lock_wait_timeout = 50\n\n[mysqldump]\nquick\nmax_allowed_packet = 16M\n\n[mysql]\nno-auto-rehash\n# Remove the next comment character if you are not familiar with SQL\n#safe-updates\n\n[myisamchk]\nkey_buffer_size = 128M\nsort_buffer_size = 128M\nread_buffer = 2M\nwrite_buffer = 2M\n\n[mysqlhotcopy]\ninteractive-timeout\n</code></pre>\n\n<p>When I try to run</p>\n\n<pre><code>mysqld --skip-grant-tables --user=mysql\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>The program 'mysqld' can be found in the following packages:\n * mysql-server-core-5.1\n * mysql-cluster-server-5.1\nTry: sudo apt-get install &lt;selected package&gt;\n</code></pre>\n\n<p>When i try to stop the server, I get this:</p>\n\n<pre><code>* MySQL server PID file could not be found!\n</code></pre>\n\n<p>When I try to start:</p>\n\n<pre><code>Starting MySQL\n.. * The server quit without updating PID file (/usr/local/mysql/data/dev.pid).\n</code></pre>\n\n<p>I am assuming I am not editing the my.cnf file properly, but i'm completely lost. Otherwise I have followed the instructions perfectly and I have made sure that the previous mysql 5.1 version was completely removed from the system. </p>\n"},{"id":80194,"title":"Where do I put my start up script for mysql? ","body":"<p>I have created a second instance of MySQL on the server for replication, if I start the process manually it works but need it to start at bootup.</p>\n\n<p>I used to just do a bash script in the init.d folder but apparently that no longer works on 11.10</p>\n\n<p>Can anyone point me in the right direction?  I even copied the mysql service, changed it and tried that but it refused to work.</p>\n\n<p>P.S It is the server edition so only Shell access.</p>\n"},{"id":15222,"title":"MySQL server Upstart script not working on boot","body":"<p>For some reason the Upstart script for the MySQL server isn't working when I boot my server, however it does work once the server has booted and I execute <code>sudo start mysql</code> manually.</p>\n\n<p>I'm running an OpenVZ VPS with Ubuntu 10.04 installed and MySQL version 5.1.41 (latest stable from the repository). MySQL is a fresh install with no config changed.</p>\n\n<p>/etc/init/mysql.conf:</p>\n\n<pre><code># MySQL Service\n\ndescription     \"MySQL Server\"\nauthor          \"Mario Limonciello &lt;superm1@ubuntu.com&gt;\"\n\nstart on (net-device-up\n          and local-filesystems\n      and runlevel [2345])\nstop on runlevel [016]\n\nrespawn\n\nenv HOME=/etc/mysql\numask 007\n\npre-start script\n    #Sanity checks\n    [ -r $HOME/my.cnf ]\n    [ -d /var/run/mysqld ] || install -m 755 -o mysql -g root -d /var/run/mysqld\n    # Load AppArmor profile\n    if aa-status --enabled 2&gt;/dev/null; then\n        apparmor_parser -r /etc/apparmor.d/usr.sbin.mysqld || true\n    fi\n    LC_ALL=C BLOCKSIZE= df --portability /var/lib/mysql/. | tail -n 1 | awk '{ exit ($4&lt;4096) }'\nend script\n\nexec /usr/sbin/mysqld\n\npost-start script\n    for i in `seq 1 30` ; do\n        /usr/bin/mysqladmin --defaults-file=\"${HOME}\"/debian.cnf ping &amp;&amp; {\n            exec \"${HOME}\"/debian-start\n            # should not reach this line\n            exit 2\n        }\n        sleep 1\n    done\n    exit 1\nend script\n</code></pre>\n"},{"id":11830,"title":"Why does mysql process starts on boot?","body":"<p>As you can see, mysql exists only in the <code>/etc/init.d</code> directory and not in <code>/etc/rcN.d</code>, therefore it shouldn't start on boot.</p>\n\n<pre><code>$ sudo find /etc -regex \".*\\(rc.*d\\|init\\.d\\).*\" | sudo grep \"mysql\" | sort\n/etc/init.d/mysql\n</code></pre>\n"}]}]