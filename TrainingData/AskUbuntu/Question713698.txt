[{"id":713698,"title":"Ubuntu server some sort of deadlock","body":"<p>I've made some changes recently to set up my network slightly differently in the home-brew data centre. I had the machine hooked up via PowerLine but my RCD seems to heavily interfere and the speeds were entirely inadequate once I started streaming 1080p video over the line. Now I've switched to Wifi and I was getting much better speeds, but I have broken the configuration of my networking.</p>\n\n<p>Currently, on boot, the machine tries to do two things. Firstly, it tries to connect to the network. This fails because the gateway is wrong (it's set to the former 192.168.0.1 gateway, but it's now on a DMZ which is on the 192.168.1.1 gateway. This (I believe) is why the network setup fails. However, I had some network shares to be mounted on the machine (it's a build server, and needs access to all sorts of junk). Mounting those network shares with a broken network configuration appears to throw the machine into some very ugly state from which it can't recover.</p>\n\n<p>Sadly, booting into recovery mode doesn't seem to work. I cannot edit anything due to read only file system, and anything which re-mounts in read/write also enables networking - derp.</p>\n\n<p>I don't know if it's possible to (or more to the point, how to, since it's most likely possible) mount the file system in read/write mode. I'd need to do this from a root terminal (the one you access from recovery menu) I guess. I also need a method of doing this which does not also attempt to connect network drives <strong>or</strong> to try mount the network share.</p>\n\n<p>This is a headless machine, naturally, so everything has to be done via terminal. It smells to me like my only remaining option might be to mount the SSD in another machine and edit it manually. While this is a feasible approach, I'd like to refrain from doing it because it puts me in a difficult situation having to take another server offline (one which the Mrs is utilising right now to catch up on some Loose women over Christmas - I do treasure my manhood).</p>\n\n<p>Any/all suggestions welcome!</p>\n","related_questions":[{"id":711037,"title":"Ubuntu Server joining an Active Directory Windows Domain","body":"<p>The gist of what I want to do is add some Ubuntu Server hosts to my Windows Active Directory (2008r2 level), limit access to each server via a group, then further limit the sudo permissions on the server per a different group. </p>\n\n<p>I also want to mount a cifs share as the domain users home directory, so all home directory files are stored on the Windows CIFS share and not on the server itself.</p>\n\n<p>Here is the current layout of servers I have: \n5x Windows Server 2008r2 VM's \n9x Ubuntu Server 14.04.3 VM's</p>\n\n<p>Of the 5 Windows Boxes here is their purpose: \n1x Windows AD Controller (2008r2 Level) \n1x Windows File Services (Hold the share for user homes) \n1x Windows Exchange 2013 Server \n2x App Servers</p>\n\n<p>Now I've played with PBIS Open and it works great, Its done everything I need EXCEPT mounting the CIFS share as the user home directory. I can control all the other access permissions ect.</p>\n\n<p>To be clear on the Ubuntu servers I want the home directories in /home/DOMAINNAME/remote/USER</p>\n\n<p>So I'd imagine I would want to mount the CIFS share on /home/DOMAINNAME/remote however I also want the share to be unmounted when the user logs out (SSH/Console/Whatever)</p>\n\n<p>I've seen posts on other websites ect where this is possible with PBIS but most refer to the enterprise side and using GPE which is not possible in the open version.</p>\n\n<p>Any assistance anyone could provide would be great, if you have any questions or don't understand anything I've said I can try to clarify.</p>\n\n<p>Thanks, \nDMehaffy</p>\n"},{"id":625715,"title":"Ubuntu 15.04 no longer mounts samba share on boot","body":"<p>I recently upgraded to ubuntu server 15.04 from 14.04.  I have this line in my <code>/etc/fstab</code>:</p>\n\n<pre><code>#Samba\n//192.168.1.101/mediaserver2/ /mnt/mediaserver/ cifs  user=*****,password=*********,iocharset=utf8,file_mode=0777,dir_mode=0777,uid=1000,gid=1000,nounix 0 0\n</code></pre>\n\n<p><em>yes, i know that this isn't 'safe' putting password in <code>/etc/fstab</code> but this machine isn't connected to anything but my local network, it's just for me to mess around with</em></p>\n\n<p>Manually typing <code>sudo mount -a</code> after booting will mount the samba share, but I don't understand why it isn't loading on boot anymore.  Thank you for any insight into what's going on.</p>\n"},{"id":682775,"title":"How to properly mount a partition from one ubuntu machine (client) to another (server)?","body":"<p>Basic setup is as follows.  A desktop and a laptop.  Both have ubuntu installed.  The desktop is going to function as a server.  The laptop is going to function as a workstation.</p>\n\n<p>Basically, there is a mounted partition on the desktop.  It is mounted and functioning properly on the server.  From here, I would like to know how to properly share and mount the partition on the client.  I've installed smbfs on the server following several sets of instructions on the web.  The obstacle is mounting the share on the laptop workstation.</p>\n\n<p>I've read several guides and am getting conflicting advice about which protocol to use (CIFS or SMB).  My setup is ubuntu server 14.04 on the server end.  Ubuntu mate 15 on the client.</p>\n\n<p>Advice is appreciated.</p>\n"},{"id":562088,"title":"Mount Windows File Share and acces them on ubuntu 14.04 server","body":"<p>I have created a windows file share windows server 2012 on one of the data centre and I want to access the file share in another data centre on Ubuntu server 14.04</p>\n\n<p>I am able to ping both the machines vice versa.\nI have installed <code>cifs-utils</code> on the Ubuntu machine and when I run the </p>\n\n<pre><code>$ mount.cifs //x.x.x.x/test /mnt/iweb -o user=Administrator\nPassword:\n</code></pre>\n\n<p>Windows Share is not getting mounted on the machine.\nCorrect me if am wrong on the same.</p>\n"},{"id":676663,"title":"Windows UAC wont allow access to ubuntu folder?","body":"<p>I have a web server set up on a secondary machine running Ubuntu. I want to be able to access the folder in which I keep the text documents for the server from multiple machines. So I can have I went in and set this particular folder to shared with the check box for allow others to create and delete folders checked. Now I go to my windows machine and click the computer on the network it opens and I see the shared folder. I click to access the folder and the Windows UAC opens. I then type \\10.10.11.120\\Agent47 (this is the IP address of the Ubuntu computer followed by the username (I type the IP address because I'm on a domain that the server is not on)) then I type in my password (the password of the owner of the folder which is Agent47) and it does nothing just reopens the UAC. Has anyone ever encountered a problem like this before or know what I'm doing wrong (I'm relatively new to Ubuntu and linux in general btw)? \nTHX,\nLogan </p>\n"},{"id":647935,"title":"How to mount a Mac OS X 10.10 shared volume with Ubuntu Server 14.04","body":"<p>I'm attempting to mount a Mac OS X 10.10 shared volume via Ubuntu Server 14.04.1. I've set this up successfully between two Macs but I'm having a problem Ubuntu to Mac.</p>\n\n<p>I've setup the shared volume \"myStorage\" via the Mac's Sharing System Preference panel.\nI've setup autofs file on the Ubuntu box as follows.</p>\n\n<p>I've created a mount point:</p>\n\n<pre><code>sudo mkdir /mnt/server\n</code></pre>\n\n<p><strong>File: /etc/auto.master</strong></p>\n\n<pre><code>/mnt/server     /etc/auto.server        --timeout=6000  --ghost\n+auto.master\n</code></pre>\n\n<p><strong>File: /etc/auto.server</strong></p>\n\n<pre><code>mymountpoint -fstype=cifs,credentials=/root/autofs.creds ://ip_address_here/myStorage -o iocharset=utf8,sec=ntlmssp,rw,nounix\n</code></pre>\n\n<p><strong>File: /root/autofs.creds</strong></p>\n\n<pre><code>username=MYDOMAIN\\myusername\npassword=mypassword\n</code></pre>\n\n<p>I'm receiving these errors when trying to navigate to the mount point /mnt/server/myStorage. The mount point does show in the /mnt/server directory, but the result is:</p>\n\n<pre><code>-bash: cd: myStorage/: No such file or directory\n</code></pre>\n\n<p>in /var/log/syslog:</p>\n\n<pre><code>Status code returned 0xc000006d NT_STATUS_LOGON_FAILURE\nCIFS VFS: Send error in SessSetup = -13\nCIFS VFS: cifs_mount failed w/return code = -13\n</code></pre>\n\n<p>I've installed <em>cifs-utils</em>\nAny ideas on what I am doing incorrectly?</p>\n"},{"id":645550,"title":"Ubuntu Samba auto mounted hard drive permission fails","body":"<p>So I plugged in my harddrive to the Ubuntu Samba Server and it automatically mounted it inside media/user/harddrivename/, so far so good.</p>\n\n<p>Now I want to share the harddrive like the foldes I share in my filesystem with Samba (which do work).</p>\n\n<p>These were my first steps.</p>\n\n<pre><code>sudo chown -c $USER &lt;filespath&gt;\n</code></pre>\n\n<p>Then I tried to give the correct permissions</p>\n\n<pre><code>sudo -R 744 &lt;filespath&gt;\n</code></pre>\n\n<p>(so that the owner has full acces and group and other only read acces)\nunfortunaly this does not work, has anybody and idea how to fix this.\nIt is probaly a permission error I think:)</p>\n"},{"id":605207,"title":"Mount Nas to Ubuntu Server and samba?","body":"<p>I want to mount my NAS drive into my Ubuntu Server so I can reach it from my Windows desktop. So far so good.</p>\n\n<p>This is my Ubuntu server's <code>/etc/fstab</code>:</p>\n\n<pre><code>//192.168.0.2/Public /DataShare/Aurora-NAS cifs credentials=/etc/samba/SAMBA_SHARE_credentials, 0 0\n</code></pre>\n\n<p><code>/etc/samba/smb.conf</code>:</p>\n\n<pre><code>[DataShare]\npath = /DataShare/\navailable = yes\nvalid users = slaffe\nread only = no\nbrowseable = yes\npublic = yes\nwritable = yes\n</code></pre>\n\n<p>I can read and write in <code>DataShare</code> (this folder is on my Ubuntu Server), but I cannot write on <code>/DataShare/Aurora-NAS/</code>.</p>\n"},{"id":546148,"title":"Ubuntu Server Samba Permissions best practice","body":"<p>I am having some problems accessing my Ubuntu Server 14.04 over Samba. I am trying to access from my Ubuntu Gnome 14.04 desktop and other Linux desktops. I would like to have fine access control in the server where some users can read and write to shares and other users can only read but not write/delete files. I am not sure that I am doing this the right way but I realize there are usually many ways to do something on Linux. I have created the folders through the command line and am using Samba through Webmin to share them.</p>\n\n<p>I believe that file level ACL is where my current problem is. For example I have two folders on the server one I can read and write to and one I cannot write to but can read.</p>\n\n<p>Getfacl lists their properties like this:</p>\n\n<blockquote>\n  <p>john@Server:~$ getfacl /exports/Stuff</p>\n  \n  <p>getfacl: Removing leading '/' from absolute path names</p>\n  \n  <p>file: exports/Stuff</p>\n  \n  <p>owner: root</p>\n  \n  <p>group: root</p>\n  \n  <p>user::rwx</p>\n  \n  <p>group::r-x</p>\n  \n  <p>other::r-x</p>\n  \n  <p>default:user::rwx</p>\n  \n  <p>default:user:john:rw-</p>\n  \n  <p>default:user:wife:rw-</p>\n  \n  <p>default:user:daughter:rw-</p>\n  \n  <p>default:group::r-x</p>\n  \n  <p>default:group:users:r--</p>\n  \n  <p>default:mask::rwx</p>\n  \n  <p>default:other::r-x</p>\n  \n  <p>john@Server:~$ getfacl /exports/Photos</p>\n  \n  <p>getfacl: Removing leading '/' from absolute path names</p>\n  \n  <p>file: exports/Photos</p>\n  \n  <p>owner: john</p>\n  \n  <p>group: root</p>\n  \n  <p>user::rwx</p>\n  \n  <p>group::r-x</p>\n  \n  <p>other::r-x</p>\n  \n  <p>default:user::rwx</p>\n  \n  <p>default:user:john:rw-</p>\n  \n  <p>default:user:wife:rw-</p>\n  \n  <p>default:group::r-x</p>\n  \n  <p>default:group:users:r--</p>\n  \n  <p>default:mask::rwx</p>\n  \n  <p>default:other::r-x</p>\n</blockquote>\n\n<p>Now I see that I am the owner of Photos and root is the owner of folder Stuff an that seems to be the largest difference between them. </p>\n\n<p>Another user on the network also using Ubuntu Gnome can access the Photos folder but cannot write, this is the behavior I wanted and I imagine Samba is controlling this as she is not listed in the ACL’s but is listed in Samba security.</p>\n\n<p>Would the best approach be to delete the file system acls with setfacl and then just use samba to control user access or should I set them to both match?</p>\n\n<p>Am I going about this in the right way? What is the best practice to handle something like this? All clients are on Linux so If you had shares that some would view and never write to, while others would read and write, how would you control access? </p>\n"},{"id":317988,"title":"Making a Network Drive Faster To Access","body":"<p>I have mounted a 450 GB Logical Volume in Ubuntu and I am sharing it over the network using Samba. On my Mac, I am able to connect to the shared folder and mount the volume; however, it takes minutes for me to see all of my files, which consist of music and photos. Is there any way to speed up this process? I know that Windows 7, for example, can index drives, but would this work even if the server is turned off and on again? My Ubuntu server is using ethernet.</p>\n"}]}]