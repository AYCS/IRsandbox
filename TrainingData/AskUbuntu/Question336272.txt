[{"id":336272,"title":"How is ubuntu live user graphical session (startx) started up in a LiveCD?","body":"<p>I am trying to build a custom ISO, using <code>ubuntu-builder</code>. I've taken a 12.40 mini remix ISO as a starting point. Here is my specific example - however, I'm interested in principle how the process goes (so I can apply that to other DE/WM).  </p>\n\n<p>when I run a new ISO, built directly from the mini remix starting ISO, all is as expected - I can run the new ISO in a virtual machine, and the boot process terminates with text-only prompt for the live <code>ubuntu</code> user. </p>\n\n<p>Now, I try to install LXDE (there is an entry for it in <code>ubuntu-builder</code>, apparently it installs <code>lxde-core</code> and X dependencies; and I manually have to install <code>lxterminal</code>, and as icons are missing, probably <code>lxde-icon-theme</code> as well). I have to also manually install <code>xinit</code>, so I have <code>startx</code>. But this, by itself, doesn't do much: if I boot this customized ISO in a virtual machine, the exact same thing happens as with the \"original\" ISO - boot process completes with a text mode prompt for <code>ubuntu</code> live user. </p>\n\n<p>If I now type <code>startx</code> at this prompt, then LXDE starts (running <code>startlxde</code> at this prompt will complain about X), such that when you start <code>lxterminal</code> from that desktop, it is started under the live <code>ubuntu</code> user.</p>\n\n<hr>\n\n<p>In <a href=\"https://help.ubuntu.com/community/LiveCDCustomization#Boot_init\" rel=\"nofollow\">LiveCDCustomization - Boot init</a>, it is mentioned:</p>\n\n<blockquote>\n  <p>Boot init<br>\n  You have to edit the files in edit/usr/share/initramfs-tools/scripts/casper-bottom/* For example you can change the hostname or the livecd user. </p>\n</blockquote>\n\n<p>... but I don't exactly understand what is exactly being ran by what there. The <code>ubuntu-builder</code> unpacks these files under <code>/home/ubuntu-builder/FileSystem/usr/share/initramfs-tools/scripts/casper-bottom/</code> - but as far as I can see, most of these just run some inline <code>sed</code> commands, I cannot see much executive commands there? </p>\n\n<p>Still, I tried to copy one of the scripts there as a new script, <code>51startx</code>, which in the executable section has:</p>\n\n<pre><code>log_begin_msg \"$DESCRIPTION\"\n\nchroot /root startx\nchroot /root startlxde\n\nlog_end_msg\n</code></pre>\n\n<p>This does absolutely nothing - again, after boot, I get the usual text prompt <code>ubuntu@ubuntu:~$</code>. </p>\n\n<hr>\n\n<p>Then I found <a href=\"http://www.backtrack-linux.org/forums/showthread.php?t=40457\" rel=\"nofollow\">Modify: Startx automatically, add apt, etc - backtrack-linux.org</a>:</p>\n\n<blockquote>\n  <p>To have a graphical login, just install gdm and run it in startup:</p>\n\n<pre>aptitude update\naptitude install gdm</pre>\n  \n  <p>Then, edit /etc/rc.local, and add a line BEFORE \"exit 0\" like this:</p>\n\n<pre>service gdm start</pre>\n  \n  <p>This is not the best way, but run! . This must work running \"update-rc.d gdm defaults\", but this way fail. </p>\n</blockquote>\n\n<p>And indeed - I added:</p>\n\n<pre><code>startx\nstartlxde\n</code></pre>\n\n<p>... to <code>/etc/rc.local</code> - and this indeed does boot, and start LXDE automatically - however, when I run <code>lxterminal</code>, it is under user <code>root</code> - not under the live user <code>ubuntu</code>!</p>\n\n<hr>\n\n<p>So, what should I do, so that I can start (any) X and/or any desktop environment automatically at boot under the live <code>ubuntu</code> user? </p>\n\n<p>Note that in this case, I would <strong>not</strong> like to use an additional desktop manager (e.g. <code>gdm</code>) nor a corresponding greeter - but it would be good to know, if a solution for automatically starting up X would also work for a desktop manager or a greeter.</p>\n","related_questions":[{"id":677255,"title":"How can I get information on X-server problems on a live session?","body":"<p>I've been running a version of the Ubuntu 14.04.3 ISO that was customized by myself to run the Pantheon desktop environment. My current problem is the VirtualBox session running in low graphics mode, it's preventing me from booting up the desktop.</p>\n\n<p>I need more information if I'm going to fix things, but there's a problem. When I install the ISO to VBox I'm unable to get into a TTY, so I can't check the xsession errors file. So, I'm going to need to figure out what's causing the problem when I'm on a live session. Is there any way I can do this?</p>\n"},{"id":28495,"title":"How do I get my Mac to boot from an Ubuntu USB key?","body":"<p>If you select \"USB\" and \"Mac\" on <a href=\"http://www.ubuntu.com/desktop/get-ubuntu/download\">this download page</a>, it gives a series of command line instructions to make a USB key which the MacBook will boot into Ubuntu from.</p>\n\n<p>I've followed them to the letter two or three times on different USB keys, and it doesn't work. There's a very great deal of technical discussion about EFI etc. but this set of instructions seems to suggest it should just work, but it doesn't.</p>\n\n<p>Help? I'm increasingly unhappy with the more locked-down approach Apple is taking, and I'd quite like to start using Linux with a view to transitioning over to using it as my main operating system, but booting from the CD takes forever, runs slowly and I'm really hoping to get it moving off USB.</p>\n\n<p>Can anybody help me?</p>\n"},{"id":446487,"title":"Ubuntu LiveCD install stuck on &quot;creating user&quot; step","body":"<p>I've been STRUGGLING to install Ubuntu (as dual-boot with an existing Windows XP installation, on a different drive and partition) for a couple of days now.  I've already checked the md5 hash for the downloaded iso and DVD files after burning. </p>\n\n<p>I have several problems that recur with my installation:</p>\n\n<ol>\n<li><p>At first, my install would go slow as molasses, with only the\noccasional sluggish sign of activity (DVD/HD lights, etc.) before\ngetting stuck at various points early in the process.  I researched\nand found that often NVidia cards are the culprit (which I have). \nSo I tried the <em>nomodeset</em> option, and that finally seemed to get\nthings going (DVD/HD lights flashing regularly, progress indicator\nprogressing, etc.)  But then the install <em>always</em> froze at the\n\"Creating User\" step.  Per another forum post, I've been trying to\nredo the process doing a \"noquiet\" so I can find out exactly which\nstep is causing the issue, but I haven't been able to because...</p></li>\n<li><p>Now when I try to either boot from the DVD or run the install\nprogram, I get the error messages:</p>\n\n<blockquote>\n  <p>buffer I/O error on device sr1, sector nnnn.</p>\n  \n  <p>ata_id[257]: HDIO_GET_IDENTITY failed for '/dev/sr1/': No message of desired type.</p>\n  \n  <p>(initramfs) Unable to find live file system.  </p>\n</blockquote>\n\n<p>At first I thought it was due to the earlier faulty installs:  I\nwent back in Windows to clear out the intended Ubuntu partitions (regular and swap).  But now I\nam wondering if this is due to the DVD drive:  it appears to freeze\nduring the boot process and not respond in time.  A \"noquiet\"\nboot-run reveals error messages like \"soft resetting link...ata slow\nto respond...forcing hard reset...etc.\"  As a test, one time I tried\nto eject the DVD during the process when things got stuck:  it would\nnot respond until the boot process finished failing and I was forced\nto reboot.  This is all odd because this DVD drive worked fine\npreviously in attempted installs, and still works fine in Windows\nXP!  And 'nomodeset' does not work for me this time.</p></li>\n</ol>\n\n<p>Note that my BIOS must be one of the older ones: it has options for enabling \"legacy support\" for USB, but there are absolutely no menus/options for enabling boot from a USB device, so that workaround is out.</p>\n\n<p>Now my friends and relatives are looking at me cross-eyed for the idea of trying Linux at all (especially since they've had easier times with their MS installs).</p>\n"},{"id":426384,"title":"PXE Boot Recent Ubuntu Live CDs","body":"<p>I've been having trouble with recent Ubuntu live CDs trying to boot off of them via PXE. My ultimate goal is to rebuild an old Ubuntu 9.04 diskless box using the newer Ubuntu 12.04.4 build.</p>\n\n<p>When trying to boot what I believe is a good configuration, I'm getting output similar to the following:</p>\n\n<pre><code>Loading .../vmlinuz......\n\n// --- lotsa good boot-up stuff ---\n\nBegin: Running /scripts/init-premount ... done.\nBegin: Mounting root file system ... Begin: Running /scripts/casper-premount     ...\n [    6.336295] pcnet32 0000:02:01.0: eth0: link up\ndone.\ndone.\nIP-Config: eth0 hardware address xx:xx:xx:xx:xx:xx mtu 1500 DHCP RARP\nIP-Config: no response after 2 secs - giving up\nIP-Config: eth0 hardware address xx:xx:xx:xx:xx:xx mtu 1500 DHCP RARP\nIP-Config: no response after 3 secs - giving up\nIP-Config: eth0 hardware address xx:xx:xx:xx:xx:xx mtu 1500 DHCP RARP\nIP-Config: no response after 4 secs - giving up\nIP-Config: eth0 hardware address xx:xx:xx:xx:xx:xx mtu 1500 DHCP RARP\nIP-Config: no response after 6 secs - giving up\nIP-Config: eth0 hardware address xx:xx:xx:xx:xx:xx mtu 1500 DHCP RARP\nIP-Config: no response after 9 secs - giving up\nIP-Config: eth0 hardware address xx:xx:xx:xx:xx:xx mtu 1500 DHCP RARP\nIP-Config: no response after 16 secs - giving up\nIP-Config: eth0 hardware address xx:xx:xx:xx:xx:xx mtu 1500 DHCP RARP\nIP-Config: no response after 25 secs - giving up\nIP-Config: eth0 hardware address xx:xx:xx:xx:xx:xx mtu 1500 DHCP RARP\nIP-Config: no response after 36 secs - giving up\nIP-Config: eth0 hardware address xx:xx:xx:xx:xx:xx mtu 1500 DHCP RARP\nIP-Config: no response after 64 secs - giving up\nIP-Config: eth0 hardware address xx:xx:xx:xx:xx:xx mtu 1500 DHCP RARP\n</code></pre>\n\n<p>I originally followed the steps <a href=\"https://help.ubuntu.com/community/DisklessUbuntuHowto\" rel=\"nofollow\">here</a>. I currently have the following:</p>\n\n<ul>\n<li>A router running Tomato 1.21 (yes, I know it's old)</li>\n<li>A box containing the TFTP server and the files from the live CD (IP address 192.168.x.y)</li>\n</ul>\n\n<p>The router has a Dnsmasq custom configuration containing the following lines shown below:</p>\n\n<pre><code>dhcp-no-override\ndhcp-boot=pxelinux.0,,192.168.x.y\n</code></pre>\n\n<p>With these set up, when I want to add something new to my PXE collection, I put some files in certain places, add lines to certain config files, and then I'm ready to boot my target box.</p>\n\n<p>I've done this in the past for several boot situations including:</p>\n\n<ul>\n<li>Backtrack 4r2 i386</li>\n<li>Debian Lenny, Squeeze, and Wheezy</li>\n<li>Damn Small Linux</li>\n<li>Fedora 18</li>\n<li>Several older Ubuntu live CDs</li>\n<li>Several older Ubuntu installations</li>\n</ul>\n\n<p>My current process to add a new Ubuntu live CD into the mix is as follows:</p>\n\n<ol>\n<li>Mount the live CD as an ISO image.</li>\n<li>Copy all files out of the ISO image onto the hard drive.</li>\n<li>Copy the vmlinuz and initrd.lz files from the ISO contents to area accessible by the TFTP server.</li>\n<li>Rebuild the initrd.lz to support PXE booting by modifying <code>initramfs.conf</code> and then running <code>update-initramfs</code> inside chroot:\n<ul>\n<li>MODULES=netboot</li>\n<li>BOOT=nfs</li>\n<li>NFSROOT=192.168.x.y:/path/to/extracted/iso/contents</li>\n<li>DEVICE=eth0 // didn't do this before, trying now as described <a href=\"http://askubuntu.com/questions/330832/ubuntu-12-04-pxe-boot-fail-with-message-ip-config-no-response-after-secs\">here</a> due to trouble but still no dice; only have single NIC anyway</li>\n</ul></li>\n<li>Add item to boot.txt in TFTP server.</li>\n<li>Add lines to file under pxelinux.cfg directory.</li>\n</ol>\n\n<p>Once I do these, I can reboot. To try it out, I've been using a basic VMware Player virtual machine with no hard drive, no CD-ROM drive, and no floppy drive. All it does is boot from PXE.</p>\n\n<p>In the past, this has worked wonderfully, and then I can power it down and boot my desired physical box via PXE the same way.</p>\n\n<p>I haven't been able to boot the last couple Ubuntu live CDs this way because I get the message as shown above:</p>\n\n<pre><code>no response after xx secs - giving up` message\n</code></pre>\n\n<p>Finally, I mounted the ISO directly under my VMware VM and installed Ubuntu directly onto a VM. Once I had that, I made it a diskless image by mounting the hard drive and copying the contents out similar to Steps 1 and 2 above, and then trying to PXE-boot from there.</p>\n\n<p>This has worked before; however, when I try to do this with my 12.04 installation, I see the same symptom as my 12.04 live CD:</p>\n\n<pre><code>no response after xx secs - giving up\n</code></pre>\n\n<p>I tried <a href=\"http://askubuntu.com/questions/241998/pxe-boot-broken-after-12-04-upgrade\">this</a>; it didn't work. Here are my old and new pxelinux.cfg/default lines:</p>\n\n<pre><code>label ubuntu_12.04.4-desktop-i386\n         kernel /ubuntu/12.04.4-desktop-i386/vmlinuz nosplash\n#         append boot=casper netboot=nfs nfsroot=192.168.0.99:/path/to/ubuntu-12.04.4-desktop-i386 initrd=/ubuntu/12.04.4-desktop-i386/initrd.lz\n         append boot=nfs root=/dev/nfs nfsroot=192.168.0.99:/path/to/ubuntu-12.04.4-desktop-i386 initrd=/ubuntu/12.04.4-desktop-i386/initrd.lz\n</code></pre>\n\n<p>I would appreciate any insight anyone has.</p>\n\n<p>Thanks.</p>\n"},{"id":579757,"title":"how can I configure my live (x|l|k)ubuntu to: have my username and NOT autologin","body":"<p>I am playing around with the ISO image of a few Ubuntu derivatives - which should be fairly similar to Ubuntu. The version is 14.04.1 64bit. The idea here is to create a <strong>custom</strong> live USB stick, based on the live session that you get when you first boot Ubuntu from a DVD-ROM or a USB stick. </p>\n\n<p>Note that, I have tried a normal installation of Ubuntu in the USB stick, but this is not suitable for me, because the USB is slow as a storage media. As a result, any session in this system was sluggish and generally ineffective. </p>\n\n<p>So for best results and quicker respond the session needs to be run from a RAM-drive and the path of least effort seems to be the live Ubuntu session that you get when booting Ubuntu LiveCD or LiveUSB. If you have any other suggestion please feel free to put it forward.</p>\n\n<p>I have gone through a large number of guides. I have heard of <code>Ubuntu customization kit</code> and of other (mostly very old) specific customizations. One thing that is certain among all guides is that the customization needs to be done in the <code>casper</code> initial (ram?) system. So, I have extracted the ISO image of <code>Xubuntu</code>, and I have <code>unsquashed</code> the <code>filesystem.squashfs</code> boot file.  From what I have read the boot scripts are located in </p>\n\n<pre><code>squashfs-root/usr/share/initramfs-tools/scripts/casper-bottom/ #directory\nsquashfs-root/usr/share/initramfs-tools/scripts/casper #file\n</code></pre>\n\n<p>And what I want to achieve - at least initially - is to </p>\n\n<ol>\n<li>have my own user with my own user name.</li>\n<li>delete the live session user</li>\n<li>disable autologin</li>\n</ol>\n\n<p>I have already tried to do this from the live session (using persistency) but lightdm autologin features are not persistent and the same is true for deleting the live session user.</p>\n\n<p>so in the file <code>casper</code> I see there are 4 <em>awesomely</em> relevant entries</p>\n\n<pre><code>USERNAME=casper\nUSERFULLNAME=\"Live session user\"\nHOST=live\nBUILD_SYSTEM=Custom\n</code></pre>\n\n<p>and changed it to</p>\n\n<pre><code>USERNAME=nass\nUSERFULLNAME=\"not a live session\"\nHOST=portableos\nBUILD_SYSTEM=Custom\n</code></pre>\n\n<p>It looks like not only I can have my own user from boot , but also there is no need to delete the casper user as I am already the main user replacing casper :)</p>\n\n<p>Unfortunately, replacing these with custom values, re-making the squashfs file system and replacing the file in the ISO does not change the live session user. The live session user is once again called \"Ubuntu\".</p>\n\n<p>Likewise, doing <code>chmod -x</code> in file <code>casper-bottom/15autologin</code>  (or even deleting it altogether) did not alter the boot process and did not ask for a password during login. </p>\n\n<p>So it appears this is once again NOT the right location to create a new user, delete the casper user or to disable the autologin boot process.</p>\n\n<p>So I have to ask, WHERE should I do all these customizations? </p>\n\n<p>EDIT:</p>\n\n<p>commenting <code>user-session=xubuntu</code> in <code>squashfs-root/etc/lightdm/lightdm.conf.d/10-xubuntu.conf</code> I have successfully disabled the autologin. </p>\n\n<p>Also I have updated the file <code>squashfs-root/etc/casper.conf</code></p>\n\n<pre><code>USERNAME=nass\nUSERFULLNAME=\"not a live session\"\nHOST=portableos\nBUILD_SYSTEM=Custom\n</code></pre>\n\n<p>but again I boot to user \"Ubuntu\" - this is the only available user.</p>\n\n<p>Finally, <code>squashfs-root/etc/passwd</code> does not contain any entry for user \"Ubuntu\" so I can not simply alter it there.</p>\n\n<p>It goes without saying that I \"mksquashfs\" the file system and replace the relevant file before every attempt to boot it.</p>\n"},{"id":509953,"title":"Ubuntu Live CD is Frozen - How to Recover?","body":"<p>I'm in a tricky situation. I'm running Ubuntu from a live cd. I think I have too many firefox pages and tabs open, so the computer is frozen. However, I have some unsaved, and very important, text editor files open. At first the computer wouldn't respond at all, after a few hours, the screen woke up and now it's just a black screen with the unmoving mouse cursor. <strong>Any way to recover without restarting?</strong> Maybe somehow kill the firefox processes? </p>\n\n<p>Any help would be greatly appreciated. <strong>These files are massively important</strong>. Losing then would be a huge loss.</p>\n"},{"id":508015,"title":"Installing ubuntu from customized live CD","body":"<p>So basically I modified an installation iso file. To be specific I added a kickstart file to it to automate the installation of ubuntu 14.04.1 i386, I modified the isolinux/txt.cfg file to make it use the kickstart file.</p>\n\n<p>Now, to test the installation-script I started a virtual machine and booted the disc image. A lot of text popped up, checking the state of the machine. I quess the installation begins with casper, since that is the first thing that is clearly readable. Unfortunately it seems to check its file system on the floppy drive and gets stuck there, it repeatedly prints:</p>\n\n<pre><code>/init: line 7: can't open /dev/sr1: No medium found\n</code></pre>\n\n<p>Eventually it stops and I find myself in the BusyBox.</p>\n\n<p>On <a href=\"https://bugs.launchpad.net/ubuntu/+bug/500822/\" rel=\"nofollow\">launchpad.net</a> people seemed to fix this problem by disabling the floppy drive.\nOccasionally it didn't work for me, or I did it wrong.</p>\n\n<p>My question is now: Is this a bug in casper or did I just fail to configure kickseed properly?</p>\n\n<p>-- I should note, that I'm new to ubuntu and have basically no idea regarding partitioning in kickstart, might there be the problem?</p>\n\n<p>ks.cfg located in /</p>\n\n<pre><code>#\n#Generic Kickstart template for Ubuntu\n#Platform: x86 and x86-64\n#\n\n#System language\nlang en_US\n\n#Language modules to install\nlangsupport en_US\n\n#System keyboard\nkeyboard us\n\n#System mouse\nmouse\n\n#System timezone\ntimezone Europe/Vienna\n\n#Root password\nrootpw --disabled\n\n#Initial user (user with sudo capabilities) \nuser ubuntu --fullname \"abc\" --password abc\n\n#Reboot after installation\nreboot\n\n#Use text mode install\ntext\n\n#Install OS instead of upgrade\ninstall\n\n#Installation media\ncdrom\n#nfs --server=server.com --dir=/path/to/ubuntu/\n\n#System bootloader configuration\nbootloader --location=mbr \n\n#Clear the Master Boot Record\nzerombr yes\n\n#Partition clearing information\nclearpart --all --initlabel \n\n#Basic disk partition\npart / --fstype ext4 --size 1 --grow --asprimary \npart swap --size 1024 \npart /boot --fstype ext4 --size 256 --asprimary\n\n#System authorization infomation\nauth  --useshadow  --enablemd5 \n\n#Network information\nnetwork --bootproto=dhcp --device=eth0\n\n#Firewall configuration\nfirewall --disabled --trust=eth0 --ssh \n\n#Do not configure the X Window System\nskipx\n</code></pre>\n\n<p>txt.cfg located in /isolinux</p>\n\n<pre><code>default autoinstall\nlabel autoinstall\n  menu label ^Automatically Install Ubuntu\n  kernel /casper/vmlinuz\n  append  file=/cdrom/preseed/ubuntu.seed boot=casper initrd=/casper/initrd.lz ks=cdrom/ks.cfg â€“\n</code></pre>\n"},{"id":198883,"title":"Ubuntu Live CD: How to switch user on LiveCD to &quot;root&quot;","body":"<p>I have created my customized live CD by following the instructions @ <a href=\"http://ubuntuforums.org/showthread.php?t=688872\" rel=\"nofollow\">Ubuntu Forum Thread 688872</a></p>\n\n<p>The Live CD gets created fine and it is able to bootup as well. I see my customized setting in place.</p>\n\n<p>I created the Live CD using Ubuntu 10.04 Server edition. </p>\n\n<p>My issue is, when the system boots up with the live CD, it logs in automatically as \"ubuntu\" user. I want the system to login as \"root\". Because I will be running quite a few perl automation script off of the live CD and I need to have root privileges.</p>\n\n<p>Now, i know the \"sudo\" way of doing it, But I am least bothered about the security aspect and want my system to switch to \"root\" user the moment it boots up.</p>\n\n<p>Is there a hack to achieve the same?</p>\n\n<p><strong>UPDATE</strong>: If you cant resist to down vote my question, then please free to do so but do me a favor and let me know why you are down voting by dropping a comment.</p>\n"},{"id":213437,"title":"How do I install Ubuntu without using a LiveCD/USB?","body":"<p>There appear to be two types of Ubuntu installations: 'live' installations (typically USB or CD) and what I'm going to call 'full' installations (typically on an internal HDD).</p>\n\n<p>Full installations can use \"Startup Disk Creator\" to create live installations, and live installations ask if you would like to try Ubuntu or install to a hard drive, creating 'full' installations.</p>\n\n<p>How can I create another 'full' installation on another partition/disk, <em>without</em> creating an intermediate bootable 'live' medium? This seems like it should be simple.</p>\n\n<p>Example Scenario:</p>\n\n<p>A computer with four partitions: swap, /home, / , and one blank. Ubuntu 12.04 Desktop is currently installed on partition 3. I would like to install 12.04-server on the 4th partition. I have the .iso saved on the drive (/home partition). How do I perform a <em>full</em> (not 'live') install of 12.04-server to the fourth partition without buying a USB stick or CD drive?</p>\n"},{"id":190239,"title":"How to access hard drive files from liveCD?","body":"<p>I don't know what files or file types are there on the hard drive nor do I know the file system in which the hard disk is written on. I am not able to view it in the <strong>home</strong> folder after booting from the liveCD.</p>\n"}]}]