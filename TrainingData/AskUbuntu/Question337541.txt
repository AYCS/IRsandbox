[{"id":337541,"title":"How to recover partially formatted ext4 partition (testdisk did not help)","body":"<p>I have Ð° 2TB \"single ext4-formatted partition\" HDD.\nRecently, while working under Windows 7 on the same machine, I have damaged the aforementioned partition. What happened is that while I was trying to recover external USB drive I opened standard windows disk-management tool and it prompted me if I want to make disk1 \"active\". At that moment I didn't realize that \"disk1\" is not my USB disk, but the ext4 internal disk. After clicking OK, windows has created 100 MB \"system reserved partition\" on the disk and left the rest untouched..?\nWhen I logged back to linux, the partition was not mounted. I deleted created by windows  100MB NTFS \"system reserved partition\" and tried to run testdisk.\nTestdisk sees my old ext4 partition, but at the end tells something like \"no partition can be recovered\".\nIs it possible to get back my partition and directory-structure + data? The problem is that I had there all my programs (C/C++) and working directories as well as some experimental data i.e. files which don't have specific headers like jpg or pdf... \nIs there a way to recover these data? Can I, for instance, recover part of the partition? Let's say, whatever is above 100MB?</p>\n\n<p>Thanks in advance!</p>\n\n<p>P.S. Please let's avoid \"you should have done a backup\"-like comments.. :) I had a backup, but it was stored on the USB drive which I was trying to recover first.. (a general disk failure, disk is not readable).</p>\n","related_questions":[{"id":593958,"title":"ext4 partition lost after windows installation.How to recover it?","body":"<p>My disk had two partitions one was an extended partition containing my root and swap space and the other was an ext4 partition. Recently I installed windows 8.1 on it by shrinking the ext4 partition to make space for it. But after installation the grub was gone and I found it easy to reinstall Linux than fixing it. After doing the installation my untouched ext4 partition(containing my backup) was found as NTFS filesystem containing some windows files. I'm sure I had no access to it while on windows. I don't understand what really happened and is there any method to recover my data?</p>\n\n<p>Thanks in advance    </p>\n"},{"id":544962,"title":"Accidentally partitioned media drive as ext3 during install (was ext4), how can I recover?","body":"<p>I recently did a fresh install of ubuntu on a system with an old ubuntu install. I have a separate hard-drive which used to have a single ext4 partition, but during the install I accidentally selected \"use this partition as ext3\", but did not check \"format\".</p>\n\n<p>When I mounted the drive, I only saw the <code>lost+found</code> directory (which was empty). I tried using <code>testdisk</code> to recover, but it only shows the <code>lost+found</code>, since it is a perfectly valid partition.</p>\n\n<p>I ran <code>strings</code> on the block device, and see tons of file names, which is why I believe the journal data is still there somewhere.</p>\n\n<p>I saw this question, which seems like exactly my situation, but didn't have enough information to help me: <a href=\"http://askubuntu.com/questions/265518/file-recovery-after-reformattig-ext3-4-partition-extract-old-journal-superblo\">File recovery after reformattig ext3/4 partition -- extract old journal/superblock?</a></p>\n\n<p>My current situation is that the drive still has a single ext3 partition, and I haven't written anything to it. I've been reading about <code>ext4magic</code>, but I'm in a bit over my head. It seems like it expects the drive to already be formatted to ext4, so should I \"upgrade\" it to ext4? I'm nervous about writing anything to it without fully understanding what I'm doing.</p>\n\n<p>The drive contains a lot of media I'd really like to save, but nothing I can't live without. I'm really only interested in recovery if I get file names as well, it's not worth listening to thousands of songs to try to identify and name them, and everything on the drive was well organized. I also don't have enough empty space to image the entire drive (it was 2TB, probably ~0.75TB full), but if that is required, I could talk myself into buying another drive for the purpose.</p>\n\n<p>Thanks in advance for reading, and even if you can point me towards some documentation I can read, that would be really helpful! I don't mind sinking a few (more) hours into trying to fix this if I learn something along the way!</p>\n\n<pre><code>~# fdisk -l /dev/sda\n\nDisk /dev/sda: 2000.4 GB, 2000398934016 bytes\n255 heads, 63 sectors/track, 243201 cylinders, total 3907029168 sectors\nUnits = sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisk identifier: 0x0007c87c\n\n   Device Boot      Start         End      Blocks   Id  System\n/dev/sda1              63  3907024064  1953512001   83  Linux\n</code></pre>\n"},{"id":106306,"title":"How to recover lost partitions data?","body":"<p>I have a 2TB SATA drive that was being used as file storage on my UBUNTU computer. I was re-imaging my windows box so I used that drive to back up some files to it. I did this by taking the drive from my windows PC and putting it in my UBUNTU PC, mounted it and copied the files over.</p>\n\n<p>After the windows refresh I thought it would be easier to take the 2 TB drive and dock it in the external dock my Windows case has built in. Anyway it would recognize in BIOS but windows would not see it (because it was EXT3 or EXT4) so when I went into the disk manager it advised me the drive needed to be initialized. Me not thinking I initialized it as a GUID Partition table. Now it sees it as a blank drive, even in UBUNTU.</p>\n\n<p>I have done nothing else to write or change the drive. I was wondering if there is a qay to repair the old partitioning and get access to my files back?</p>\n\n<p>many thanks!</p>\n\n<p>EDIT: I followed the instructions in the link @kniwor sent me. I used the command </p>\n\n<pre><code>sudo gpart -W /dev/sda /dev/sda\n</code></pre>\n\n<p>and here was the result:</p>\n\n<pre><code>Guessed primary partition table:\nPrimary partition(1)\n   type: 007(0x07)(OS/2 HPFS, NTFS, QNX or Advanced UNIX)\n   size: 0mb #s(1) s(2861671176-2861671176)\n   chs:  (1023/254/63)-(1023/254/63)d (178130/202/1)-(178130/202/1)r\n\nPrimary partition(2)\n   type: 007(0x07)(OS/2 HPFS, NTFS, QNX or Advanced UNIX)\n   size: 0mb #s(1) s(3484550160-3484550160)\n   chs:  (1023/254/63)-(1023/254/63)d (216903/55/1)-(216903/55/1)r\n\nPrimary partition(3)\n   type: 000(0x00)(unused)\n   size: 0mb #s(0) s(0-0)\n   chs:  (0/0/0)-(0/0/0)d (0/0/0)-(0/0/0)r\n\nPrimary partition(4)\n   type: 000(0x00)(unused)\n   size: 0mb #s(0) s(0-0)\n   chs:  (0/0/0)-(0/0/0)d (0/0/0)-(0/0/0)r\n</code></pre>\n\n<p>Not sure it found what I wanted. suggestions?</p>\n"},{"id":170401,"title":"Can I use testdisk to recover the Windows partition over which Ubuntu was installed?","body":"<p>I got a new Windows 7 laptop, tried to install Ubuntu 12.04 for dual boot and messed up my hard drive partitions. <strong>So opted for a clean install of Ubuntu by formatting the entire disk.</strong> (Which makes my question different from this one, <a href=\"http://askubuntu.com/questions/142340/how-to-recover-data-from-formatted-swap\">How to recover data from formatted swap?</a>)</p>\n\n<p>I need to use Windows every now and then so I was looking for a way to restore everything back to the factory setting. I didn't make the recovery disks, silly me right. I was wondering if I could reset everything back to the original setting, i.e., Windows 7 with the orignal 750GB HDD and the recovery partition which is still there. I can see the recovery partition as /dev/sdb in Ubuntu.</p>\n\n<p>Is it possible to do this with testdisk, <a href=\"http://www.cgsecurity.org/wiki/TestDisk\" rel=\"nofollow\">http://www.cgsecurity.org/wiki/TestDisk</a> ? If so how can I do it?</p>\n"},{"id":470840,"title":"How to recover deleted files in specific partitions?","body":"<p>I had windows 8 installed on my computer and had four partitions. I installed Ubuntu. And checked the option instead of windows 8. \nInstead of installing Ubuntu in the partition it just formatted the while hard drive and made just one drive and all of the other data is gone. I want to recover those files how do I do it?</p>\n"},{"id":475053,"title":"Partition table lost - how to recover lost LUKS partition, I have some backup partitioning data","body":"<p>Thanks for choosing to take a look and help. </p>\n\n<p>The problem is this: </p>\n\n<p>I have a 1TB external hard disk with \nOne encrypted partition(about 286 gb) - luks (I'll call this EP)\nOne unencrypted partition(about 580 GB).  - ntfs (i'll call this UEP)</p>\n\n<p>The rest of the partitions were empty so they don't matter. I changed the UEP to \"read only\" in windows using <code>\"diskpart attributes volume set readonly\"</code>. It seemed to work fine without issues, but after a short while there was some error and my partition table went missing partition manager said the whole drive was unalocated. So too did gparted and fdisk. </p>\n\n<p><strong>I tried using testdisk</strong> and it found all the missing partitions, When I wrote the recovered partition to disk, the UEP returned fine, but the encrypted partition is now inexplicably downsized to 2MB. </p>\n\n<p>Fortunately I did some partition data backup earlier when I was trying to convert this from GUID to MBR, before all this and have some sector data which may help in recovery. </p>\n\n<p>The Pre-Crash data created by Partition Wizard is <a href=\"http://pastebin.com/UdftHKNF\" rel=\"nofollow\">Here</a> (line 37/39 are the partitions I speak of).</p>\n\n<p>The Post-Crash data is <a href=\"http://pastebin.com/qrtL0p6s\" rel=\"nofollow\">here</a> (noticeably start of 37 and end of 39 match the luks partition from the Pre-Crash data)</p>\n\n<p>The LUKS partition is this one:</p>\n\n<pre><code>letter: * PartID:  7 Start:   137117696 End:   737118207 Size:   600000512 FsId: 255 Label:                      ClusterSize:  -1 FreeSectors:           0 Primary: 1 Bootable: 0 BootVolume: 0 SystemVolume: 0\n</code></pre>\n\n<p>Is there any way to recover the LUKS partition while also keeping the 580 GB NTFS Drive? </p>\n\n<p>I only need to recover the two drives that I have discussed here. </p>\n\n<p>Please help me out with this. </p>\n\n<p>-Danish</p>\n"},{"id":171163,"title":"How to recover a deleted NTFS partition with data","body":"<p>I am on Ubuntu 12.04 64-bits</p>\n\n<p>I accidentally deleted a <strong>NTFS</strong> 255 GB partition using <strong>Gparted</strong>, and yes it contains <strong>LOTS</strong> of important data.</p>\n\n<p>Upon realizing the deletion I haven't yet created any file-system on it. So it still shows Unallocated.</p>\n\n<p><img src=\"http://i.stack.imgur.com/NlsEi.png\" alt=\"enter image description here\"></p>\n\n<p>I tried <strong>Testdisk</strong> , but it shows entire partitions created from the beginning.</p>\n\n<p>This <strong>sdb</strong> is my secondary drive with Xubuntu and Kubuntu on it. And that 255 GB NTFS  partition was cross platform storage drive.</p>\n\n<p>I am currently in <strong>sda</strong> with Ubuntu and Win7 in dual boot, which enables me to use it as Safe recovery option rather then Live USB drive. </p>\n\n<p><strong>First</strong> ,  should i allocate it to ? file-System for better recovery .</p>\n\n<p><strong>Second</strong> , i really need to recover data from this drive so please give me possible  suggestions and proven methods of data recovery.</p>\n\n<p><strong>Third</strong> ,does <strong>Testdisk</strong> requires deleted partition to be allocated for its recovery .</p>\n\n<p>I am currently trying the answer seen here <a href=\"http://askubuntu.com/a/24951/63025\">http://askubuntu.com/a/24951/63025</a> with Testdisk scanning for partition second time, hoping to recover it. </p>\n\n<p>It looks a duplicate but i can't confirm if the OP got it right. Since my first doubt is to <strong>allocate</strong> it or not.</p>\n\n<p>If any clarification required please do comment ,i will add it.</p>\n\n<p><strong>Edit:</strong> TestDisk deeper search results. </p>\n\n<pre><code>   The following partitions can't be recovered:\n         Partition               Start        End    Size in sectors\n    &gt;  HPFS - NTFS          22241 107 11 55592   3 27  535777280\n       FAT32 LBA            274460 158 19 460576 228 16 2989957948\n\nNTFS, 274 GB / 255 GiB\n&amp; for FAT32 LBA 1530 GB / 1425 GiB\n</code></pre>\n"},{"id":388372,"title":"How to recover deleted partition table information","body":"<p>I have booted my system from a live usb (ubuntu 12.04 64 bit) and while I was going to format a certain partition on my hard drive, I accidentally deleted the partition table {disk utility --> selected my partition from the menu on left side of the window --> format (at the upper center part of the window) --> I select partition table --> and hit format}. Now it doesn't show any partitions (see attachment). and says \"unallocated space\" whereas it is allocated and there is data that are really important and I cannot afford to lose.\nI want to ask is there any way out to recover this information. I have already used testdisk and it has found three partitions successfully whereas the fourth one is still missing. If you recommend using the same software (testdisk) kindly guide me how can I find the fourth one as well and how can I recover them later on (after finding the right partitions). I don't know if it is duplicate or not but as far as I have searched on this site, most of the posts were not helpful. Posts related to testdisk has worked for me to some extent but still I am confused. If you mind asking like this, kindly remove this question. I don't mind. Sorry for any inconvenience caused. Thanks</p>\n"},{"id":216825,"title":"Recovering deleted ext4 Ubuntu partitions using TestDisk (None partition media table type)","body":"<blockquote>\n  <p>All screenshot images in one album:</p>\n  \n  <p><a href=\"http://imgur.com/a/gqPio#0\" rel=\"nofollow\">http://imgur.com/a/gqPio#0</a> (updated: added <strong>deep search</strong> results)</p>\n</blockquote>\n\n<h2>Question</h2>\n\n<p>How do I write (recover) found partitions from <code>[None] None partition media</code> table type (unallocated space?) in <strong>TestDisk</strong>?</p>\n\n<h2>Problem</h2>\n\n<p>I changed grub settings (default entry to boot into from 0 to 4), then run the command <code>sudo update-grub</code>. I rebooted my computer. It bypassed the grub menu automatically and entered the \"Acer Recovery Manager\" (for Windows 7). I canceled it because I did not want to recovery Windows 7. I rebooted the computer again. This time I encountered:</p>\n\n<pre><code>error: no such partition.\ngrub rescue&gt;\n</code></pre>\n\n<p>I booted into Ubuntu 12.10 live and run \"GParted Partition Editor\".</p>\n\n<p>Image 0 (image album link provided above)</p>\n\n<p>Instead of unallocated space, I used to have <code>/</code> and <code>/home</code> ext4 Ubuntu partitions. I think the \"Acer Recovery Manager\" deleted (hide) them even though I canceled the process.</p>\n\n<h2>Recovering missing partitions using TestDisk</h2>\n\n<ul>\n<li><p>Image 7: This partition table is not the correct (desired) table (not the one I want).</p></li>\n<li><p>Image 10: So far, I did not find the missing partitions (above). I did not do <strong>deep search</strong> yet. I continued the search in <strong>[None] None partitioned media</strong> table type (below).</p></li>\n<li><p>Image 15: This is the correct (desired) partition table I want. The two ext4 partitions that is now converted into unallocated space. I want to recover these two.</p></li>\n<li><p>Image 16: I found the missing <code>/</code> ext4 Ubuntu partition (above).</p></li>\n<li><p>Image 19: I found the missing <code>/home</code> ext4 Ubuntu partition (above).</p></li>\n<li><p>Image 21: I found the missing <code>/</code> and <code>/home</code> ext4 Ubuntu partitions but since I am in <code>[None] None partitioned media</code> table type, I can not write (recover) the partitions (no option to <strong>write</strong>).</p></li>\n</ul>\n\n<p><strong>Updates:</strong> </p>\n\n<ul>\n<li><p>Image 24: I found the same <code>/home</code> in the <strong>deep search</strong> also (above). The <strong>deep search</strong> was done while I was still in <code>[None] None partitioned media</code> table type, maybe this is why I can't write or recover.</p></li>\n<li><p>Image 28: I found the same <code>/</code> in the <strong>deep search</strong> also (above). The <strong>deep search</strong> was done while I was still in <code>[None] None partitioned media</code> table type, maybe this is why I can't write or recover.</p></li>\n</ul>\n\n<h2>Conclusion</h2>\n\n<p>How can I recover these two partitions that are found in <strong>[None] None partitioned media</strong> table type (unallocated space?) and also in <strong>deep search</strong>?</p>\n\n<p>I have searched around and have not found anything that refers to recovering found partitions in <code>[None] None partitioned media</code> table type.</p>\n\n<h2>Updates:</h2>\n\n<p>I did not run the <strong>deep search</strong> while in <strong>[Intel]</strong> but I did run the <strong>deep search</strong> in <strong>[None]</strong> (which I thought was the same). The results are in images 24 and up (hundreds of results was listed from which I found my partitions by comparing the numbers with that of <strong>quick search</strong> results in <strong>[None]</strong> (image 15). But I was not able to write anything. So I found the numbers (start, ending, and size) which would be useful in advanced or manual recovery but I do not know how to use them.</p>\n\n<p>At the end, I just recovered some of the data from the partitions and re installed ubuntu. I wanted to recover the partitions because I did not want to install applications, modify settings, and add accounts over again.</p>\n\n<p><strong>This question is closed from my side.</strong></p>\n"},{"id":310063,"title":"Replaced Window7(4drives) with Ubuntu13.04(empty) Lost all data, TestDisk did not help","body":"<p>I have 500gb of HDD with 4 drives on Windows7, While installing Ubuntu 13.04 I selected Replace Windows (Expected to Replace Windows7 on C drive) But it Removed all the Data from other 3 drives and Not its single Empty Ext4 HDD. I have lost All data. </p>\n\n<p>BY referring AskUbuntu Tried TestDisk to recover lost partitions but this did not list any NTFS drives. </p>\n\n<p>Is there any way back to get my Data, I am all ready to keep Ubuntu or go back to Windows to get my data. </p>\n\n<p>I connected this HDD to another Window7 system, it did not recognize this HDD.  </p>\n"}]}]