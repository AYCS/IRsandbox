[{"id":590673,"title":"Why doesn&#39;t Ubuntu remove old kernels automatically?","body":"<p>I wonder why Ubuntu won't remove the old kernels automatically. </p>\n\n<p>Surely nothing is perfect and things can go wrong, so in case a update doesn't work, having a backup kernel maybe great. But it would also suffice to just keep the latest  kernel and the one before the latest and delete all the older ones.</p>\n\n<p>Is there a reason why Ubuntu won't do this automatically?.                  </p>\n","related_questions":[{"id":563483,"title":"Why doesn&#39;t apt-get autoremove remove my old kernels?","body":"<p>My boot partition is on a SSD, so it doesn't have room for more than about 8 installed kernel versions, and eventually some kernel update will fail to install because my boot partition is full of old versions. There are many questions out there about how to remove old versions (even how to automate the process), but my question is simply this: <strong>Why doesn't <code>apt-get autoremove</code> detect and remove them automatically, and is there a way I can make it do so</strong>? I mean, <code>apt-get</code> is what installed them anyway, so it knows about them, so why does it choose to leave all old versions around?</p>\n"},{"id":664474,"title":"Kernel panic Ubuntu 14.04 after accidently deleting the kernels","body":"<p>I was trying to free up some space in /boot by following <a href=\"http://askubuntu.com/a/90219/282022\">this</a>.</p>\n\n<p>I ran the last command which said it would delete all but the current using kernel.</p>\n\n<pre><code>sudo apt-get purge $(dpkg -l linux-{image,headers}-\"[0-9]*\" | awk '/ii/{print $2}' | grep -ve \"$(uname -r | sed -r 's/-[a-z]+//')\")\n</code></pre>\n\n<p>I am not sure what it did but when I rebooted it shows</p>\n\n<pre><code>kernel panic - not syncing: VFS: Unable to mount root fs on unknown-block(0,0)\n</code></pre>\n\n<p>There are more line there which I will type out if required.</p>\n\n<p>But I can boot from other kernel from <code>Advanced options for ubuntu</code> in the grub.</p>\n\n<p>I searched for some solution and tried <a href=\"http://askubuntu.com/questions/28099/how-to-restore-a-system-after-accidentally-removing-all-kernels\">this</a> by booting from a live-usb to fix the deleted kernel but     <code>apt-get install linux-image-generic</code> command showed error.</p>\n\n<p>Output for <code>uname -r</code></p>\n\n<pre><code>3.13.0-46-generic\n</code></pre>\n\n<p>Output for <code>dpkg --list | grep linux-image</code></p>\n\n<pre><code>rc  linux-image-3.13.0-32-generic                         3.13.0-32.57                                        amd64        Linux kernel image for version 3.13.0 on 64 bit x86 SMP\niF  linux-image-3.13.0-46-generic                         3.13.0-46.79                                        amd64        Linux kernel image for version 3.13.0 on 64 bit x86 SMP\niF  linux-image-3.13.0-57-generic                         3.13.0-57.95                                        amd64        Linux kernel image for version 3.13.0 on 64 bit x86 SMP\niU  linux-image-3.13.0-62-generic                         3.13.0-62.102                                       amd64        Linux kernel image for version 3.13.0 on 64 bit x86 SMP\nrc  linux-image-extra-3.13.0-32-generic                   3.13.0-32.57                                        amd64        Linux kernel extra modules for version 3.13.0 on 64 bit x86 SMP\nrH  linux-image-extra-3.13.0-44-generic                   3.13.0-44.73                                        amd64        Linux kernel extra modules for version 3.13.0 on 64 bit x86 SMP\niU  linux-image-extra-3.13.0-46-generic                   3.13.0-46.79                                        amd64        Linux kernel extra modules for version 3.13.0 on 64 bit x86 SMP\niU  linux-image-extra-3.13.0-57-generic                   3.13.0-57.95                                        amd64        Linux kernel extra modules for version 3.13.0 on 64 bit x86 SMP\niU  linux-image-extra-3.13.0-62-generic                   3.13.0-62.102                                       amd64        Linux kernel extra modules for version 3.13.0 on 64 bit x86 SMP\niU  linux-image-generic                                   3.13.0.62.69                                        amd64        Generic Linux kernel image\n</code></pre>\n\n<p>I am not sure what additional information to include. Do let me know.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Its not a duplicate.\n<code>update-initramfs -u -k version</code> is not working.\nGiving the following error.</p>\n\n<p><code>update-initramfs: Generating /boot/initrd.img-3.13.0-46-generic\nmktemp: failed to create file via template ‘/var/tmp/mkinitramfs-FW_XXXXXX’: No such file or directory\nupdate-initramfs: failed for /boot/initrd.img-3.13.0-46-generic with 1.</code></p>\n\n<p>Thing is I can't even install any other packages because when I run apt-get it first tries to remove the previous images of kernel but it cannot find them and terminates in error.\nI have searched extensively but nothing seems to help me. I also don't want to reinstall the os.\nI am not very experienced with ubuntu. Any help will be appreciated.</p>\n"},{"id":390939,"title":"Why the kernel doesn&#39;t update automatically?","body":"<p>I have two servers running 12.04 LTS. #1 has upgraded to kernel 3.2.0-57. #2 is stuck on 3.2.0-34. #2 is getting all other package upgrades. BUT, the kernel is never upgraded. This is what I have researched:</p>\n\n<ol>\n<li><code>/etc/apt/sources.list</code> are identical on both servers.</li>\n<li>The repository caches are identical, verified by: apt-cache search , and: dpkg -L linux-image.</li>\n</ol>\n\n<p>I have done: <code>sudo apt-get update</code> on the faulty server.\nI have done: <code>sudo apt-get upgrade</code> on the faulty server.</p>\n\n<p>I have verified that the kernel is not \"pinned\" by the following:</p>\n\n<pre><code>apt-mark unhold linux-image-3.2.0-34-generic\n</code></pre>\n\n<p>The system replied:</p>\n\n<pre><code>linux-image-3.2.0-generic was already not hold\n</code></pre>\n\n<p>Why don't this system upgrade the kernel when it gets other packages without a problem? Aptitude is apparently working as other packages seem to update. The cache and source list are the same.</p>\n"},{"id":607594,"title":"Why is it unsafe to delete old kernels?","body":"<p>I have run out of space on my boot drive, so I decided to remove old kernels. I found this page which describes exactly what I should do: <a href=\"https://help.ubuntu.com/community/Lubuntu/Documentation/RemoveOldKernels\">Lubuntu Documentation: Remove Old Kernels</a>.</p>\n\n<p>I have deleted the oldest kernel manually and now it is okay, but I don’t understand one thing: at the end of the article there is some code that can delete all old kernel versions, but it is marked as for advanced users only.</p>\n\n<p>I don’t really understand what the danger is here. It sounds silly, but they seem to say that there might be more than one kernel used by a specific machine at the same time.</p>\n\n<p>Is it possible that different applications on my Ubuntu machine can use different kernels simultaneously? Why is deleting all old kernels automatically considered to be dangerous?</p>\n"},{"id":579809,"title":"Boots from old kernel","body":"<p>Ran software update from Manager (Linux-3.13.0-44 is newest). When it finished, I went to Grub Customizer to remove old kernel listings. (Don't always do this, so I had kernels 3.13.0-32, 36, &amp; 43 still there---as well as 3.8.0-44!) So, I left all the kernels there and did a reboot. Tried the new kernel, but it was caught in a loop, so rebooted and tried each kernel going 'backwards';i.e., 43, then 36, then 32, and finally 3.8.0-44. Each old kernel did the same thing (caught in a loop), except for 3.8.0-44, which completed the boot into Ubuntu. Went through and removed kernels 3.13.0-32, 36, and 43. Tried to remove 3.13.0-44---my thinking was that if I removed everything except the kernel that actually worked, I could possibly download the new updates and reinstall 3.13.0-44. (FYI, I proved the active kernel: </p>\n\n<pre><code>daveandjan@ubuntu:~$ uname -r\n3.8.0-44-generic)\n</code></pre>\n\n<p>But---it wouldn't remove 3.13.0-44, received the following messages:</p>\n\n<pre><code>daveandjan@ubuntu:~$ dpkg --list | grep linux-image\nii  linux-image-3.13.0-44-generic                         3.13.0-44.73                                        amd64        Linux kernel image for version 3.13.0 on 64 bit x86 SMP\nii  linux-image-3.8.0-44-generic                          3.8.0-44.66~precise1                                amd64        Linux kernel image for version 3.8.0 on 64 bit x86 SMP\nii  linux-image-extra-3.13.0-44-generic                   3.13.0-44.73                                        amd64        Linux kernel extra modules for version 3.13.0 on 64 bit x86 SMP\nii  linux-image-generic                                   3.13.0.44.51                                        amd64        Generic Linux kernel image\nii  linux-image-generic-lts-raring                        3.13.0.44.51                                        amd64        Generic Linux kernel image\ndaveandjan@ubuntu:~$ sudo apt-get remove linux-3.13.0-44\nReading package lists... Done\nBuilding dependency tree       \nReading state information... Done\nE: Unable to locate package linux-3.13.0-44\nE: Couldn't find any package by regex 'linux-3.13.0-44'\ndaveandjan@ubuntu:~$ sudo apt-get remove linux-3.13.0-44-generic\nReading package lists... Done\nBuilding dependency tree       \nReading state information... Done\nE: Unable to locate package linux-3.13.0-44-generic\nE: Couldn't find any package by regex 'linux-3.13.0-44-generic'\ndaveandjan@ubuntu:~$ \n</code></pre>\n\n<p>I've also run \"boot-repair,\" and I have the results at paste.ubuntu.com/9947782  Didn't make any difference in what happens when it tries to boot through grub.</p>\n\n<p>I'm far from an expert in Ubuntu, but I can usually follow hints and suggestions. Anyone have one?  I can just leave things as they are, and keep using kernel 3.8.0-44, but I'm sure something is wrong somewhere and I'd like to correct the problem if it's within my understanding and ability.  Thanks!</p>\n"},{"id":483030,"title":"How to remove old kernels properly?","body":"<p>So I googled how to clean up old kernels. I am very inexperienced with Ubuntu. So I am not sure if I broke something up.</p>\n\n<p>Firstly to check the latest kernel, I used :</p>\n\n<pre><code>uname -r\n</code></pre>\n\n<p>My output was:-</p>\n\n<pre><code>3.2.0-37-generic \n</code></pre>\n\n<p>Then I tried:-</p>\n\n<pre><code>dpkg --list | grep linux-image\n</code></pre>\n\n<p>The ouput was:-</p>\n\n<pre><code>ii  linux-image-3.2.0-29-generic     3.2.0-29.46                  Linux kernel image for version 3.2.0 on 64 bit x86 SMP\nii  linux-image-3.2.0-30-generic     3.2.0-30.48                  Linux kernel image for version 3.2.0 on 64 bit x86 SMP\nii  linux-image-3.2.0-31-generic     3.2.0-31.50                  Linux kernel image for version 3.2.0 on 64 bit x86 SMP\nii  linux-image-3.2.0-32-generic     3.2.0-32.51                  Linux kernel image for version 3.2.0 on 64 bit x86 SMP\nii  linux-image-3.2.0-33-generic     3.2.0-33.52                  Linux kernel image for version 3.2.0 on 64 bit x86 SMP\nii  linux-image-3.2.0-34-generic     3.2.0-34.53                  Linux kernel image for version 3.2.0 on 64 bit x86 SMP\nii  linux-image-3.2.0-35-generic     3.2.0-35.55                  Linux kernel image for version 3.2.0 on 64 bit x86 SMP\nii  linux-image-3.2.0-36-generic     3.2.0-36.57                  Linux kernel image for version 3.2.0 on 64 bit x86 SMP\nii  linux-image-3.2.0-37-generic     3.2.0-37.58                  Linux kernel image for version 3.2.0 on 64 bit x86 SMP\niF  linux-image-3.2.0-38-generic     3.2.0-38.61                  Linux kernel image for version 3.2.0 on 64 bit x86 SMP\niF  linux-image-3.2.0-39-generic     3.2.0-39.62                  Linux kernel image for version 3.2.0 on 64 bit x86 SMP\niU  linux-image-server               3.2.0.38.46                  Linux kernel image on Server Equipment.\n</code></pre>\n\n<p>So I was supposed to remove all kernels below 37, right?</p>\n\n<p>I used:</p>\n\n<pre><code>apt-get purge linux-image-3.2.0-29-generic\n</code></pre>\n\n<p>And the outcome:</p>\n\n<pre><code>Reading package lists... Done\nBuilding dependency tree\nReading state information... Done\nYou might want to run 'apt-get -f install' to correct these:\nThe following packages have unmet dependencies:\n linux-server : Depends: linux-headers-server (= 3.2.0.38.46) but 3.2.0.39.47 is to be installed\nE: Unmet dependencies. Try 'apt-get -f install' with no packages (or specify a solution).\n</code></pre>\n\n<p>Did I mess something up? Because now <code>/boot</code> is using 98.7%. So now I need help fast! </p>\n"},{"id":88936,"title":"How to remove old kernel versions automatically?","body":"<p>I know number of ways to remove old kernel versions manually. Is there any way to remove old kernel versions automatically? Automatically, in the sense i don't have to do the same thing each time the kernel gets updated. </p>\n"},{"id":117956,"title":"Wifi works but doesn&#39;t start automatically on ubuntu 11.10","body":"<p>Good evening everyone, I have got an issue which I hope you will help me to solve.\nI was trying to update my Kernel in ubuntu from this web-site \n<a href=\"http://kernel.ubuntu.com/~kernel-ppa/mainline/v3.2-rc4-oneiric/\" rel=\"nofollow\">http://kernel.ubuntu.com/~kernel-ppa/mainline/v3.2-rc4-oneiric/</a>\nAnd everything went smooth. But, for some reason, my wifi doesn't work in new Kernel so I decided to switch back to my old one 3.0.0-17 generic and to my surprise WIFI doesn't start automatically eventhou it was working. What I mean is that I have to click on wifi icon and put a mark Enable Wireless.</p>\n\n<p>This is not a really serious issue but I don't like switch on everytime at log in my WIFI because before that it was working when system started.</p>\n\n<p>What is the cause of this and how to fix it.</p>\n\n<p>Thank you very much for you help.</p>\n"},{"id":100733,"title":"Why aren&#39;t old linux-images removed when installing new kernel updates?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://askubuntu.com/questions/2793/is-there-a-way-to-remove-hide-old-kernel-versions\">Is there a way to remove/hide old kernel versions?</a>  </p>\n</blockquote>\n\n\n\n<p>On my laptop I have limited space but install all new updates, including kernel updates. However, Ubuntu doesn't seem to uninstall old kernels after ibnstalling a new kernel update. I guess this happens with reason: since the new kernel might fail, and it would be nice if grub provides a way to select the old kernel to boot with. But do I really need the whole history?, I guess not!:</p>\n\n<pre><code>rc linux-image-2.6.32-21-generic\nrc linux-image-2.6.32-24-generic\nrc linux-image-2.6.32-25-generic\nrc linux-image-2.6.35-22-generic\nrc linux-image-2.6.35-23-generic\nrc linux-image-2.6.35-24-generic\nrc linux-image-2.6.35-25-generic\nrc linux-image-2.6.35-27-generic\nrc linux-image-2.6.35-28-generic\nrc linux-image-2.6.35-30-generic\nrc linux-image-2.6.38-10-generic\nrc linux-image-2.6.38-11-generic\nii linux-image-2.6.38-12-generic\nrc linux-image-2.6.38-8-generic\nii linux-image-3.0.0-12-generic\nii linux-image-3.0.0-13-generic\nii linux-image-3.0.0-14-generic\nii linux-image-3.0.0-15-generic\nii linux-image-3.0.0-16-generic\nii linux-image-generic\n</code></pre>\n\n<p>So I thought apt-get autoremove should remove at least some of those images, but it doesn't. I will remove those now by hand, but isn't there a way to do this automatically and to keep, lets say tha last three images? Yes a shell script and a cron job!, alternatives?</p>\n"}]}]