[{"id":715669,"title":"Cache a (non-root) hdd which already has data on it with bcache - possible?","body":"<p>Could not find any recent info on this subject, so here goes!</p>\n\n<p>I have a small home server with 2 disks:</p>\n\n<ul>\n<li>SSD (120 gb), formatted as /ext4 which has an Ubuntu Server 15.10 install (including /home, /boot, just 1 partition). Right now around 10 gb used.</li>\n<li>RAID array (4TB), connected via eSata, formatted as XFS, 1 partition with data on it, currently mounted at the directory ~/Media with an entry in /etc/fstab.</li>\n</ul>\n\n<p>I would like to create a new partition on my SSD (50 gb) and use it as a cache using bcache for my RAID array.</p>\n\n<p>Is this possible <strong>without</strong> formatting the RAID array (so keeping the XFS partition)? </p>\n\n<p>Already quite a lot of data on it and transferring it all over from my backup would take a lot of time (especially since  it's all backed up on a USB 2.0 drive).</p>\n","related_questions":[{"id":711920,"title":"Can I get SSD rw performance while keeing data security if I combine SSD &amp; HDD in RAID1","body":"<p>I have 2 storage devices; classical slow HDD( 750GB, /dev/sda ) and faster SSD( 128GB, /dev/sdb ). Currently I have installed Ubuntu &amp; Mint on same btrfs partition on SSD ( /dev/sdb5 ). My btrfs pool consists of /dev/sdb5/</p>\n\n<p>What I want to achieve is data replication on HDD while keeping SSD performance: Something like this:</p>\n\n<p>For read case it would be ideal for procedure to go like this:</p>\n\n<ul>\n<li>read from SSD</li>\n<li>check checksum</li>\n<li>if it verifies.. awesome, give me the data</li>\n<li>if not, fetch data from HDD and perform error correction through duplicate data</li>\n</ul>\n\n<p>I'd manually run (some tool I'm not sure which one... btrfs check --repair perhaps?) every month or so to check HDD checksums and corrected them via SSD data against bitrot.</p>\n\n<p>For write case:</p>\n\n<ul>\n<li>write to SSD</li>\n<li>sync to HDD when write requirements are low, thus not slowing down the system. </li>\n</ul>\n\n<p>Is this possible and how would I do it?</p>\n"},{"id":707377,"title":"Got a new SSD, don&#39;t want to wear it out but I still want to use some of it to store data files together with the old HDD","body":"<p>I've bought a brand new 250GB Samsung 850 EVO for my laptop, that I want to use as primary storage device, together with the old - but still pretty functioning - 250GB 7500 RPM HDD that I put in the former DVD bay with an adaptor caddy.</p>\n\n<p>Right now the HDD has only one big <code>ext4</code> partition containing the OS, the applications and data files, what I want to do is to use the HDD just for the data, but I don't want to miss out on the opportunity to get the speed gains of the SDD by doing so.</p>\n\n<p>What I'm searching for is a solution which combines one small, say 50GB or even less, partition on the SDD and <strong>merge</strong> it with the partition on the HDD so that the <strong>least modified</strong> of the <strong>most accessed</strong> files are <strong>automatically</strong> moved onto the SSD.</p>\n\n<p>I've looked at caches like <a href=\"https://goo.gl/fBy3pN\">EnancheIO</a> and <a href=\"https://goo.gl/cYCH9O\">Bcache</a>, but they don't seem what I want, because (correct me if I'm wrong):</p>\n\n<ul>\n<li>The space occupied by the cache partition is subtracted from the amount of space available.</li>\n<li>The cache speeds up access to the most accessed files <strong>regardless</strong> of whether they're also the <strong>least often modified</strong>, which defies the point of not wanting to wear out the SSD.</li>\n</ul>\n\n<p>Is the above correct, or could a cache (which one of those two?) help me reach my goal? If the above is correct, do you know of any other viable solution?</p>\n\n<p>Would a <em>union filesystem</em>, like <a href=\"https://goo.gl/S1eekx\">OverlayFS</a>, be helpful here? Say you monitored the HDD for the most accessed files (keeping track of their <strong>atime</strong> on a daily basis) and say you identified the least modified ones  among them (keeping track of their <strong>mtime</strong>), in theory you could move those files onto the SDD, freeing space on the HDD, whilst the <strong>union filesystem</strong> could make all that transparent to the user. </p>\n\n<p><em>Would this work?</em></p>\n"},{"id":252140,"title":"How do I install and use flashcache/bcache to cache HDD to SSD?","body":"<p>I want to know if there is anyone who has tried installing and running their kernel built with <a href=\"https://github.com/facebook/flashcache/\">flashcache</a> or <a href=\"http://bcache.evilpiepirate.org/\">bcache</a> for SSD caching?</p>\n\n<p>How did you manage to do it?</p>\n"},{"id":618063,"title":"ZFS with existing data on 1 HDD","body":"<p>I'm thinking about adding a ZFS Raid-5 to my Ubuntu Server (Home use only). Currently, I have 2 HDD, 1 is 120GB for OS and the other is 4TB for download and torrent.</p>\n\n<p>I will purchase an addition HDD to use ZFS with the existing 4TB HDD. </p>\n\n<p>But my question is how to setup ZFS with the 4TB HDD with existing data on it. I have too much data on it, and it will be a pain to back up about 2TB to another HDD and install ZFS and retransfer it back to ZFS.</p>\n\n<p>Many thanks guys,</p>\n\n<p>Best regards,</p>\n\n<p>Long</p>\n"},{"id":397638,"title":"Ubuntu Server 12.04 on a ssd &amp; data on RAID HDD","body":"<p>I'm new so please forgive me if i'm posting against the rules or something like that.\nI found some topics that are a bit related, but none with raid 10.</p>\n\n<p>I'm going to switch from Windows server to Ubuntu 12.04 (finally !!!), but now I have a question:</p>\n\n<p>I have a 128 GB SSD, that i want to use for the main OS, and I have four 1TB drives, that I want in a raid 10 configuration for all my data.</p>\n\n<p>I already tried to install, but after the installation, i rebooted and then i get the raid configuration screen (that said that there aren't any raid drives), and then nothing but a black screen with a flickering cursor a the top left (as far as i know that means the isn't any OS detected).</p>\n\n<p>So i booted in to recovery from the USB and from the [partition disk] menu, I see that my partition on the SSD is set to {not used}, but I'm sure I set it correctly before. The same is applying for the RAID volume.</p>\n\n<p>What is the best thing I can do now ?</p>\n\n<p><strong>EDIT:</strong>\n@psusi, htnx for your replay. In the Intel raid configuration manager, I added all the drives to a raid 10 (0+1) configuration, after that I started the installation and Ubuntu auto detected the raid and added it to my partitioning list. Then U just mounted the raid partition to /home and made 2 new partitions on my SSD (boot and swap) and mounted the boot part. on / </p>\n\n<p>here is the output:</p>\n\n<pre><code>~ # dmraid -s\n**** Group superset isw_hjabdiead\n--&gt; Superset\nname   : isw_hjabdiead_Data\nsize   : 3711742464\nstride : 128 \ntype   : raid01\nstatus : ok\nsubset : 2\ndevs   : 4\nspares : 0\n</code></pre>\n\n<p>Ps: sorry can't get that code block working correctly :p</p>\n"},{"id":523168,"title":"bcache is not caching all drives","body":"<p>I have 3 HDD and 1 SSD, I have successfully mounted all drives to bcache.</p>\n\n<pre><code>pavs@VAS:~$ df -h\nFilesystem      Size  Used Avail Use% Mounted on\n/dev/sda1       132G   35G   90G  28% /\nnone            4.0K     0  4.0K   0% /sys/fs/cgroup\nudev            3.9G  8.0K  3.9G   1% /dev\ntmpfs           786M  2.3M  784M   1% /run\nnone            5.0M     0  5.0M   0% /run/lock\nnone            3.9G  152K  3.9G   1% /run/shm\nnone            100M   52K  100M   1% /run/user\n/dev/bcache1    2.7T  2.1T  508G  81% /var/www/html/directlink/FTP1\n/dev/bcache2    1.8T  614G  1.2T  36% /var/www/html/directlink/FTP2\n/dev/bcache0    1.8T  188G  1.6T  11% /var/www/html/directlink/FTP3\n/dev/sdf1       367G  284G   65G  82% /media/pavs/e93284df-e52e-4a5d-a9e1-323a388b332f\n</code></pre>\n\n<p>but according to bcache stats two of the drives are caching but the third one isnt (bcache1)</p>\n\n<p><strong>bcache0</strong></p>\n\n<pre><code>pavs@VAS:~$ tail /sys/block/bcache0/bcache/stats_total/*\n==&gt; /sys/block/bcache0/bcache/stats_total/bypassed &lt;==\n161G\n\n==&gt; /sys/block/bcache0/bcache/stats_total/cache_bypass_hits &lt;==\n4440257\n\n==&gt; /sys/block/bcache0/bcache/stats_total/cache_bypass_misses &lt;==\n0\n\n==&gt; /sys/block/bcache0/bcache/stats_total/cache_hit_ratio &lt;==\n69\n\n==&gt; /sys/block/bcache0/bcache/stats_total/cache_hits &lt;==\n1360041\n\n==&gt; /sys/block/bcache0/bcache/stats_total/cache_miss_collisions &lt;==\n426\n\n==&gt; /sys/block/bcache0/bcache/stats_total/cache_misses &lt;==\n587356\n\n==&gt; /sys/block/bcache0/bcache/stats_total/cache_readaheads &lt;==\n0\n</code></pre>\n\n<p><strong>bcache1</strong></p>\n\n<pre><code>pavs@VAS:~$ tail /sys/block/bcache1/bcache/stats_total/*\n==&gt; /sys/block/bcache1/bcache/stats_total/bypassed &lt;==\n0\n\n==&gt; /sys/block/bcache1/bcache/stats_total/cache_bypass_hits &lt;==\n0\n\n==&gt; /sys/block/bcache1/bcache/stats_total/cache_bypass_misses &lt;==\n0\n\n==&gt; /sys/block/bcache1/bcache/stats_total/cache_hit_ratio &lt;==\n0\n\n==&gt; /sys/block/bcache1/bcache/stats_total/cache_hits &lt;==\n0\n\n==&gt; /sys/block/bcache1/bcache/stats_total/cache_miss_collisions &lt;==\n0\n\n==&gt; /sys/block/bcache1/bcache/stats_total/cache_misses &lt;==\n0\n\n==&gt; /sys/block/bcache1/bcache/stats_total/cache_readaheads &lt;==\n0\n</code></pre>\n\n<p><strong>bcache2</strong></p>\n\n<pre><code>pavs@VAS:~$ tail /sys/block/bcache2/bcache/stats_total/*\n==&gt; /sys/block/bcache2/bcache/stats_total/bypassed &lt;==\n193G\n\n==&gt; /sys/block/bcache2/bcache/stats_total/cache_bypass_hits &lt;==\n4329693\n\n==&gt; /sys/block/bcache2/bcache/stats_total/cache_bypass_misses &lt;==\n0\n\n==&gt; /sys/block/bcache2/bcache/stats_total/cache_hit_ratio &lt;==\n74\n\n==&gt; /sys/block/bcache2/bcache/stats_total/cache_hits &lt;==\n1859198\n\n==&gt; /sys/block/bcache2/bcache/stats_total/cache_miss_collisions &lt;==\n232\n\n==&gt; /sys/block/bcache2/bcache/stats_total/cache_misses &lt;==\n650958\n\n==&gt; /sys/block/bcache2/bcache/stats_total/cache_readaheads &lt;==\n0\n</code></pre>\n\n<p>I am new to bcache so I obviously missed something, what did I miss and please help me find the solution. Let me know if you need any more information.</p>\n"},{"id":496395,"title":"Ubuntu Server setup: How to install Ubuntu on one drive and use other drive for file storage?","body":"<p>I've built a computer to use as a home file server. I will be installing Ubuntu Server. I've put a small SSD and two large HDDs in it. I have no prior experience with Ubuntu (desktop or server). I've watched several videos that walkthrough the server installation and setup process and I've read lots of tutorials explaining it. I'm confident I can get it setup and configured but I want to install the Ubuntu server on the SSD and then use the two HDDs for file storage, preferably in RAID 1.</p>\n\n<p>So how do I set it up so that the OS is on the SSD and all the files are on the HDDs? All the videos/tutorials I've watched/read have just used one drive for the OS AND the file storage.</p>\n\n<p>Any helpful instructions or links would be very much appreciated.</p>\n"},{"id":367543,"title":"Ubuntu 13.10 on SSD (system) and HDD (data). Missing /grub/i386-pc/normal.mod","body":"<p>I've got a HDD (750 GB) and a SSD (16 GB). I want to install Ubuntu (13.10) on the SSD, but because of its small size, I need to install /home, /var and /tmp on the HDD. After that, I would like to install Windows (system + data) on another partition of that HDD, but it is not important now.</p>\n\n<p>I installed Ubuntu (I had formatted and partitioned the disk before), but when I restarted my laptop it said: </p>\n\n<pre><code>'error: file '/grub/i386-pc/normal.mod' not found.\n grub rescue&gt;'\n</code></pre>\n\n<p>I tried to reinstall Grub 2 using <a href=\"http://howtoubuntu.org/how-to-repair-restore-reinstall-grub-2-with-a-ubuntu-live-cd#.Um7TLHigphE\" rel=\"nofollow\">this</a> tutorial (as sdXY I used sdb1, because it's the only one partition of my SSD), but it didn't work.</p>\n\n<p>Can anybody help me, please?</p>\n"},{"id":217524,"title":"raid advice with SSD and two HDD","body":"<p>I have a new machine with one 128GB SSD and two 1TB HDD. On the SSD is the OS and my initial thought was to put the two HDD in RAID 1 for user data.</p>\n\n<p>After some more thought I came up with two other setups and now I'm in doubt :) Can someone advise what would be the best setup?</p>\n\n<p>1: single SSD and HDD in RAID 1 (original thought)</p>\n\n<p>2: Create 2 partitions on the HDD (128GB and 872GB). Put the two 872GB in RAID 1 and create another RAID 1 with the SSD and one 128GB HDD partition.</p>\n\n<p>3: Create 2 partitions on the HDD (750/250), put the 705GB in RAID 1 and use the 2 250GB as backup and make automatic snapshots of the SSD to (one of) these partitions.</p>\n\n<p>I think the 2 main questions are: </p>\n\n<p>Is it advisable to create a raid array with only part of a drive and actively use the other part of that drive or should you always use the full disk?</p>\n\n<p>Is it advisable to create a raid 1 array with a SSD and HDD or will that blow the whole speed advantage of the SSD?</p>\n"},{"id":48733,"title":"Possible/viable to make a btrfs RAID between SSD and HDD?","body":"<p>Since I don't use my laptop's CD-drive I want to put a small (8 GB) <a href=\"http://rads.stackoverflow.com/amzn/click/B002WE2QTU\" rel=\"nofollow\">SSD</a> into the CD-drive slot (I'll use a caddy similar to <a href=\"http://forum.notebookreview.com/hp-business-class-notebooks/384202-2530p-second-harddrive-via-optical-drive-bay.html\" rel=\"nofollow\">this one</a>). I want to use compressed btrfs on the SSD and put all the data on the big HDD. </p>\n\n<p>Is it viable to do a RAID 1 with SSD and a same-size partition of the HDD?</p>\n\n<p>Maybe even remount the RAID -o degraded after boot and spin down the HDD :-) ?</p>\n"}]}]