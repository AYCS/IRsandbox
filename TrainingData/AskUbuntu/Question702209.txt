[{"id":702209,"title":"How do I disable unnecessary services without uninstalling them in Ubuntu 15.10?","body":"<p>There are some daemons I make zero use of and would like prevent from autostarting, those include avahi, zeitgeist, telepathy, apport and some others. Needless to say I'd like them not to start. Can this be achieved without uninstalling them (there still are dependencies and I even believe an occasion can heppen when I'll actually need them)?</p>\n","related_questions":[{"id":692732,"title":"How to reproduce &quot;systemctl EDIT&quot; behavior in Ubuntu LTS","body":"<p><strong>Context:</strong> I'm trying to configure DNScrypt. The instructions call the command:</p>\n\n<pre><code>sudo systemctl edit dnscrypt-proxy.socket\n</code></pre>\n\n<p>The <strong>edit</strong> command for <code>systemd</code> was introduced in version 218. Ubuntu LTS and Debian stable shipped with <code>systemd</code> version 215. </p>\n\n<p>How do I mimic the behavior of the <strong>edit</strong> command manually? </p>\n"},{"id":205937,"title":"How can I disable avahi-daemon?","body":"<h3>How can I disable avahi-daemon and can you explain to me how it runs if it appears as a service but it itsn't in rcN.d?</h3>\n\n<hr>\n\n<p>You can stop reading here. In fact, please do unless you want to TEACH a noob some Ubuntu. The question above should be clear enough to be answered. The rest is just me calling out for some more structured way of finding one's way around Ubuntu. I can more or less use other \"UNIX-like\" systems.</p>\n\n<p>I am a beginner so if I act nonsensically, consider me your daily WTF but do help me improve, please.</p>\n\n<p>At every boot, <code>/sbin/init</code> seems to be launching a process called <code>avahi-daemon</code></p>\n\n<pre><code># initctl list | grep avahi\navahi-daemon start/running, process 1280\n</code></pre>\n\n<p>as user <code>avahi</code></p>\n\n<pre><code># id avahi\nuid=107(avahi) gid=118(avahi) groups=118(avahi)\n</code></pre>\n\n<p>a <code>ps -efww ef</code> shows 2 processes active, both called <code>avahi-daemon</code>, and the <code>PPID</code> of the first <code>avahi-daemon</code> is indeed <code>1</code>, the second process is just a child of the first. The <code>PPID</code> = <code>1</code> is what makes me think this was auto-started.</p>\n\n<hr>\n\n<p><em>Optionally:</em></p>\n\n<p>I don't really know how to check properly what gets executed at system startup, thinking about it.</p>\n\n<p><em>Is this the way to get a list of services that run at startup?</em> <code>initctl list | sort</code></p>\n\n<hr>\n\n<p>anyway, I seem to be able to temporarily stop this \"service\" through this command:</p>\n\n<pre><code>service avahi-daemon stop\n</code></pre>\n\n<p>or indeed this command</p>\n\n<pre><code>/etc/init.d/avahi-daemon stop\n</code></pre>\n\n<p>directly, which is what this <code>/usr/sbin/service</code> seems to be using:</p>\n\n<pre><code>env -i LANG=\"$LANG\" PATH=\"$PATH\" TERM=\"$TERM\" \"$SERVICEDIR/$SERVICE\"\n</code></pre>\n\n<p>When launched, the script reminds me that I am controlling an \"Upstart\" service, and that I should use the simpler invocation <code>stop avahi-daemon</code>. I guess I will need to learn about Upstart but for now, all I need to learn is this:</p>\n\n<p><em>how do I disable services in Ubuntu?</em></p>\n\n<p>Here is what I tried (this should be the proper way to do it, or is it not?):</p>\n\n<pre><code>update-rc.d avahi-daemon disable\n</code></pre>\n\n<p>but it complains:</p>\n\n<pre><code>System start/stop links for /etc/init.d/avahi-daemon do not exist\n</code></pre>\n\n<p>so I went hunting for the path to the binary:</p>\n\n<pre><code># Let me know if there is a better way to get the path above\nreadlink \"/proc/$(echo `ps --no-headers -o pid -C avahi-daemon | head -n 1`)/exe\"\n</code></pre>\n\n<p>which is this:</p>\n\n<pre><code>/usr/sbin/avahi-daemon\n</code></pre>\n\n<p>and anything that could be considered an \"executable file\" in <code>etc</code>:</p>\n\n<pre><code>find /etc -type f -name '*avahi*' -perm -u+x\n</code></pre>\n\n<p>thinking I would find startup scripts in <code>/etc/rcN.d</code>. I found other things instead:</p>\n\n<pre><code>/etc/dhcp/dhclient-exit-hooks.d/zzz_avahi-autoipd\n/etc/dhcp/dhclient-enter-hooks.d/avahi-autoipd\n/etc/resolvconf/update-libc.d/avahi-daemon\n/etc/network/if-up.d/avahi-autoipd\n/etc/network/if-up.d/avahi-daemon\n/etc/network/if-down.d/avahi-autoipd\n/etc/avahi/avahi-autoipd.action\n</code></pre>\n\n<p>seems like this <code>avahi-daemon</code> thing is being launched on network state changes? Is there a better way to hunt down binaries automatically started on a system?</p>\n\n<p>I would have normally obliterated the symlinks in the various <code>rc{3,5}.d</code> at this stage but now I am not too sure. What exactly starts this beast? How to disable it without <code>apt-get remove</code> or <code>apt-get purge</code>?</p>\n\n<p>It does not have too many resources open, as far as I can see:</p>\n\n<pre><code>lsof -p $(echo `ps --no-headers -o pid -C avahi-daemon | head -n 1`)\n</code></pre>\n\n<p>nor does it use too many CPU cycles, based on a quick glance at <code>htop</code>.</p>\n\n<p>I wrote this one-liner to see if it goes funky on CPU util over a period of one minute, and it never does, but let me know if there are better ways to check that:</p>\n\n<pre><code>for i in {1..59}; do ps -p $(echo `ps --no-headers -o pid -C avahi-daemon | head -n 1`) --no-headers -o pcpu; sleep 1; done\n</code></pre>\n"},{"id":676007,"title":"How do I make my systemd service run via specific user and start on boot?","body":"<p>I just upgraded from Ubuntu server 14 to version 15. I had trouble getting my upstart script working after the upgrade, and read that systemd is the new default. I'm far from a linux expert, so please go easy on me :-)</p>\n\n<p>Here is what my upstart script was before:</p>\n\n<pre><code>description \"NZBGet upstart script\"\n\nsetuid robert\nsetgid robert\n\nstart on runlevel [2345]\nstop on runlevel [016]\n\nrespawn\n\nexpect fork\n\nscript\n    exec nzbget -D\nend script\n\npre-stop script\n    exec nzbget -Q\nend script\n</code></pre>\n\n<p>Based on the <a href=\"https://wiki.ubuntu.com/SystemdForUpstartUsers\" rel=\"nofollow\">upstart to systemd wiki page</a>, I used the tables provided there to map things as closely as I could in my new systemd service file:</p>\n\n<pre><code>[Unit]\nDescription=NZBGet Service\n\n[Service]\nType=forking\nExecStart=/usr/local/bin/nzbget -D\nExecStop=/usr/local/bin/nzbget -Q\nRestart=on-failure\n</code></pre>\n\n<p>This file is located at <code>/home/robert/.config/systemd/user/nzbget.service</code>. To start the service manually, I've been doing:</p>\n\n<pre><code>$ systemctl --user start nzbget\n</code></pre>\n\n<p>This works great. However, when I log out of my SSH session, the service shuts down. Also, it does not start on bootup or user login. I want it to behave the same as it did as an upstart service: I want it to start at boot, run constantly, and as a specific user.</p>\n\n<p>What do I need to do to get this configuration?</p>\n"},{"id":659267,"title":"How do I override or configure systemd services?","body":"<p>Many sysv init scripts used a corresponding file in <code>/etc/default</code> to allow the administrator to configure it. Upstart jobs can be modified using <code>.override</code> files. How do I override or configure systemd units, now that systemd is the default in Ubuntu?</p>\n"},{"id":27134,"title":"Disable autostart for a service without uninstalling?","body":"<p>How can I disable autostart for a service without uninstalling?  For example, I'd like to leave tomcat installed, but I don't want it turning on every time I restart.</p>\n"},{"id":611489,"title":"System D services Disabled on Boot list Ubuntu 14.10","body":"<p>I'm still a noob in many ways, but I have been running a Ubuntu home server in various forms for the last two years. Mostly just for my own education, so experimentation and exploration usually guide my path. My latest plan led me to remove upstart and sysvinit completely and throw myself headfirst in to systemd. It was successful and everything works even after two months, multiple physical disk changes, a move across three time zones, and a complete swap-out of the motherboard!  Ok, so now that I've made myself feel better, I can admit that I'm still trying to understand the services and the boot up process of systemd. The main problem is certain services that seem like they should be enables at boot, are not currently, and there are some hiccups here and there that may be explained by this fact. So at last I get to the point.</p>\n\n<p>How do I know what is required to be enabled? (And does that mean that the target and service both are required?) </p>\n\n<p>It gets confusing to me when certain services that I know should be enabled are configured to run after other services that I know I don't need (like Plymouth) for a headless system; or when I see possible duplicate <code>init.d</code> items like (<code>thermald</code> and <code>thermald.service</code>). Maybe these are left over from sysv or upstart? How do I know for sure? </p>\n\n<p><a href=\"https://www.dropbox.com/s/idm29intj4m7hej/systemctl.txt?dl=0\" rel=\"nofollow\">Here's some output</a> for reference:</p>\n\n<pre>systemctl\nUNIT                                            LOAD   ACTIVE SUB       DESCRIPTION\nproc-sys-fs-binfmt_misc.automount               loaded active running   Arbitrary Executable File Formats File System Au\nsys-devices-pci...2:0:0:0-block-sdf-sdf1.device loaded active plugged   ST3300831SCE\nsys-devices-pci...:0:0-2:0:0:0-block-sdf.device loaded active plugged   ST3300831SCE\nsys-devices-pci...3:0:0:0-block-sde-sde1.device loaded active plugged   External_HDD\nsys-devices-pci...3:0:0:0-block-sde-sde2.device loaded active plugged   External_HDD\nsys-devices-pci...3:0:0:0-block-sde-sde3.device loaded active plugged   External_HDD\nsys-devices-pci...3:0:0:0-block-sde-sde4.device loaded active plugged   External_HDD\nsys-devices-pci...3:0:0:0-block-sde-sde5.device loaded active plugged   External_HDD\nsys-devices-pci...3:0:0:0-block-sde-sde6.device loaded active plugged   External_HDD\nsys-devices-pci...:0:0-3:0:0:0-block-sde.device loaded active plugged   External_HDD\nsys-devices-pci...4:0:0:0-block-sdd-sdd1.device loaded active plugged   Touro_Mobile_3.0\nsys-devices-pci...4:0:0:0-block-sdd-sdd2.device loaded active plugged   Touro_Mobile_3.0\nsys-devices-pci...:0:0-4:0:0:0-block-sdd.device loaded active plugged   Touro_Mobile_3.0\nsys-devices-pci...-0000:01:00.0-net-eth0.device loaded active plugged   RTL8169 PCI Gigabit Ethernet Controller (RTL8169\nsys-devices-pci...0000:01:01.0-tty-ttyS1.device loaded active plugged   FA82537EP 56K V.92 Data/Fax Modem PCI\n****Redacted 28 similar lines for Modem that I don't use To get under limit for this forum*\nsys-devices-pci...-0000:01:08.0-net-eth1.device loaded active plugged   82562EZ 10/100 Ethernet Controller (Dimension 30\nsys-devices-pci...0:0:0:0-block-sda-sda1.device loaded active plugged   WDC_WD1600AAJB-00PVA0\nsys-devices-pci...:0:0-0:0:0:0-block-sda.device loaded active plugged   WDC_WD1600AAJB-00PVA0\nsys-devices-pci...0:0:1:0-block-sdb-sdb1.device loaded active plugged   WDC_WD800BB-55JKC0\nsys-devices-pci...:0:1-0:0:1:0-block-sdb.device loaded active plugged   WDC_WD800BB-55JKC0\nsys-devices-pci...:0:0-1:0:0:0-block-sr0.device loaded active plugged   DVD-ROM_16X\nsys-devices-pci...1:0:1:0-block-sdc-sdc1.device loaded active plugged   ST3160023A\nsys-devices-pci...1:0:1:0-block-sdc-sdc2.device loaded active plugged   ST3160023A\nsys-devices-pci...1:0:1:0-block-sdc-sdc5.device loaded active plugged   ST3160023A\nsys-devices-pci...:0:1-1:0:1:0-block-sdc.device loaded active plugged   ST3160023A\nsys-devices-pci...00:00:1f.5-sound-card0.device loaded active plugged   82801EB/ER (ICH5/ICH5R) AC'97 Audio Controller\nsys-devices-pla...m-serial8250-tty-ttyS2.device loaded active plugged   /sys/devices/platform/serial8250/tty/ttyS2\nsys-devices-pla...m-serial8250-tty-ttyS3.device loaded active plugged   /sys/devices/platform/serial8250/tty/ttyS3\nsys-devices-pnp0-00:04-tty-ttyS0.device         loaded active plugged   /sys/devices/pnp0/00:04/tty/ttyS0\nsys-devices-pnp0-00:05-printer-lp0.device       loaded active plugged   /sys/devices/pnp0/00:05/printer/lp0\nsys-devices-virtual-block-dm\\x2d0.device        loaded active plugged   /sys/devices/virtual/block/dm-0\nsys-devices-virtual-block-dm\\x2d1.device        loaded active plugged   /sys/devices/virtual/block/dm-1\nsys-devices-virtual-block-dm\\x2d2.device        loaded active plugged   /sys/devices/virtual/block/dm-2\nsys-devices-virtual-block-dm\\x2d3.device        loaded active plugged   /sys/devices/virtual/block/dm-3\nsys-devices-virtual-block-loop0.device          loaded active plugged   /sys/devices/virtual/block/loop0\nsys-devices-virtual-block-loop1.device          loaded active plugged   /sys/devices/virtual/block/loop1\nsys-devices-virtual-block-loop2.device          loaded active plugged   /sys/devices/virtual/block/loop2\nsys-devices-virtual-block-loop3.device          loaded active plugged   /sys/devices/virtual/block/loop3\nsys-devices-virtual-block-loop4.device          loaded active plugged   /sys/devices/virtual/block/loop4\nsys-devices-virtual-block-loop5.device          loaded active plugged   /sys/devices/virtual/block/loop5\nsys-devices-virtual-block-loop6.device          loaded active plugged   /sys/devices/virtual/block/loop6\nsys-devices-virtual-block-loop7.device          loaded active plugged   /sys/devices/virtual/block/loop7\nsys-devices-virtual-tty-ttyprintk.device        loaded active plugged   /sys/devices/virtual/tty/ttyprintk\nsys-module-fuse.device                          loaded active plugged   /sys/module/fuse\nsys-subsystem-net-devices-eth0.device           loaded active plugged   RTL8169 PCI Gigabit Ethernet Controller (RTL8169\nsys-subsystem-net-devices-eth1.device           loaded active plugged   82562EZ 10/100 Ethernet Controller (Dimension 30\n-.mount                                         loaded active mounted   /\nboot.mount                                      loaded active mounted   /boot\ndev-hugepages.mount                             loaded active mounted   Huge Pages File System\ndev-mqueue.mount                                loaded active mounted   POSIX Message Queue File System\nmedia-backup.mount                              loaded active mounted   /media/backup\nmedia-Digmedia.mount                            loaded active mounted   /media/Digmedia\nproc-sys-fs-binfmt_misc.mount                   loaded active mounted   Arbitrary Executable File Formats File System\nrun-lock.mount                                  loaded active mounted   Lock Directory\nrun-user.mount                                  loaded active mounted   User Runtime Directory\nsys-fs-fuse-connections.mount                   loaded active mounted   FUSE Control File System\nsys-kernel-debug.mount                          loaded active mounted   Debug File System\nsystemd-ask-password-console.path               loaded active waiting   Dispatch Password Requests to Console Directory\nsystemd-ask-password-wall.path                  loaded active waiting   Forward Password Requests to Wall Directory Watc\nsession-344.scope                               loaded active running   Session 344 of user jrec-u\nsession-c1.scope                                loaded active running   Session c1 of user jrec-u\naccounts-daemon.service                         loaded active running   Accounts Service\napache2.service                                 loaded active running   LSB: Apache2 web server\napparmor.service                                loaded active exited    LSB: AppArmor initialization\napport.service                                  loaded active exited    LSB: automatic crash report generation\natd.service                                     loaded active running   Deferred execution scheduler\nconsole-setup.service                           loaded active exited    LSB: Set console font and keymap\ncron.service                                    loaded active running   Regular background program processing daemon\ndbus.service                                    loaded active running   D-Bus System Message Bus\nddclient.service                                loaded active running   LSB: Update dynamic domain name service entries\ndns-clean.service                               loaded active exited    LSB: Cleans up any mess left by 0dns-up\ngetty@tty1.service                              loaded active running   Getty on tty1\ngrub-common.service                             loaded active exited    LSB: Record successful boot for GRUB\nifup@eth0.service                               loaded failed failed    ifup for eth0\nifup@eth1.service                               loaded failed failed    ifup for eth1\nirqbalance.service                              loaded active exited    LSB: daemon to balance interrupts for SMP system\nkmod-static-nodes.service                       loaded active exited    Create list of required static device nodes for\nlvm2.service                                    loaded active exited    lvm2.service\nminidlna.service                                loaded active running   LSB: DLNA/UPnP-AV media server\nmysql.service                                   loaded active running   LSB: Start and stop the mysql database server da\nnetworking.service                              loaded active exited    LSB: Raise network interfaces.\nnmbd.service                                    loaded active running   LSB: start Samba NetBIOS nameserver (nmbd)\nondemand.service                                loaded active exited    LSB: Set the CPU Frequency Scaling governor to \"\npolkitd.service                                 loaded active running   Authenticate and Authorize Users to Run Privileg\npppd-dns.service                                loaded active exited    LSB: Restore resolv.conf if the system crashed.\nrc-local.service                                loaded active exited    /etc/rc.local Compatibility\nresolvconf.service                              loaded active exited    Nameserver information manager\nrsyslog.service                                 loaded active running   System Logging Service\nsamba-ad-dc.service                             loaded active exited    LSB: start Samba daemons for the AD DC\nsamba.service                                   loaded active exited    LSB: ensure Samba daemons are started (nmbd and\nsmbd.service                                    loaded active running   LSB: start Samba SMB/CIFS daemon (smbd)\nssh.service                                     loaded active running   OpenBSD Secure Shell server\nsystemd-fsck-root.service                       loaded active exited    File System Check on Root Device\nsystemd-fsck@de...er-BackupVG\\x2dcoreLV.service loaded active exited    File System Check on /dev/mapper/BackupVG-coreLV\nsystemd-fsck@de...pper-take2\\x2dnewdigs.service loaded active exited    File System Check on /dev/mapper/take2-newdigs\nsystemd-journald.service                        loaded active running   Journal Service\nsystemd-logind.service                          loaded active running   Login Service\nsystemd-modules-load.service                    loaded active exited    Load Kernel Modules\nsystemd-random-seed.service                     loaded active exited    Load/Save Random Seed\nsystemd-remount-fs.service                      loaded active exited    Remount Root and Kernel File Systems\nsystemd-sysctl.service                          loaded active exited    Apply Kernel Variables\nsystemd-tmpfiles-setup-dev.service              loaded active exited    Create static device nodes in /dev\nsystemd-tmpfiles-setup.service                  loaded active exited    Create Volatile Files and Directories\nsystemd-udev-settle.service                     loaded active exited    udev Wait for Complete Device Initialization\nsystemd-udev-trigger.service                    loaded active exited    udev Coldplug all Devices\nsystemd-udevd.service                           loaded active running   udev Kernel Device Manager\nsystemd-update-utmp.service                     loaded active exited    Update UTMP about System Reboot/Shutdown\nsystemd-user-sessions.service                   loaded active exited    Permit User Sessions\nthermald.service                                loaded failed failed    Thermal Daemon Service\ntransmission-daemon.service                     loaded active exited    LSB: Start the transmission BitTorrent daemon cl\nudev-finish.service                             loaded active exited    Copy rules generated while the root was ro\nufw.service                                     loaded active exited    Uncomplicated firewall\nuser@1000.service                               loaded active running   User Manager for 1000\nuuidd.service                                   loaded active running   Daemon for generating UUIDs\nwebmin.service                                  loaded active running   LSB: Start or stop the Webmin server\nwinbind.service                                 loaded active running   LSB: start Winbind daemon\n-.slice                                         loaded active active    Root Slice\nsystem-getty.slice                              loaded active active    system-getty.slice\nsystem.slice                                    loaded active active    System Slice\nuser-1000.slice                                 loaded active active    user-1000.slice\nuser.slice                                      loaded active active    User and Session Slice\nacpid.socket                                    loaded active listening ACPID Listen Socket\ndbus.socket                                     loaded active running   D-Bus System Message Bus Socket\nsyslog.socket                                   loaded active running   Syslog Socket\nsystemd-initctl.socket                          loaded active listening /dev/initctl Compatibility Named Pipe\nsystemd-journald.socket                         loaded active running   Journal Socket\nsystemd-shutdownd.socket                        loaded active listening Delayed Shutdown Socket\nsystemd-udevd-control.socket                    loaded active running   udev Control Socket\nsystemd-udevd-kernel.socket                     loaded active running   udev Kernel Socket\nuuidd.socket                                    loaded active running   UUID daemon activation socket\ndev-dm\\x2d1.swap                                loaded active active    /dev/dm-1\nbasic.target                                    loaded active active    Basic System\ncryptsetup.target                               loaded active active    Encrypted Volumes\ngetty.target                                    loaded active active    Login Prompts\ngraphical.target                                loaded active active    Graphical Interface\nlocal-fs-pre.target                             loaded active active    Local File Systems (Pre)\nlocal-fs.target                                 loaded active active    Local File Systems\nmulti-user.target                               loaded active active    Multi-User System\nnetwork-online.target                           loaded active active    Network is Online\nnetwork.target                                  loaded active active    Network\npaths.target                                    loaded active active    Paths\nprinter.target                                  loaded active active    Printer\nremote-fs-pre.target                            loaded active active    Remote File Systems (Pre)\nremote-fs.target                                loaded active active    Remote File Systems\nslices.target                                   loaded active active    Slices\nsockets.target                                  loaded active active    Sockets\nsound.target                                    loaded active active    Sound Card\nswap.target                                     loaded active active    Swap\nsysinit.target                                  loaded active active    System Initialization\nsyslog.target                                   loaded active active    Syslog\ntimers.target                                   loaded active active    Timers\nsystemd-tmpfiles-clean.timer                    loaded active waiting   Daily Cleanup of Temporary Directories\n\nLOAD   = Reflects whether the unit definition was properly loaded.\nACTIVE = The high-level unit activation state, i.e. generalization of SUB.\nSUB    = The low-level unit activation state, values depend on unit type.\n\n180 loaded units listed. Pass --all to see loaded but inactive units, too.\nTo show all installed unit files use 'systemctl list-unit-files'.\nlines 160-188/188 (END)</pre>\n\n<pre>$ systemctl list-unit-files\nUNIT FILE                              STATE\nproc-sys-fs-binfmt_misc.automount      static\ndev-hugepages.mount                    static\ndev-mqueue.mount                       static\nproc-sys-fs-binfmt_misc.mount          static\nrun-lock.mount                         static\nrun-user.mount                         static\nsys-fs-fuse-connections.mount          static\nsys-kernel-config.mount                static\nsys-kernel-debug.mount                 static\ntmp.mount                              disabled\nsystemd-ask-password-console.path      static\nsystemd-ask-password-wall.path         static\nsession-344.scope                      static\nsession-c1.scope                       static\naccounts-daemon.service                enabled\nacpid.service                          disabled\natd.service                            enabled\nautovt@.service                        disabled\nbootlogd.service                       masked\nbootlogs.service                       masked\nbootmisc.service                       masked\ncheckfs.service                        masked\ncheckroot-bootclean.service            masked\ncheckroot.service                      masked\nconsole-getty.service                  disabled\nconsole-shell.service                  disabled\ncron.service                           enabled\ncryptdisks-early.service               masked\nlines 1-29...skipping...\nUNIT FILE                              STATE\nproc-sys-fs-binfmt_misc.automount      static\ndev-hugepages.mount                    static\ndev-mqueue.mount                       static\nproc-sys-fs-binfmt_misc.mount          static\nrun-lock.mount                         static\nrun-user.mount                         static\nsys-fs-fuse-connections.mount          static\nsys-kernel-config.mount                static\nsys-kernel-debug.mount                 static\ntmp.mount                              disabled\nsystemd-ask-password-console.path      static\nsystemd-ask-password-wall.path         static\nsession-344.scope                      static\nsession-c1.scope                       static\naccounts-daemon.service                enabled\nacpid.service                          disabled\natd.service                            enabled\nautovt@.service                        disabled\nbootlogd.service                       masked\nbootlogs.service                       masked\nbootmisc.service                       masked\ncheckfs.service                        masked\ncheckroot-bootclean.service            masked\ncheckroot.service                      masked\nconsole-getty.service                  disabled\nconsole-shell.service                  disabled\ncron.service                           enabled\ncryptdisks-early.service               masked\ncryptdisks.service                     masked\ndbus-org.freedesktop.hostname1.service static\ndbus-org.freedesktop.locale1.service   static\ndbus-org.freedesktop.login1.service    static\ndbus-org.freedesktop.machine1.service  static\ndbus-org.freedesktop.thermald.service  enabled\ndbus-org.freedesktop.timedate1.service static\ndbus.service                           static\ndebian-fixup.service                   static\ndebug-shell.service                    disabled\nemergency.service                      static\nfriendly-recovery.service              enabled\nfuse.service                           masked\ngetty@.service                         enabled\nhalt-local.service                     static\nhalt.service                           masked\nhostname.service                       masked\nhwclock.service                        masked\nhwclockfirst.service                   masked\nifup@.service                          static\ninitrd-cleanup.service                 static\ninitrd-parse-etc.service               static\ninitrd-switch-root.service             static\ninitrd-udevadm-cleanup-db.service      static\nkillprocs.service                      masked\nkmod-static-nodes.service              static\nkmod.service                           static\nmodule-init-tools.service              static\nmotd.service                           masked\nmountall-bootclean.service             masked\nmountall.service                       masked\nmountdevsubfs.service                  masked\nmountkernfs.service                    masked\nmountnfs-bootclean.service             masked\nmountnfs.service                       masked\npolkitd.service                        static\nprocps.service                         static\nquotaon.service                        static\nrc-local.service                       static\nrc.local.service                       static\nreboot.service                         masked\nrescue.service                         static\nresolvconf.service                     enabled\nrmnologin.service                      masked\nrsync.service                          disabled\nrsyslog.service                        enabled\nscreen-cleanup.service                 masked\nsendsigs.service                       masked\nserial-getty@.service                  disabled\nsingle.service                         masked\nssh.service                            enabled\nssh@.service                           static\nsshd.service                           enabled\nstop-bootlogd-single.service           masked\nstop-bootlogd.service                  masked\nsudo.service                           disabled\nsyslog.service                         enabled\nsystemd-ask-password-console.service   static\nsystemd-ask-password-wall.service      static\nsystemd-backlight@.service             static\nsystemd-binfmt.service                 static\nsystemd-fsck-root.service              static\nsystemd-fsck@.service                  static\nsystemd-halt.service                   static\nsystemd-hibernate.service              static\nsystemd-hostnamed.service              static\nsystemd-hybrid-sleep.service           static\nsystemd-initctl.service                static\nsystemd-journal-flush.service          static\nsystemd-journald.service               static\nsystemd-kexec.service                  static\nsystemd-localed.service                static\nsystemd-logind.service                 static\nsystemd-machined.service               static\nsystemd-modules-load.service           static\nsystemd-nspawn@.service                disabled\nsystemd-poweroff.service               static\nsystemd-quotacheck.service             static\nsystemd-random-seed.service            static\nsystemd-readahead-collect.service      disabled\nsystemd-readahead-done.service         static\nsystemd-readahead-drop.service         disabled\nsystemd-readahead-replay.service       disabled\nsystemd-reboot.service                 static\nsystemd-remount-fs.service             static\nsystemd-shutdownd.service              static\nsystemd-suspend.service                static\nsystemd-sysctl.service                 static\nsystemd-timedated.service              static\nsystemd-tmpfiles-clean.service         static\nsystemd-tmpfiles-setup-dev.service     static\nsystemd-tmpfiles-setup.service         static\nsystemd-udev-settle.service            static\nsystemd-udev-trigger.service           static\nsystemd-udevd.service                  static\nsystemd-update-utmp-runlevel.service   static\nsystemd-update-utmp.service            static\nsystemd-user-sessions.service          static\nthermald.service                       enabled\nudev-finish.service                    static\nudev.service                           static\nudisks.service                         static\nufw.service                            enabled\numountfs.service                       masked\numountnfs.service                      masked\numountroot.service                     masked\nunattended-upgrades.service            enabled\nurandom.service                        static\nuser@.service                          static\nuuidd.service                          static\nwpa_supplicant.service                 disabled\nx11-common.service                     masked\n-.slice                                static\nmachine.slice                          static\nsystem.slice                           static\nuser.slice                             static\nacpid.socket                           enabled\ndbus.socket                            static\nssh.socket                             disabled\nsyslog.socket                          static\nsystemd-initctl.socket                 static\nsystemd-journald.socket                static\nsystemd-shutdownd.socket               static\nsystemd-udevd-control.socket           static\nsystemd-udevd-kernel.socket            static\nuuidd.socket                           enabled\nbasic.target                           static\nbluetooth.target                       static\ncryptsetup-pre.target                  static\ncryptsetup.target                      static\nctrl-alt-del.target                    disabled\ndefault.target                         enabled\nemergency.target                       static\nfinal.target                           static\ngetty.target                           static\ngraphical.target                       static\nhalt.target                            disabled\nhibernate.target                       static\nhybrid-sleep.target                    static\ninitrd-fs.target                       static\ninitrd-root-fs.target                  static\ninitrd-switch-root.target              static\ninitrd.target                          static\nkexec.target                           disabled\nlocal-fs-pre.target                    static\nlocal-fs.target                        static\nmail-transport-agent.target            static\nmulti-user.target                      enabled\nnetwork-online.target                  static\nnetwork.target                         static\nnss-lookup.target                      static\nnss-user-lookup.target                 static\npaths.target                           static\npoweroff.target                        disabled\nprinter.target                         static\nreboot.target                          disabled\nremote-fs-pre.target                   static\nremote-fs.target                       enabled\nrescue.target                          disabled\nrpcbind.target                         static\nrunlevel0.target                       disabled\nrunlevel1.target                       disabled\nrunlevel2.target                       static\nrunlevel3.target                       static\nrunlevel4.target                       static\nrunlevel5.target                       static\nrunlevel6.target                       disabled\nshutdown.target                        static\nsigpwr.target                          static\nsleep.target                           static\nslices.target                          static\nsmartcard.target                       static\nsockets.target                         static\nsound.target                           static\nsuspend.target                         static\nswap.target                            static\nsysinit.target                         static\nsyslog.target                          static\nsystem-update.target                   static\ntime-sync.target                       static\ntimers.target                          static\numount.target                          static\nx-display-manager.target               static\nsystemd-readahead-done.timer           static\nsystemd-tmpfiles-clean.timer           static\n\n213 unit files listed.</pre>\n"},{"id":19320,"title":"How to enable or disable services?","body":"<p>I read about how to enable and disable services in Ubuntu and it seems that there are different possibilities to manage them.</p>\n\n<p>The first method I found is <code>update-rc.d</code> to add new services to startup, which aims on the <code>/etc/init.d</code> folder and its contents.</p>\n\n<p>The other one I found is to edit <code>.conf</code> files in the <code>/etc/init</code> folder.</p>\n\n<p>What's the recommended way to enable / disable / add services and why?</p>\n\n<p>Could you please give a short bulletproof step by step example on how to add a service in Ubuntu and enable and disable it?</p>\n"},{"id":530339,"title":"Given a user, how to control which services to disable after starting a graphical session?","body":"<p>I am not familiar with <code>upstart</code>, yet. When I start KDE with my own account <code>upstart</code> starts a lot of services as far as I understand. But I have some other users that I let them use <code>openbox</code> because I want them to have a minimal system with only one browser. So after they log in, in say <code>tty5</code>, they run:</p>\n\n<pre><code>$ ps aux | grep ^lightUser\nlightUser      7430  0.0  0.0  41092  7432 tty5     S    01:06   0:00 -bash\nlightUser     10038  0.0  0.0  34916  2596 tty5     R+   01:19   0:00 ps aux\nlightUser     10039  0.0  0.0  28216   796 tty5     S+   01:19   0:00 grep --color=auto ^lightUser\n</code></pre>\n\n<p>After they start their graphical session, myriads of services appear:</p>\n\n<pre><code>$ ps aux | ^lightUser\nlightUser    1655  0.0  0.0  41084  7268 tty2     S+   01:04   0:00 -bash\nlightUser    4139  0.0  0.0   4452  1644 tty2     S+   01:04   0:00 /bin/sh /usr/bin/startx\nlightUser    4156  0.0  0.0  16008  2040 tty2     S+   01:04   0:00 xinit /etc/X11/xinit/xinitrc -- /etc/X11/xinit/xserverrc :1 -auth /tmp/serverauth.GhYql1LxgX\nlightUser    4167  0.0  0.0  12972   836 tty2     S    01:04   0:00 /usr/bin/ck-launch-session /usr/bin/dbus-launch --exit-with-session /usr/bin/im-launch /bin/bash /home/lightUser/.Xsession\nlightUser    4227  0.0  0.0  10624   316 ?        Ss   01:04   0:00 /usr/bin/ssh-agent /usr/bin/ck-launch-session /usr/bin/dbus-launch --exit-with-session /usr/bin/im-launch /bin/bash /home/lightUser/.Xsession\nlightUser    4235  0.0  0.0  28892  3028 tty2     S    01:04   0:00 /bin/bash /home/lightUser/.Xsession\nlightUser    4238  0.0  0.0  24448  1892 tty2     S    01:04   0:00 /usr/bin/dbus-launch --exit-with-session /usr/bin/im-launch /bin/bash /home/lightUser/.Xsession\nlightUser    4239  0.0  0.0  39652  2772 ?        Ss   01:04   0:00 //bin/dbus-daemon --fork --print-pid 5 --print-address 7 --session\nlightUser    4250  0.0  0.0 388616  8108 ?        Ssl  01:04   0:00 /usr/bin/ibus-daemon --daemonize --xim\nlightUser    4260  0.1  0.4 218176 53072 tty2     Sl   01:04   0:01 Xephyr -fullscreen -screen 1920x1200 :11\nlightUser    4261  0.0  0.0  76460  9192 tty2     S    01:04   0:00 blackbox\nlightUser    4265  0.0  0.0 208908  5408 ?        Sl   01:04   0:00 /usr/lib/gvfs/gvfsd\nlightUser    4269  0.0  0.0 294900  9236 ?        Sl   01:04   0:00 /usr/lib/gvfs/gvfsd-fuse /run/user/1002/gvfs -f -o big_writes\nlightUser    4272  0.0  0.0 307936  7704 ?        Sl   01:04   0:00 /usr/lib/ibus/ibus-dconf\nlightUser    4275  0.0  0.2 750008 27552 ?        Sl   01:04   0:00 /usr/lib/ibus/ibus-ui-gtk3\nlightUser    4278  0.0  0.1 385120 15464 ?        Sl   01:04   0:00 /usr/lib/ibus/ibus-x11 --kill-daemon\nlightUser    4285  0.0  0.0 367704  9652 ?        Sl   01:04   0:00 /usr/lib/at-spi2-core/at-spi-bus-launcher\nlightUser    4291  0.0  0.0  39256  3360 ?        S    01:04   0:00 /bin/dbus-daemon --config-file=/etc/at-spi2/accessibility.conf --nofork --print-address 3\nlightUser    4294  0.0  0.0 124920  4780 ?        Sl   01:04   0:00 /usr/lib/at-spi2-core/at-spi2-registryd --use-gnome-session\nlightUser    4313  0.0  0.0 232084  7572 ?        Sl   01:04   0:00 /usr/lib/ibus/ibus-engine-simple\nlightUser    4329  0.0  0.1 309028 21044 tty2     Sl   01:04   0:00 /usr/bin/openbox --startup /usr/lib/x86_64-linux-gnu/openbox-autostart OPENBOX\nlightUser    4346  0.1  1.5 1100016 188280 tty2   Sl   01:04   0:01 /usr/lib/firefox/firefox\nlightUser    4351  0.0  0.3 447220 40408 tty2     Sl   01:04   0:00 yakuake\nlightUser    4358  0.0  0.3 525468 40976 tty2     Sl   01:04   0:00 konsole\nlightUser    4359  0.0  0.0 306032  7468 tty2     Sl   01:04   0:00 /usr/lib/x86_64-linux-gnu/indicator-bluetooth/indicator-bluetooth-service\nlightUser    4360  0.0  0.0 308012  7620 tty2     Sl   01:04   0:00 /usr/lib/x86_64-linux-gnu/indicator-power/indicator-power-service\nlightUser    4363  0.0  0.0 479472  8484 tty2     Sl   01:04   0:00 /usr/lib/x86_64-linux-gnu/deja-dup/deja-dup-monitor\nlightUser    4364  0.0  0.1 265876 22480 tty2     Sl   01:04   0:00 /usr/bin/python /usr/share/system-config-printer/applet.py\nlightUser    4366  0.0  0.2 846672 27824 tty2     Sl   01:04   0:00 update-notifier\nlightUser    4369  0.0  0.1 421844 13136 tty2     Sl   01:04   0:00 zeitgeist-datahub\nlightUser    4370  0.0  0.2 1220688 29716 tty2    Sl   01:04   0:00 nm-applet\nlightUser    4375  0.0  0.0  70556  6132 ?        S    01:04   0:00 /usr/lib/x86_64-linux-gnu/gconf/gconfd-2\nlightUser    4390  0.0  0.0 323832 10436 ?        Sl   01:04   0:00 /usr/lib/gvfs/gvfs-udisks2-volume-monitor\nlightUser    4393  0.0  0.0 289924  8368 ?        Sl   01:04   0:00 /usr/bin/zeitgeist-daemon\nlightUser    4396  0.0  0.0 297848  6912 ?        S&lt;l  01:04   0:00 /usr/bin/pulseaudio --start --log-target=syslog\nlightUser    4441  0.0  0.0 298232  8292 ?        Sl   01:04   0:00 /usr/lib/gvfs/gvfs-afc-volume-monitor\nlightUser    4446  0.0  0.0 224844  6264 ?        Sl   01:04   0:00 /usr/lib/gvfs/gvfs-gphoto2-volume-monitor\nlightUser    4451  0.0  0.0 229812  7592 ?        Sl   01:04   0:00 /usr/lib/gvfs/gvfs-mtp-volume-monitor\nlightUser    4459  0.0  0.1 178124 14936 ?        Ss   01:04   0:00 kdeinit4: kdeinit4 Running...\nlightUser    4462  0.0  0.1 217052 18920 ?        S    01:04   0:00 kdeinit4: klauncher [kdeinit] --fd=8\nlightUser    4468  0.0  0.2 303760 28032 ?        S    01:04   0:00 kdeinit4: kded4 [kdeinit]  \nlightUser    4474  0.0  0.0 287240  6804 ?        Sl   01:04   0:00 /usr/lib/libunity-webapps/unity-webapps-service\nlightUser    4488  0.0  0.2 301372 29380 ?        S    01:04   0:00 /usr/bin/kglobalaccel\nlightUser    4490  0.0  0.0  40980  7120 pts/7    Ss+  01:04   0:00 /bin/bash\nlightUser    4509  0.0  0.0  41004  7192 pts/11   Ss+  01:04   0:00 /bin/bash\nlightUser    4516  0.0  0.2 412096 34220 ?        Sl   01:04   0:00 /usr/bin/knotify4\nlightUser    4533  0.0  0.2 762628 25904 ?        Sl   01:04   0:00 /usr/lib/x86_64-linux-gnu/notify-osd\nlightUser    4553  0.0  0.1 407532 18108 ?        Sl   01:04   0:00 /usr/bin/gnome-screensaver --no-daemon\n</code></pre>\n\n<p>(For some reason I want them to run with <code>Xephyr</code>, <code>blackbox</code> and <code>openbox</code>).</p>\n\n<p>How can I prevent all the redundant services useless from starting? I suppose they do not need anything that contains <code>*bus*</code>, <code>notify</code>, <code>screensaver</code>, <code>launcher</code>, <code>zeitgeist</code>, <code>pulseaudio</code>, <code>nm-applet</code>, etc....</p>\n\n<p>Thanks!</p>\n\n<p>PS: The <code>lightUser</code>'s <code>~/.Xsession</code> is:</p>\n\n<pre><code>Xephyr -fullscreen -screen 1920x1200 :11 &amp;\nexec blackbox &amp;\nsleep 4\nDISPLAY=:11 /usr/bin/openbox-session\n</code></pre>\n\n<p>Also:</p>\n\n<pre><code>$ lsb_release -d\nDescription:    Ubuntu 14.04.1 LTS\n</code></pre>\n"},{"id":118495,"title":"Python service using Upstart on Ubuntu","body":"<p>I want to create to deploy a heartbeat service (a python script) as a service using Upstart. </p>\n\n<p>My understanding is that I've to add a <code>/etc/init/myheartbeatservice.conf</code> with the following contents. </p>\n\n<pre><code># my heartbeat service \n\ndescription     \"Heartbeat monitor\"\n\nstart on startup\nstop on shutdown\n\nscript\n    exec /path/to/my/python/script.py\nend script \n</code></pre>\n\n<p>My script starts another service process and the monitors the processes and sends heartbeat to an outside server regularly. Are <code>startup</code> and <code>shutdown</code> the correct events ? \nAlso my script create a new thread. I'm assuming I also need to add <code>fork daemon</code> to my conf file?</p>\n\n<p>Thanks. </p>\n"}]}]