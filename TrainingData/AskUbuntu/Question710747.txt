[{"id":710747,"title":"After Upgrading to 15.10 from 15.04, EC2 Webservers Have Become Very Unstable","body":"<p>I have a variety of Ubuntu machines running in production, with about 30 that were upgraded from 15.04 to 15.10. With most of the machines, the upgrade has been a breeze and everything has functioned perfectly. However, 10 of my webservers have started crashing immediately following the 15.10 upgrade. As far as what exactly defines a \"crash\", instance status checks fail, and I can no longer SSH to the machine. Background daemons running on the system stop responding, and nothing is written to the logs. The most recent log entries I see on one machine show:</p>\n\n<pre><code>/var/log/syslog:Dec 18 00:28:58 xxx-web-4a dhclient: DHCPREQUEST of 10.xxx.xxx.104 on eth0 to 10.xxx.xxx.1 port 67 (xid=0x616a091d)\n/var/log/syslog:Dec 18 00:28:58 xxx-web-4a dhclient: DHCPACK of 10.xxx.xxx.104 from 10.xxx.xxx.1\n/var/log/syslog:Dec 18 00:28:58 xxx-web-4a dhclient: bound to 10.xxx.xxx.104 -- renewal in 1640 seconds.\n</code></pre>\n\n<p>But my Instance Status Checks didn't begin failing until <code>00:32:00</code> (when the first of several checks failed to respond). There is absolutely nothing in the logs during the period following the entries above.</p>\n\n<p>Now, like I said, my ~20 other 15.10 instances have never crashed in the over 3 weeks since their upgrade, only this set of webservers, and they're all crashing. So, what's different about these machines? Only two things, really.</p>\n\n<ol>\n<li>They're my highest-traffic 15.10 instances, sending and receiving about 5-10Mb/sec on average, peaking to a bit over 30-40 on occasion.</li>\n<li>They're my only instances of type <code>c4.xlarge</code> or <code>m4.xlarge</code>. Originally, they were all <code>c4.xlarge</code>, but I replaced them with <code>m4.xlarge</code> to try to isolate the problem. It seems to be less frequent with the <code>m4.xlarge</code>, but I've still seen 3 or 4 or so crashes a day between the 10 webservers. Generally, I'm seeing each instance crash at least once a day, at seemingly random times.</li>\n</ol>\n\n<p>These instances are running Apache 2.4.x, mod_php 5.6.11, and memcached 1.4.24, but I have other machines receiving less traffic on a smaller instance type that are perfectly stable.</p>\n\n<p>Not sure if related, but all of these machines are seeing periodic <code>ifquery</code> segfaults, for example:</p>\n\n<pre><code>/var/log/syslog:Dec 17 14:02:05 xxx-web-3a kernel: [   22.592488] ifquery[476]: segfault at 1 ip 0000000000403187 sp 00007ffde8596050 error 4 in ifup[400000+d000]\n/var/log/syslog:Dec 17 14:02:05 xxx-web-3a kernel: [   23.593774] ifquery[510]: segfault at 1 ip 0000000000403187 sp 00007ffde6087b90 error 4 in ifup[400000+d000]\n/var/log/syslog:Dec 17 14:02:05 xxx-web-3a kernel: [   24.594994] ifquery[531]: segfault at 1 ip 0000000000403187 sp 00007ffe70747a50 error 4 in ifup[400000+d000]\n/var/log/syslog:Dec 17 14:04:12 xxx-web-3a kernel: [    2.623024] ifquery[367]: segfault at 1 ip 0000000000403187 sp 00007ffefc980f60 error 4 in ifup[400000+d000]\n</code></pre>\n\n<p>One system, prior to the <code>c4.xlarge</code> --> <code>m4.xlarge</code> migration, saw a <code>General Protection Fault</code> logged a single time in the system console log, but I have not seen this again.</p>\n\n<p>I'm not seeing these segfaults on my other 15.10 machines which are not crashing.</p>\n\n<p>Is anyone seeing similar problems, or have any ideas for debugging this? Thanks!</p>\n","related_questions":[{"id":697693,"title":"Audio is not working after upgrade to ubuntu 15.10 from 15.04","body":"<p>I have been using Ubuntu 15.04 for almost a month now, the audio used to work fine. Until the 15.10 update. Sometimes there was a startup sound, but after the login there is no sound icon in the menu bar. Tried playing a video with <code>vlc</code> gives error:</p>\n\n<pre><code> Audio output failed:\nThe audio device \"default\" could not be used:\nNo such file or directory.\n</code></pre>\n"},{"id":697542,"title":"After upgrade from 15.04 to 15.10, login takes very long","body":"<p>After upgrade from Ubuntu 15.04 to 15.10 I noticed, that when I turn on my laptop, it takes few seconds to boot and show the login screen, but the problem appears when I enter my password to login field and press \"Enter\": the screen shows my desktop image with note \"Ubuntu 15.10\" in left bottom corner (also I can see my mouse), and it takes about 3-4 minutes until menu bar appears. I know that I login to session immediately, because I can hear skype login sound, it also loads all the startup programs, but I don't understand why it takes so long to show up menu bar.</p>\n\n<p>Does any one have this problem, and may be knows how to solve it?</p>\n\n<p>P.S. my laptop is HP Pavilion dv6-6b04st.</p>\n"},{"id":696123,"title":"Upgrade from 15.04 to 15.10 crash","body":"<p>So last night I decided to upgrade my primary workstation from 15.04 to 15.10 via software updater and it just stopped with some errors about desktop wallpapers.</p>\n\n<p>After about 30 minutes I just switched the PC off and went to sleep.</p>\n\n<p><a href=\"http://i.stack.imgur.com/ktEx0.jpg\" rel=\"nofollow\"><img src=\"http://i.stack.imgur.com/ktEx0.jpg\" alt=\"Upgrade\"></a></p>\n"},{"id":691099,"title":"Upgrade from 15.04 to 15.10","body":"<p>Upgraded from 15.04 to 15.10 but on reboot my video is not coming up. I am using a AMD Radeon HD 8200/R3 series.</p>\n"},{"id":693532,"title":"Problem with packages after upgrading to ubuntu 15.10 from 15.04","body":"<p>I upgraded to ubuntu 15.10 from 15.04 this morning and now I can't install any packages or anything. Indeed when I run a sudo apt-get install I get :</p>\n\n<pre><code>Reading package lists... Done\nBuilding dependency tree       \nReading state information... Done\nThe following packages were automatically installed and are no longer required:\n  libtomcat7-java tomcat7-common\nUse 'apt-get autoremove' to remove them.\nThe following extra packages will be installed:\n  emacs24\nThe following packages will be upgraded:\n  emacs24\n1 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.\n10 not fully installed or removed.\nNeed to get 0 B/3 417 kB of archives.\nAfter this operation, 88,1 kB of additional disk space will be used.\nDo you want to continue? [Y/n] y\n(Reading database ... 505037 files and directories currently installed.)\nPreparing to unpack .../emacs24_24.5+1-1ubuntu2_amd64.deb ...\ndpkg-query: package 'latex-cjk-thai.dpkg-tmp' is not installed and no information is available\nUse dpkg --info (= dpkg-deb --info) to examine archive files,\nand dpkg --contents (= dpkg-deb --contents) to list their contents.\nemacsen-common: dpkg invocation failed at /usr/lib/emacsen-common/lib.pl line 80.\ndpkg: warning: subprocess old pre-removal script returned error exit status 1\ndpkg: trying script from the new package instead ...\ndpkg-query: package 'latex-cjk-thai.dpkg-tmp' is not installed and no information is available\nUse dpkg --info (= dpkg-deb --info) to examine archive files,\nand dpkg --contents (= dpkg-deb --contents) to list their contents.\nemacsen-common: dpkg invocation failed at /usr/lib/emacsen-common/lib.pl line 80.\ndpkg: error processing archive /var/cache/apt/archives/emacs24_24.5+1-1ubuntu2_amd64.deb (--unpack):\n subprocess new pre-removal script returned error exit status 1\nupdate-alternatives: using /usr/bin/emacs24-x to provide /usr/bin/emacs (emacs) in auto mode\ndpkg-query: package 'latex-cjk-thai.dpkg-tmp' is not installed and no information is available\nUse dpkg --info (= dpkg-deb --info) to examine archive files,\nand dpkg --contents (= dpkg-deb --contents) to list their contents.\nemacsen-common: dpkg invocation failed at /usr/lib/emacsen-common/lib.pl line 80.\ndpkg: error while cleaning up:\n subprocess installed post-installation script returned error exit status 1\nErrors were encountered while processing:\n /var/cache/apt/archives/emacs24_24.5+1-1ubuntu2_amd64.deb\nE: Sub-process /usr/bin/dpkg returned an error code (1)\n</code></pre>\n\n<p>I already look on the internet and found mostly what was said on this page :\n<a href=\"http://www.billmal.com/billmal/billmal.nsf/dx/ubuntu-catalog-fix.htm?opendocument&amp;comments\" rel=\"nofollow\">http://www.billmal.com/billmal/billmal.nsf/dx/ubuntu-catalog-fix.htm?opendocument&amp;comments</a>.\nbut it's stuck with same errors. \nI wonder if emacs is the problem (???).</p>\n\n<p>I hope someone can help me, thank's.</p>\n"},{"id":693208,"title":"Icon theme is selectively applied after upgrade from kubuntu 15.04 to 15.10","body":"<p>This is easiest to see with the following screen shot.<br>\n<a href=\"http://i.stack.imgur.com/Hk3Oj.png\" rel=\"nofollow\"><img src=\"http://i.stack.imgur.com/Hk3Oj.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see there are clearly two different icon sets being used.  I have breeze set as my icon theme, but dolphin is using oxygen, not the breeze theme. If I hold my mouse pointer over a file or folder, however, the larger icon to the right uses the correct theme.  How do I correct this?</p>\n"},{"id":690354,"title":"No WiFi after upgrade from 15.04 to 15.10","body":"<p>i had xubuntu 15.04 and needed to install a additional driver to make the wifi connection work. Now after upgrading to 15.10 the wifi isnt working anymore.. </p>\n"},{"id":690095,"title":"Ubuntu won&#39;t boot after upgrade from 15.04 to 15.10","body":"<p>After upgrading my ubuntu server 15.04 to 15.10, it won't boot anymore. After starting the machine, it enters the BIOS. Selecting the linux drive to boot in UEFI mode just returns me back to the BIOS main menu instantly. Selecting it to boot in non-UEFI mode nets me a black screen with blinking curser.</p>\n\n<p>Boot Repair tells me that grub (and everything else it might be checking) is in order.</p>\n\n<p>The Ubuntu system is installed as UEFI and is the only OS present on this machine. The exact same thing happened on the previous release upgrade, at which point I just reinstalled Ubuntu get get stuff going again. Seeing as this might be a recurrent problem on my machine, I would be happy about any pointers as to where I could look for the source of the problem.</p>\n\n<p>I am running this on an ASUS Motherboard, AMD CPU, Ubuntu Partition on a USB3 external HDD.</p>\n\n<p>Big thanks in advance to any and all that might be able to shed some light on this.</p>\n"},{"id":689594,"title":"I can&#39;t recover the upgrade from 15.04 to 15.10","body":"<p>When Ubuntu 15.10 upgrade pop-in, I did download it, but a internet connection failure happen so I did not finish downloadig it. i don't know how to continue it or recover it. (sorry bad grammar)</p>\n"},{"id":688959,"title":"upgrade from 15.04 to 15.10 getting compiz segfault","body":"<p>After upgrade from ubuntu 15.04 to 15.10 getting massive screen flicker - system is unusable.  Using the console (ctrl-alt-F1) I noticed dmesg says compiz is abending</p>\n\n<pre><code>[  150.423110] compiz[2676]: segfault at 1001a ip 00007f142039e135 sp 00007ffc5bfc8fd0 error 4 in libc-2.21.so[7f142031f000+1c0000]\n[  153.569558] compiz[2714]: segfault at ffffffffffd98b80 ip 00007f4462f8e1e1 sp 00007ffd9e82e300 error 5 in libc-2.21.so[7f4462f0f000+1c0000]\n[  155.287526] compiz[2762]: segfault at 1001a ip 00007f4f0cb68135 sp 00007ffc6a1531e0 error 4 in libc-2.21.so[7f4f0cae9000+1c0000]\n[  156.770911] compiz[2807]: segfault at ffffffffffcfa170 ip 00007f6675a981e1 sp 00007fffc53c4d80 error 5 in libc-2.21.so[7f6675a19000+1c0000]\n[  158.249853] compiz[2846]: segfault at ffffffffffd33940 ip 00007f1f513441e1 sp 00007fff98ae6e70 error 5 in libc-2.21.so[7f1f512c5000+1c0000]\n</code></pre>\n\n<p>Should I try doing :</p>\n\n<pre><code>sudo unity --reset\n</code></pre>\n\n<p>am using :   AMD graphics card</p>\n"}]}]