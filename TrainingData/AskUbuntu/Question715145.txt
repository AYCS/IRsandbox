[{"id":715145,"title":"Milter-greylist socket always owned by root?","body":"<p>For some reason, the socket used by <code>milter-greylist</code> is always owned by root, whilst it should be owned by the user <code>milter-greylist</code> runs at. This is all installed from the repos, under Ubuntu Server 14.04. I have configured the user to <code>greylist</code> and confirmed that the daemon runs as such. What am I missing?</p>\n\n<p><strong>Edit:</strong> The PID file gets the correct user, just not the socket.</p>\n\n<p>My <code>/etc/default/milter-greylist</code></p>\n\n<pre><code># Defaults for milter-greylist initscript\n# sourced by /etc/init.d/milter-greylist\n# installed at /etc/default/milter-greylist by the maintainer scripts\n# 2006-08-18 Herbert Straub\n\n# Change to one to enable milter-greylist\n# Don't forget to edit the configuration file \n# /etc/milter-greylist/greylist.conf\nENABLED=1\n\nPIDFILE=\"/var/run/milter-greylist.pid\"\nSOCKET=\"/var/spool/postfix/var/run/milter-greylist/greylist.sock\"\nUSER=\"greylist\"\n\n# Other options\n# OPTIONS=\"\"\n</code></pre>\n\n<p>The start of my <code>/etc/milter-greylist/</code> (the rest is unmodified)</p>\n\n<pre><code>#\n# Simple greylisting config file using the new features\n# See greylist2.conf for a more detailed list of available options\n#\n# $Id: greylist.conf,v 1.48 2010/04/15 07:51:29 manu Exp $\n#\n\npidfile \"/var/run/milter-greylist.pid\"\ndumpfile \"/var/lib/milter-greylist/greylist.db\" 600\ndumpfreq 10m\n\n# For sendmail use the following two lines\n# socket \"/var/run/milter-greylist/milter-greylist.sock\"\n# user \"smmsp\"\n\n# For Postfix uncomment the following two lines and comment out the\n# sendmail ones above.\nsocket \"/var/spool/postfix/var/run/milter-greylist/milter-greylist.sock\" 660\nuser \"greylist\"\n\n# Log milter-greylist activity to a file\n#stat \"&gt;&gt;/var/milter-greylist/greylist.log\" \\\n#      \"%T{%Y/%m/%d %T} %d [%i] %r -&gt; %f %S (ACL %A) %Xc %Xe %Xm %Xh\\n\"\n# Same, sent to syslog\n#stat \"|logger -p local7.info\" \\\n#      \"%T{%Y/%m/%d %T} %d [%i] %r -&gt; %f %S (ACL %A) %Xc %Xe %Xm %Xh\"\n\n# Be verbose (or use -v flag)\n#verbose\n\n# Do not tell spammer how long they have to wait\nquiet\n\n# MX peering\n#peer 192.0.2.17\n#peer 192.0.2.18\n\n# Your own network, which should not suffer greylisting\nlist \"my network\" addr { 127.0.0.1/8 10.0.0.0/8 192.0.2.0/24 }\n</code></pre>\n","related_questions":[{"id":702567,"title":"postfix sends my email through gmail but system mgs to root go to root@gmail.com","body":"<p>I have successfully configured postfix on my ubuntu 14.04 to use gmail as a relay host.  So all email work set fom the system is relayed and works.</p>\n\n<p>BUT - when the system sends me an internal email message it is supposed to use /etc/mailname which I have set to gmail.com\nI have also created aliases which has\nroot:    zzzzz@abc.com</p>\n\n<p>so mail should go to zzzzz@abc.com but it goes to root@gmail.com???</p>\n\n<p>the file mailname has: \ngmail.com</p>\n\n<p>I am guessing that root is not being aliased and it is being appended to mailname</p>\n\n<p>What should I being dong here....</p>\n\n<p>Stuck for months :-(\nThanks</p>\n"},{"id":696051,"title":"Trying to connect to MySQL and Flask cannot connect to socket","body":"<p>I have looked through all of the information out there and still can get this to work. I am running the LAMP server version (not client) and I am trying to connect MySQL and Flask using Ubuntu 14.04. When I try to run my server using <code>python server.py</code> I get the following error...</p>\n\n<pre><code>mysql.connector.errors.InterfaceError: 2002: Can't connect to local MySQL server through socket '/var/lib/mysql/mysql.sock' (13 Permission denied)\n</code></pre>\n\n<p>This is my code...</p>\n\n<pre><code>\"\"\" Import Oracle's python connector for MySQL \"\"\"\nimport mysql.connector\nimport collections\ndef _convert(data):\n    if isinstance(data, basestring):\n        return str(data)\n    elif isinstance(data, collections.Mapping):\n        return dict(map(_convert, data.iteritems()))\n    elif isinstance(data, collections.Iterable):\n        return type(data)(map(_convert, data))\n    else:\n        return data\n# Create a class that will give us an object that we can use to connect to a database\nclass MySQLConnection(object):\n    # init method with configurations.\n    def __init__(self, db):\n        \"\"\" BEGIN DATABASE CONFIGURATIONS \"\"\"\n        self.config = {\n            'user': 'root',\n            'password': 'X0.v7RJ#!', # Change this for windows users\n            'database': db,\n            'host': 'localhost',\n            # comment out the line below for windows\n            'unix_socket': '/var/lib/mysql/mysql.sock',\n        }\n        self.conn = mysql.connector.connect(**self.config)\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"},{"id":684155,"title":"Postfix doesnt know own hostname","body":"<p>in my postfix logs I often see that postfix failed to send an email to root@levinus [my hostname] because theres no DNS record for levinus. But in my /etc/hosts is an entry for levinus (--> 127.0.0.1 AND my static IP). With ping I can reach levinus, then I ping myself. But why postfix doesnt accepts the /etc/hosts entrys?</p>\n\n<p>Piece of the postfix log:</p>\n\n<pre><code>BC59A2FE000B: to=&lt;root@levinus&gt;, relay=none, delay=0.03,    \ndelays=0.01/0/0.02/0, dsn=5.4.4, status=bounced (Host or domain name not   \nfound. Name service error for name=levinus type=AAAA: Host not found)\nOct 11 14:47:29 levinus postfix/qmgr[29217]: BC59A2FE000B: removed\n</code></pre>\n\n<p>Part of /etc/hosts:</p>\n\n<pre><code>[STATIC IP] levinus\n127.0.0.1 localhost.localdomain localhost levinus\n</code></pre>\n\n<p>System is Ubuntu 14.04 LTS.</p>\n\n<p>//Edit\nWith inet_protocols = ipv4 in main.cfg from postfix the same. Only the error message is another (type = A).\nWhen I add levinus to the IPv6 entry ::1 in /etc/hosts its the same (type = AAAA)</p>\n\n<p>//Edit2\npostfix logs even with the <code>levinus</code> hostname:</p>\n\n<pre><code>Oct 12 14:40:33 levinus postfix/smtpd[10103]: connect from levinus[127.0.0.1]\nOct 12 14:40:33 levinus postfix/smtpd[10103]: disconnect from levinus[127.0.0.1]\n</code></pre>\n\n<p>But all mails too root@levinus are still bounced.</p>\n\n<p>Even when I edit the /etc/nsswitch.conf to <code>hosts: files</code> only postfix dont knew the own hostname. Before it was set to <code>hosts: files dns</code>.</p>\n"},{"id":681656,"title":"Ubuntu 14.04 posfix send mail mydesirename@mydomail.com instead of root@mycomputernname.mydomain","body":"<p>I built Ubuntu server 14.04 that should send mail alerts only remote smtp on some conditions.</p>\n\n<p>i have installed posfix etc i have tested the mail but allways getting mails from</p>\n\n<pre><code>root@mycomputernname.mydomain \n</code></pre>\n\n<p>i tried several changes i searched trough the web<br>\nthe  first was \nadd to my /etc/aliases</p>\n\n<pre><code>  # See man 5 aliases for format\npostmaster:    root\nroot:          srvmon@mydomain.com\n</code></pre>\n\n<p>run in  terminal </p>\n\n<pre><code>newaliases\n</code></pre>\n\n<p>and restart postfix service\nsecond is to add my /etc/postfix/main.cf</p>\n\n<pre><code>smtp_generic_maps = hash:/etc/postfix/generic\n</code></pre>\n\n<p>Under add following /etc/postfix/generic</p>\n\n<pre><code>root srvmon@mydomain.com\n</code></pre>\n\n<p>run under terminal following </p>\n\n<pre><code>postmap /etc/postfix/generic\n</code></pre>\n\n<p>all that and i still getting same mail how can i change it to run as different from root@mycomputernname.mydomain to mydesirename@mydomain.com\nbelow i have attached my main.cnf\nPlease advice \nThanks </p>\n\n<pre><code>smtpd_banner = $myhostname ESMTP $mail_name \nbiff = no\nappend_dot_mydomain = no\nreadme_directory = no\nmailbox_size_limit = 0\nrecipient_delimiter = +\ninet_interfaces = loopback-only\ndisable_vrfy_command=yes\n\nsmtpd_tls_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem\nsmtpd_tls_key_file=/etc/ssl/private/ssl-cert-snakeoil.key\nsmtpd_use_tls=yes\nsmtpd_tls_session_cache_database = btree:${data_directory}/smtpd_scache\nsmtp_tls_session_cache_database = btree:${data_directory}/smtp_scache\nsmtp_tls_note_starttls_offer = yes\ntls_random_source = dev:/dev/urandom\nsmtp_use_tls=yes\n\nmyhostname = mydomain.com\n\nmyorigin = $myhostname\nalias_maps = hash:/etc/aliases\nalias_database = hash:/etc/aliases\nmydestination = localhost\nmynetworks = 127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128\nrelayhost = 1xx.xx.xx.xxx:25\nsmtp_generic_maps = hash:/etc/postfix/generic\n</code></pre>\n"},{"id":567977,"title":"Spam-Mail always in inbox and not in &quot;.Spam&quot;-directory (Postfix+Dovecot+SpamAssasian+ClamAV)","body":"<p>As the title already says I receive Spam mails always in my mail inbox and not redirected to the Postfix Spam directory \".Spam\" for each mail user. Any ideas why? (Ubuntu 14.04.1 with Postfix+Dovecot+SpamAssasian+ClamAV)</p>\n\n<p>My configuration is as follows:</p>\n\n<p>/etc/amavis/conf.d/20-debian_defaults</p>\n\n<pre><code>$QUARANTINEDIR = \"$MYHOME/virusmails\";\n</code></pre>\n\n<p>/etc/amavis/conf.d/20-debian_defaults</p>\n\n<pre><code>@whitelist_sender_acl = qw( .$mydomain );\n$final_virus_destiny      = D_DISCARD; # (defaults to D_BOUNCE)\n$final_banned_destiny     = D_DISCARD;  # (defaults to D_BOUNCE)\n$final_spam_destiny       = D_PASS;  # D_DISCARD (defaults to D_REJECT)\n$final_bad_header_destiny = D_PASS;  # (defaults to D_PASS), D_BOUNCE suggested\n</code></pre>\n\n<p>/var/log/mail.log</p>\n\n<pre><code>    Jan  2 01:11:47 h2376680 dovecot: imap-login: Login: user=&lt;user1@example.com&gt;, method=PLAIN, rip=::1, lip=::1, mpid=29949, TLS, session=&lt;LwXFL6ALuQAAAAAAAAAAAAAAAAAAAAAB&gt;\nJan  2 01:11:47 h2376680 dovecot: imap(user1@example.com): Disconnected: Logged out in=59 out=477\nJan  2 01:11:50 h2376680 postfix/smtpd[29951]: connect from localhost[127.0.0.1]\nJan  2 01:11:50 h2376680 postfix/smtpd[29951]: 78A6D36502180: client=localhost[127.0.0.1]\nJan  2 01:11:50 h2376680 postfix/cleanup[29943]: 78A6D36502180: message-id=&lt;aabe57b2c0c035eb78bc63cebfb7d5ba@webmail.example.com&gt;\nJan  2 01:11:50 h2376680 postfix/qmgr[26016]: 78A6D36502180: from=&lt;user1@example.com&gt;, size=2115, nrcpt=1 (queue active)\n\nJan  2 01:11:50 h2376680 amavis[29933]: (29933-01) Passed SPAM {RelayedTaggedInternal,Quarantined}, LOCAL [::1]:54297 [::1] &lt;user1@example.com&gt; -&gt; &lt;user1@example.com&gt;, quarantine: Z/spam-ZbwHIOZCG3mB.gz, Queue-ID: 2CFFD36501BFF, Message-ID: &lt;aabe57b2c0c035eb78bc63cebfb7d5ba@webmail.example.com&gt;, mail_id: ZbwHIOZCG3mB, Hits: 999.002, size: 1265, queued_as: 78A6D36502180, 3183 ms\n\nJan  2 01:11:50 h2376680 postfix/smtp[29945]: 2CFFD36501BFF: to=&lt;user1@example.com&gt;, relay=127.0.0.1[127.0.0.1]:10024, delay=3.3, delays=0.06/0.1/0.01/3.2, dsn=2.0.0, status=sent (250 2.0.0 from MTA(smtp:[127.0.0.1]:10025): 250 2.0.0 Ok: queued as 78A6D36502180)\nJan  2 01:11:50 h2376680 postfix/qmgr[26016]: 2CFFD36501BFF: removed\nJan  2 01:11:50 h2376680 dovecot: lmtp(29953): Connect from local\nJan  2 01:11:50 h2376680 dovecot: lmtp(29953, user1@example.com): rfsRIEbipVQBdQAA6SEkQA: msgid=&lt;aabe57b2c0c035eb78bc63cebfb7d5ba@webmail.example.com&gt;: saved mail to INBOX\nJan  2 01:11:50 h2376680 postfix/lmtp[29952]: 78A6D36502180: to=&lt;user1@example.com&gt;, relay=example.com[private/dovecot-lmtp], delay=0.07, delays=0.01/0.02/0.01/0.03, dsn=2.0.0, status=sent (250 2.0.0 &lt;user1@example.com&gt; rfsRIEbipVQBdQAA6SEkQA Saved)\nJan  2 01:11:50 h2376680 dovecot: lmtp(29953): Disconnect from local: Successful quit\nJan  2 01:11:50 h2376680 postfix/qmgr[26016]: 78A6D36502180: removed\n</code></pre>\n"},{"id":549554,"title":"Dovecot delivery issue","body":"<p>I'm using fictional email address username@domainname.com for this case. testuser is a local account on my ubuntu Server 14.04.</p>\n\n<p>I have a fully functional email server set up using postfix and dovecot by following the guide at <a href=\"http://arstechnica.com/information-technology/2014/02/how-to-run-your-own-e-mail-server-with-your-own-domain-part-1/\" rel=\"nofollow\">http://arstechnica.com/information-technology/2014/02/how-to-run-your-own-e-mail-server-with-your-own-domain-part-1/</a></p>\n\n<p>I do however have a problem with certain locally sent messages. Most work (generated from user crontab i.e.), but the following won't. They will hang around in the queue and never get sent because of the following error:</p>\n\n<p>Nov 14 10:32:36 mail dovecot: lda(testuser): Error: user testuser: Initialization failed: Namespace '': mkdir(/var/mail/vmail//testuser/mail) failed: Permission denied (euid=1000(testuser) egid=1000(testuser) missing +w perm: /var/mail/vmail/, dir owned by 5000:5000 mode=0755)</p>\n\n<p>This includes test messages sent with sendmail -bv test@domain.com</p>\n\n<p>The queue looks like this:</p>\n\n<p>79B4A812E1     2023 Fri Nov 14 10:17:46  MAILER-DAEMON\n                                                           (temporary failure)\n                                         testuser@domainname.com</p>\n\n<p>I have a folder structure of /var/mail/vmail/domainname.com/username/mail/</p>\n\n<p>So dovecot doesn't use the domainname.com folder and also not the username folder. I've found a possible solution online using the setting 'mail_location' in /etc/dovecot/conf.d/10-mail.conf, but i'm worried that this isn't a neat solution, since other local processes DO send mail to the correct address. This is also from userid 1000 (testuser)</p>\n\n<p>When reading one of the messages in the queue with postqueue -q  it does send the mail to a valid To: address. However, it tries to send it from userid 1000, maybe it should be trying to relay it to user vmail (uid gid 5000)?</p>\n\n<p>This is the output of postconf -n</p>\n\n<p>[testuser@domainname]:~$ postconf -n\nalias_database = hash:/etc/aliases\nalias_maps = hash:/etc/aliases\nappend_dot_mydomain = no\nbiff = no\nbroken_sasl_auth_clients = yes\ncanonical_maps = hash:/etc/postfix/canonical\nconfig_directory = /etc/postfix\ndefault_destination_concurrency_limit = 5\ndisable_vrfy_command = yes\ndovecot_destination_recipient_limit = 1\nhome_mailbox = Maildir/\ninet_interfaces = all\nmailbox_command = /usr/lib/dovecot/deliver -c /etc/dovecot/dovecot.conf -m \"${EXTENSION}\"\nmailbox_size_limit = 0\nmessage_size_limit = 104857600\nmilter_connect_macros = j {daemon_name} v {if_name} _\nmilter_default_action = accept\nmilter_protocol = 2\nmydestination = localhost, localhost.localdomain, domainname.com\nmyhostname = domainname.com\nmynetworks = 127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128\nmyorigin = /etc/mailname\nnon_smtpd_milters = $smtpd_milters\npostscreen_access_list = permit_mynetworks\npostscreen_dnsbl_action = enforce\npostscreen_dnsbl_sites = zen.spamhaus.org, b.barracudacentral.org, bl.spamcop.net\npostscreen_greet_action = enforce\nreadme_directory = no\nrecipient_delimiter = +\nrelay_destination_concurrency_limit = 1\nrelayhost =\nsmtp_tls_note_starttls_offer = yes\nsmtp_tls_security_level = may\nsmtp_tls_session_cache_database = btree:${data_directory}/smtp_scache\nsmtp_use_tls = yes\nsmtpd_banner = $myhostname ESMTP\nsmtpd_helo_required = yes\nsmtpd_helo_restrictions = permit_sasl_authenticated, permit_mynetworks, reject_non_fqdn_helo_hostname, reject_invalid_helo_hostname, reject_unknown_helo_hostname, permit\nsmtpd_milters = unix:/spamass/spamass.sock unix:/clamav/clamav-milter.ctl unix:/opendkim/opendkim.sock\nsmtpd_recipient_restrictions = permit_sasl_authenticated, permit_mynetworks, reject_unknown_client_hostname, reject_unknown_sender_domain, reject_unknown_recipient_domain, reject_unauth_pipelining, reject_unauth_destination, reject_invalid_hostname, reject_non_fqdn_sender\nsmtpd_relay_restrictions = permit_mynetworks permit_sasl_authenticated defer_unauth_destination\nsmtpd_sasl_auth_enable = yes\nsmtpd_sasl_authenticated_header = yes\nsmtpd_sasl_local_domain = $myhostname\nsmtpd_sasl_path = private/dovecot-auth\nsmtpd_sasl_security_options = noanonymous\nsmtpd_sasl_type = dovecot\nsmtpd_sender_login_maps = $virtual_mailbox_maps\nsmtpd_sender_restrictions = reject_unknown_sender_domain, reject_sender_login_mismatch\nsmtpd_tls_CAfile = /etc/ssl/certs/ca-certificates.crt\nsmtpd_tls_ask_ccert = yes\nsmtpd_tls_auth_only = yes\nsmtpd_tls_cert_file = /etc/ssl/private/ssl-chain-mail-domainname.com.pem\nsmtpd_tls_ciphers = high\nsmtpd_tls_key_file = /etc/ssl/private/ssl-key-decrypted-mail-domainname.com.key\nsmtpd_tls_loglevel = 1\nsmtpd_tls_mandatory_ciphers = medium\nsmtpd_tls_mandatory_protocols = SSLv3, TLSv1\nsmtpd_tls_received_header = yes\nsmtpd_tls_security_level = may\nsmtpd_tls_session_cache_database = btree:${data_directory}/smtpd_scache\nsmtpd_tls_session_cache_timeout = 3600s\nsmtpd_use_tls = yes\ntls_random_source = dev:/dev/urandom\nvirtual_alias_maps = hash:/etc/postfix/virtual\nvirtual_mailbox_domains = hash:/etc/postfix/virtual-mailbox-domains\nvirtual_mailbox_maps = hash:/etc/postfix/virtual-mailbox-users\nvirtual_transport = dovecot</p>\n"},{"id":464371,"title":"Postfix unable to pass messages to amavis ( Can&#39;t connect to INET4 socket 127.0.0.1)","body":"<p>I have been trying to get postfix to work with amavis but have been unable.  No matter what I have tried I can't get past the following error:  <code>[snip] Can't connect to INET4 socket 127.0.0.1</code></p>\n\n<p>I can successfully run telnet 127.0.0.1 10024 and amavis answers.</p>\n\n<p>Nothing else in the logs to indicate a problem.</p>\n\n<p>Does anyone know how I can further troubleshoot this?</p>\n\n<p><code>postconf -n</code> follows:</p>\n\n<pre><code>alias_database = hash:/etc/aliases\nalias_maps = hash:/etc/aliases\nappend_dot_mydomain = no\nbiff = no\nbroken_sasl_auth_clients = yes\nconfig_directory = /etc/postfix\nhome_mailbox = Maildir/\ninet_interfaces = all\ninet_protocols = all\nmailbox_command =\nmailbox_size_limit = 0\nmydestination = thegodshalls.com, localhost.com, , localhost\nmyhostname = thegodshalls.com\nmynetworks = 127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128\nmyorigin = /etc/mailname\nreadme_directory = no\nrecipient_delimiter = +\nrelayhost =\nsmtp_tls_note_starttls_offer = yes\nsmtp_tls_security_level = may\nsmtp_tls_session_cache_database = btree:${data_directory}/smtp_scache\nsmtpd_banner = $myhostname ESMTP $mail_name (Ubuntu)\nsmtpd_recipient_restrictions =       permit_sasl_authenticated,permit_mynetworks,reject_unauth_destination\nsmtpd_sasl_auth_enable = yes\nsmtpd_sasl_local_domain =\nsmtpd_sasl_security_options = noanonymous\nsmtpd_tls_CAfile = /etc/ssl/certs/cacert.pem\nsmtpd_tls_auth_only = no\nsmtpd_tls_cert_file = /etc/ssl/certs/smtpd.crt\nsmtpd_tls_key_file = /etc/ssl/private/smtpd.key\nsmtpd_tls_loglevel = 1\nsmtpd_tls_received_header = yes\nsmtpd_tls_security_level = may\nsmtpd_tls_session_cache_database = btree:${data_directory}/smtpd_scache\nsmtpd_tls_session_cache_timeout = 3600s\nsmtpd_use_tls = yes\ntls_random_source = dev:/dev/urandom\n</code></pre>\n"},{"id":298670,"title":"Why is rc.local in /etc, should it be owned by root, and when is it run?","body":"<p>My understanding of <code>rc.local</code>, based on a quick Google search, is that I can put some bash in it which will be run at the beginning of [something] (what, user login, system start up?).</p>\n\n<p>The <code>rc.local</code> in my Ubuntu 12.04.2 server is owned by my user, <code>orokusaki</code>, vs being owned by <code>root</code>. Because it's in <code>/etc</code>, I'm guessing it's more of a global thing vs a user-specific thing. Is this true? If so, why did Ubuntu create it with my <code>orokusaki</code> user, but then put it in <code>etc</code>? Should I <code>chown root:root /etc/rc.local</code> to fix it, or should I move it into my home directory?</p>\n"},{"id":264035,"title":"Ubuntu Server 12.04 - Create a non-Root user with own Userdir","body":"<p>I've created a new non-root user, <code>dev</code>, that so far does not belong to any groups, and I've been following <a href=\"http://kimbriggs.com/computers/computer-notes/linux-notes/apache2-public_html-virtual-directories.file\" rel=\"nofollow\">this guide</a> to help me setup Apache for hosting sites under this user's <strong>public_html</strong> directory (this is a development machine). As this new user does not belong to the <code>sudoers</code> group, I'm now having the obvious problem of trying to create the following symbolic links when logged in as the new user (under Step2 in the linked article):</p>\n\n<pre><code>sudo ln -s ../mods-available/userdir.conf userdir.conf\nsudo ln -s ../mods-available/userdir.load userdir.load\n</code></pre>\n\n<p>Also, if I browse to <code>http://192.168.1.100/dev</code> I get a 404 not found response, when I should at least be seeing some sort of file/folder structure (assuming I did everything correctly).</p>\n\n<p>What workaround is there to this? Better yet, what is the correct method of setting up the <code>public_html</code> folder for a non-root user. I'm doing this in an effort to learn as well as ensure that a non-root user is being used to create any sites....am I being too paranoid about getting the security right?</p>\n\n<p>Many thanks</p>\n"},{"id":79226,"title":"Can&#39;t connect to local MySQL server through socket &#39;/var/run/mysqld/mysqld.sock&#39; (2)","body":"<p>I have mailserver configure using <a href=\"http://workaround.org/ispmail/lenny\">dovecot+postfix+mysql</a> and it was runnig fine in the server(Ubuntu Server). But during last week it stopped working correctly. It doesn't send email. When I try to <code>telnet localhost smtp</code> I'm connecting successfully but when I do <code>mail from:&lt;steve@example.com&gt;</code> and hit Enter it hangs on, nothing happen. </p>\n\n<p>Having reviewed <code>/var/log/mail.log</code> file I've found out that probably(99%) the problem is on postfix when it is trying to connect to MySQL server. If you see the log file given below you can see that it says <code>Can't connect to local MySQL server through socket '/var/run/mysqld/mysqld.sock' (2)</code>. </p>\n\n<pre><code>Nov 14 21:54:36 ns1 dovecot: dovecot: Killed with signal 15 (by pid=7731 uid=0 code=kill)\nNov 14 21:54:36 ns1 dovecot: Dovecot v1.2.9 starting up (core dumps disabled)\nNov 14 21:54:36 ns1 dovecot: auth-worker(default): mysql: Connected to localhost (mailserver)\nNov 14 21:54:44 ns1 postfix/postfix-script[7753]: refreshing the Postfix mail system\nNov 14 21:54:44 ns1 postfix/master[1670]: reload -- version 2.7.0, configuration /etc/postfix\nNov 14 21:54:52 ns1 postfix/trivial-rewrite[7759]: warning: connect to mysql server localhost: Can't connect to local MySQL server through socket '/var/run/mysqld/mysqld.sock' (2)\nNov 14 21:54:52 ns1 postfix/trivial-rewrite[7759]: fatal: mysql:/etc/postfix/mysql-virtual-alias-maps.cf(0,lock|fold_fix): table lookup problem\nNov 14 21:54:53 ns1 postfix/master[1670]: warning: process /usr/lib/postfix/trivial-rewrite pid 7759 exit status 1\nNov 14 21:54:53 ns1 postfix/cleanup[7397]: warning: problem talking to service rewrite: Connection reset by peer\nNov 14 21:54:53 ns1 postfix/master[1670]: warning: /usr/lib/postfix/trivial-rewrite: bad command startup -- throttling\nNov 14 21:54:53 ns1 postfix/smtpd[7071]: warning: problem talking to service rewrite: Success\n</code></pre>\n\n<p>I tried <code>netstat -ln | grep mysql</code> and it returns </p>\n\n<p><code>unix  2      [ ACC ]     STREAM     LISTENING     5817     /var/run/mysqld/mysqld.sock</code>.</p>\n\n<p>The content of <code>/etc/postfix/mysql-virtual-alias-maps.cf</code> file is here:</p>\n\n<pre><code>user = stevejobs\npassword = apple\nhosts = localhost\ndbname = mailserver\nquery = SELECT destination FROM virtual_aliases WHERE source='%s'\n</code></pre>\n\n<p>Here I tried to change <code>hosts = 127.0.0.1</code> but it says <code>warning: connect to mysql server 127.0.0.1: Can't connect to MySQL server on '127.0.0.1' (110)</code></p>\n\n<p>So, I am lost and don't know where else to change in order to solve the problem. Any help would be appreciated highly. </p>\n\n<p>Thank you.</p>\n\n<p><strong>EDIT 1</strong></p>\n\n<p>When I do netstat -na I see that mysql is not bind neither to localhost nor to 127.0.0.1. Could it be the problem also? </p>\n\n<pre><code>bakhtiyor@ns1:~$ netstat -na | grep 3306\ntcp        0      0 0.0.0.0:3306            0.0.0.0:*               LISTEN   \n</code></pre>\n"}]}]