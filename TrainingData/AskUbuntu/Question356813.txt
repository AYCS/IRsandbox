[{"id":356813,"title":"dns configuration problem bind9","body":"<p>Following is my bind9 configuration \nthe domain I want to configure is home.lan it is home network\n/etc/bind/named.conf.local is following</p>\n\n<pre><code>zone \"home.lan\" IN {\n    type master;\n    file \"/etc/bind/zones/home.lan.db\";\n};\nzone \"1.168.192.in-addr.arpa\" {\n    type master;\n    file \"/etc/bind/zones/rev.1.168.192.in-addr.arpa\";\n};\n</code></pre>\n\n<p>/etc/bind/named.conf.options is following</p>\n\n<pre><code>options {\n        directory \"/var/cache/bind\";\n\n        // If there is a firewall between you and nameservers you want\n        // to talk to, you may need to fix the firewall to allow multiple\n        // ports to talk.  See http://www.kb.cert.org/vuls/id/800113\n\n        // If your ISP provided one or more IP addresses for stable\n        // nameservers, you probably want to use them as forwarders.\n        // Uncomment the following block, and insert the addresses replacing\n        // the all-0's placeholder.\n\n        // forwarders {\n        //      0.0.0.0;\n        // };\n\n        //========================================================================\n        // If BIND logs error messages about the root key being expired,\n        // you will need to update your keys.  See https://www.isc.org/bind-keys\n        //========================================================================\n        dnssec-validation auto;\n\n        auth-nxdomain no;    # conform to RFC1035\n        listen-on-v6 { any; };\n};\n</code></pre>\n\n<p>since it is a personal network I do not need any forwarders section,so did not configured it.</p>\n\n<p>/etc/bind/zones/home.lan.db</p>\n\n<pre><code>; Use semicolons to add comments.\n; Host-to-IP Address DNS Pointers for home.lan\n; Note: The extra “.” at the end of the domain names are important.\n\n; The following parameters set when DNS records will expire, etc.\n; Importantly, the serial number must always be iterated upward to prevent\n; undesirable consequences. A good format to use is YYYYMMDDII where\n; the II index is in case you make more that one change in the same day.\n$ORIGIN .\n$TTL 86400      ; 1 day\nhome.lan. IN SOA ubuntu.home.lan. hostmaster.home.lan. kalu.home.lan. (\n    2008080901 ; serial\n    8H ; refresh\n    4H ; retry\n    4W ; expire\n    1D ; minimum\n)\n\n; NS indicates that ubuntu is the name server on home.lan\n; MX indicates that ubuntu is (also) the mail server on home.lan\nhome.lan. IN NS kalu.home.lan.\nhome.lan. IN MX 10 ubuntu.home.lan.\n\n$ORIGIN home.lan.\n\n; Set the address for localhost.home.lan\nlocalhost    IN A 127.0.0.1\n\n; Set the hostnames in alphabetical order\nhome         IN A 192.168.1.7\nntinstall    IN A 192.168.1.7\nkalu         IN A 192.168.1.7\nrouter       IN A 192.168.1.1\nserver       IN A 192.168.1.5\n</code></pre>\n\n<p>and /etc/bind/zones/rev.1.168.192.in-addr.arpa</p>\n\n<pre><code>; IP Address-to-Host DNS Pointers for the 192.168.1 subnet\n@ IN SOA ubuntu.home.lan. hostmaster.home.lan. (\n    2008080901 ; serial\n    8H ; refresh\n    4H ; retry\n    4W ; expire\n    1D ; minimum\n)\n; define the authoritative name server\n           IN NS ubuntu.home.lan.\n; our hosts, in numeric order\n1         IN PTR router.home.lan.\n2         IN PTR ubuntu.home.lan.\n3         IN PTR ntinstall.home.lan.\n4         IN PTR kalu.home.lan.\n</code></pre>\n\n<p>and /etc/hostnames</p>\n\n<pre><code>kalu\n</code></pre>\n\n<p>and /etc/resolv.conf on bind9 server is </p>\n\n<pre><code># Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)\n#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN\nnameserver 127.0.0.1\nsearch home.lan\n\n\nat the client machine\n/etc/resolv.conf\n\n# Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)\n#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN\nnameserver 127.0.0.1\nnameserver 192.168.1.7\nsearch home.lan\n</code></pre>\n\n<p>and from client machine when I try to ping\nI get </p>\n\n<pre><code>$ ping kalu.home.lan\nping: unknown host kalu.home.lan\n</code></pre>\n\n<p>there is no file like /var/log/bind.log\nso not sure where to look for\nhere is dig output at server</p>\n\n<p>dig kalu.home.lan</p>\n\n<pre><code>; &lt;&lt;&gt;&gt; DiG 9.8.1-P1 &lt;&lt;&gt;&gt; kalu.home.lan\n;; global options: +cmd\n;; Got answer:\n;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: SERVFAIL, id: 36937\n;; flags: qr rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 0, ADDITIONAL: 0\n\n;; QUESTION SECTION:\n;kalu.home.lan.         IN  A\n\n;; Query time: 0 msec\n;; SERVER: 127.0.0.1#53(127.0.0.1)\n;; WHEN: Fri Oct 11 23:59:03 2013\n;; MSG SIZE  rcvd: 31\n</code></pre>\n\n<p>and at the client machine dig kalu.home.lan gives following</p>\n\n<pre><code> dig kalu.home.lan\n\n; &lt;&lt;&gt;&gt; DiG 9.8.1-P1 &lt;&lt;&gt;&gt; kalu.home.lan\n;; global options: +cmd\n;; Got answer:\n;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NXDOMAIN, id: 25537\n;; flags: qr rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 1, ADDITIONAL: 0\n\n;; QUESTION SECTION:\n;kalu.home.lan.         IN  A\n\n;; AUTHORITY SECTION:\n.           7388    IN  SOA a.root-servers.net. nstld.verisign-grs.com. 2013101101 1800 900 604800 86400\n\n;; Query time: 43 msec\n;; SERVER: 127.0.0.1#53(127.0.0.1)\n;; WHEN: Fri Oct 11 23:59:34 2013\n;; MSG SIZE  rcvd: 106\n</code></pre>\n\n<p>what is the mistake in above dns configuration?\nkalu is the hostname of machine on which I am configuring all this.</p>\n\n<p>To enable loggin in bind 9 <code>rndc querylog</code>\nit shows</p>\n\n<pre><code>Oct 12 01:42:16 ubuntu named[11408]: dns_rdata_fromtext: /etc/bind/zones/home.lan.db:11: near 'kalu.home.lan.': not a valid number\nOct 12 01:42:16 ubuntu named[11408]: zone home.lan/IN: loading from master file /etc/bind/zones/home.lan.db failed: not a valid number\nOct 12 01:42:16 ubuntu named[11408]: zone home.lan/IN: not loaded due to errors.\nOct 12 01:42:16 ubuntu named[11408]: zone localhost/IN: loaded serial 2\nOct 12 01:42:16 ubuntu named[11408]: managed-keys-zone ./IN: loaded serial 5\n</code></pre>\n\n<p>and I see</p>\n\n<pre><code> sudo named-checkzone home.lan home.lan.db\n[sudo] password for hp: \nzone home.lan/IN: loading from master file home.lan.db failed: file not found\nzone home.lan/IN: not loaded due to errors.\n</code></pre>\n","related_questions":[{"id":704144,"title":"Bind9 basic configuration for internal network with windows pcs","body":"<p>I have a network with more than 50 PCs running on Windows, Mac ans Ubuntu. We have one internal Web Site running in a windows 8 PC IIS on the IP 192.168.0.110.</p>\n\n<p>Right now we all can access this website by typing 192.168.0.110 in the browser address bar.But the current requirement is we need to access this website by simply typing the website name in the browser (www.internaltest.com). I think by using a Ubuntu PC with bind9 can do the work. </p>\n\n<p>I tried to configure but i stuck with these two configurations. What are the configuration supposed to be here?? can anyone help me??\nI don't want this website to be accessed from outside so this DNS server wants to be worked in internal network only.</p>\n\n<p>-No domain name (if necessary we can give testing.com as domain name)</p>\n\n<p>-Web server IP= 192.168.0.110  (Os Win8.1)</p>\n\n<p>-Web site name= www.internaltest.com</p>\n\n<p>-Web server name= tesingteam</p>\n\n<p>-web server username= adminweb </p>\n\n<p>-router ip= 192.168.0.1 (default gateway)</p>\n\n<p>-Dns server ip= 192.168.0.19   (Os Ubuntu 14.04)</p>\n\n<p>-Dns server name= dnsmaster</p>\n\n<p>-Dns server username= admindns</p>\n\n<p>With these data how these files suppose to be?</p>\n\n<p>**1 Forward zone file</p>\n\n<p>2 Reverse zone file**</p>\n\n<p>Any help is greatly appreciated, thanks. </p>\n"},{"id":688695,"title":"How to setup bind9 as simple name resolver?","body":"<h2>What?</h2>\n\n<p>I want to setup my own dns resolver. For everything that is not in 192.168.178.0/24 forward it to google dns (8.8.8.8 and 4.4.4.4 as fallback). So I just want to setup the nameserver of every host to lets say ``192.168.178.10` and that should be everything I need.<br>\nHow can I setup bind9 doing this?</p>\n\n<h2>Why?</h2>\n\n<p>My Fritz!Box is just not resolving most of the hostnames in my network. And I'm pretty sick of it - I tried troubleshooting it but the web interface is not very helpfull. It's not possible to telnet into it anymore because of firmware restrictions.</p>\n"},{"id":637944,"title":"Setting up an intranet by Apache2 and Bind9","body":"<p>I need some support to setup an intranet.</p>\n\n<p>ENVIRONMENT</p>\n\n<p>A LAN (192.168.1.x) conntected to Internet through an ADSL modem/router (192.168.1.1). \nAn Ubuntu 14 server (192.168.1.111) is connected to the LAN too.</p>\n\n<p>WHAY I WISH TO DO</p>\n\n<p>Create an intranet domain (sample.lan) installing Apache2 and Bind9 on the server (server.sample.lan).\nApache2 will serve requests on port 80 for www.sample.lan whereas w3.sample.lan will be redirected to server.sample.lan:888</p>\n\n<p>WHAT I DID </p>\n\n<ol>\n<li>I installed Apache2 and Bind9 on the server.</li>\n<li>I created and configured a named.conf.options for bind9</li>\n</ol>\n\n<pre>\n    acl \"trusted\" {\n        192.168.1.1;     # router\n        192.168.1.111;    # server\n    };\n\n    options {\n        directory \"/var/cache/bind\";\n\n        recursion yes;                    \n        allow-recursion { trusted; };    \n        listen-on { 192.168.1.111; };    \n        allow-transfer { none; };        \n\n        forwarders {\n            192.168.1.1;     # router\n            8.8.8.8;        # Google\n            91.80.35.166;    # ISP\n        };\n\n        dnssec-validation auto;\n\n        auth-nxdomain no;    # conform to RFC1035\n        listen-on-v6 { any; };\n    };\n</pre>\n\n<ol start=\"3\">\n<li>I created and configured a named.conf.local for bind9</li>\n</ol>\n\n<pre>\n    zone \"sample.lan\" {\n        type master;\n        file \"/etc/bind/db.sample.lan\";\n    };\n\n    zone \"1.168.192.in-addr.arpa\" {\n        type master;\n        file \"/etc/bind/db.192\";\n    };\n</pre>\n\n<ol start=\"4\">\n<li>I created and configured a db.sample.lan for bind9</li>\n</ol>\n\n<pre>\n    $TTL    604800\n    @    IN    SOA    server.sample.lan. webmaster.sample.lan. (\n                      3        ; Serial\n                 604800        ; Refresh\n                  86400        ; Retry\n                2419200        ; Expire\n                 604800 )    ; Negative Cache TTL\n    ;\n        IN    NS    server.sample.lan.\n    ; Below are A Record addresses\n    gateway.sample.lan.        IN    A    192.168.1.1\n    server.sample.lan.        IN    A    192.168.1.111\n    www.sample.lan.            IN    A    192.168.1.111\n    w3.sample.lan.            IN    A    192.168.1.111\n    ; Below are CNAME records addresses\n    www.sample.lan.        IN    CNAME    sample.lan.\n</pre>\n\n<ol start=\"5\">\n<li>I created and configured a db.192 for bind9</li>\n</ol>\n\n<pre>\n    $TTL    604800\n    @    IN    SOA    server.sample.lan. webmaster.sample.lan. (\n                      3        ; Serial\n                 604800        ; Refresh\n                  86400        ; Retry\n                2419200        ; Expire\n                 604800 )    ; Negative Cache TTL\n    ; name servers - NS records\n        IN    NS    server.sample.lan.\n    ; PTR records\n    1    IN    PTR    gateway.sample.lan.\n    111    IN    PTR    server.sample.lan.\n</pre>\n\n<ol start=\"6\">\n<li>I created and configured a httpd.conf for apache2</li>\n</ol>\n\n<pre>\n    ServerName localhost\n</pre>\n\n<ol start=\"7\">\n<li>I created and configured a 000-default.conf for apache2 and activated by a2ensite command</li>\n</ol>\n\n<pre>\n     &lt;VirtualHost *:80&gt;\n        ServerAdmin webmaster@sample.lan\n        ServerName www.sample.lan\n        ServerAlias sample.lan\n        DocumentRoot /var/www/html\n        &lt;Directory /var/www/html&gt;\n            Options Indexes FollowSymLinks MultiViews\n            AllowOverride All\n            Order Allow,Deny\n            Allow from All\n        &lt;/Directory&gt;\n        LogLevel warn\n        ErrorLog ${APACHE_LOG_DIR}/www.error.log\n        CustomLog ${APACHE_LOG_DIR}/www.access.log combined\n    &lt;/VirtualHost&gt;\n</pre>\n\n<ol start=\"8\">\n<li>I created and configured a 001-w3.conf for apache2 and activated by a2ensite command</li>\n</ol>\n\n<pre>\n     &lt;VirtualHost *:80&gt;\n        ServerAdmin webmaster@sample.lan\n        ServerName w3.sample.lan\n        DocumentRoot /var/www/w3/\n        &lt;Directory /var/www/w3&gt;\n            AllowOverride None\n            Order Deny,Allow\n            Deny from All\n        &lt;/Directory&gt;\n        &lt;Proxy *&gt;\n            Order allow,deny\n            Allow from all\n        &lt;/Proxy&gt;\n        ProxyPass / http://server.sample.lan:888/\n        ProxyPassReverse / http://server.sample.lan:888/\n        LogLevel warn\n        CustomLog ${APACHE_LOG_DIR}/w3.access.log combined\n    &lt;/VirtualHost&gt;\n</pre>\n\n<p>I restarted/reloaded services when needed, rebooted when needed.</p>\n\n<p>RESULTS</p>\n\n<p>I can access server.sample.lan:888 but if I try to access</p>\n\n<pre>\n    www.sample.lan\n    w3.sample.lan\n    sample.lan\n</pre>\n\n<p>no page is loaded. What I did wrong?</p>\n"},{"id":620381,"title":"Need to host 30 domains, but Bind9 config info is confusing","body":"<p>Bringing up a new server using ubuntu 15.04, Bind9 and Apache 2.4 that needs to host 30 web sites - each with own domain name. Have configured Apache virtual hosts and all seem correct, but Bind must not be passing info to Apache as the default host xyz.net web pages are always displayed even though I enter other domain names like abc.com, bcd.org, etc.</p>\n\n<p>I think the problem must be in how named.conf.local is configured (including the associated abc.com.db bcd.org.db files) - but I cannot find a tutorial that covers this. </p>\n\n<p>Right now my <strong>named.conf.local</strong> looks like this: (except the in-addr.arpa really uses an external IP address rather than a private one)</p>\n\n<pre><code>zone \"xyz.net\" {\n type master;\n file \"/etc/bind/zones/xyz.net.db\";\n };\n\n zone \"abc.com\" {\n type master;\n file \"/etc/bind/zones/abc.com.db\";\n };\n\n zone \"bcd.org\" {\n type master;\n file \"/etc/bind/zones/bcd.org.db\";\n };\n\n zone \"1.1.10.in-addr.arpa\" {\n type master;\n file \"/etc/bind/zones/rev.1.1.10.in-addr.arpa\";\n };\n</code></pre>\n\n<p>The contents of <strong>xyz.net.db</strong> are:</p>\n\n<pre><code> ; BIND data file for xyz.net\n ;\n $TTL 14400\n @ IN SOA ns1.xyz.net. tuv.xyz.net. (\n 201505061 ; Serial\n 7200 ; Refresh\n 120 ; Retry\n 2419200 ; Expire\n 60480) ; Default TTL\n ;\n xyz.net. IN NS ns1.xyz.net.\n xyz.net. IN NS ns2.xyz.net.\n\n xyz.net. IN MX 10 mail.xyz.net.\n xyz.net. IN A 10.1.1.33\n\n ns1 IN A 10.1.1.33\n ns2 IN A 10.1.1.33\n www IN CNAME xyz.net.\n mail IN A 10.1.1.33\n ftp IN CNAME xyz.net.\n xyz.net. IN TXT \"V=spf1 ip4:10.1.1.33 a mx ~all\"\n mail IN TXT \"V=spf1 a -all\"\n</code></pre>\n\n<p>and this is essentially the same as the virtual domain file <strong>bcd.org.db</strong> except (I would assume) that the nameserver names should be those of the primary domain.</p>\n\n<pre><code>; BIND data file for bcd.org\n ;\n $TTL 14400\n @ IN SOA ns1.xyz.net. tuv.xyz.net. (\n 201505061 ; Serial\n 7200 ; Refresh\n 120 ; Retry\n 2419200 ; Expire\n 60480) ; Default TTL\n ;\n bcd.org. IN NS ns1.xyz.net.\n bcd.org. IN NS ns2.xyz.net.\n\n bcd.org. IN MX 10 mail.bcd.org.\n bcd.org. IN A 10.1.1.33\n\n ns1 IN A 10.1.1.33\n ns2 IN A 10.1.1.33\n www IN CNAME xyz.net.\n mail IN A 10.1.1.33\n ftp IN CNAME bcd.org.\n xyz.net. IN TXT \"V=spf1 ip4:10.1.1.33 a mx ~all\"\n mail IN TXT \"V=spf1 a -all\"\n</code></pre>\n\n<p>Does this make sense? or am I wandering down the wrong road?</p>\n"},{"id":257209,"title":"Bind9 - openssl problem","body":"<p>when I try to start bind9; simply fail because of chroot &amp; openssl</p>\n\n<pre><code>/etc/init.d/bind9 start\n</code></pre>\n\n<p>log messages;</p>\n\n<pre><code>Feb 17 08:26:27 ISTVS2024 named[2440]: initializing DST: openssl failure\nFeb 17 08:26:27 ISTVS2024 named[2440]: exiting (due to fatal error)\nFeb 17 08:26:27 ISTVS2024 kernel: [   92.091098] type=1400 audit(1361082387.173:14): apparmor=\"DENIED\" operation=\"file_mmap\" parent=2439 profile=\"/usr/sbin/named\" name=\"/var/named/run-root/usr/lib/x86_64-linux-gnu/openssl-1.0.0/engines/libgost.so\" pid=2440 comm=\"named\" requested_mask=\"m\" denied_mask=\"m\" fsuid=108 ouid=0\n</code></pre>\n\n<p>If I didnt miss a point Apparmor denies it;</p>\n\n<p>my usr.sbin.named file already contains these lines:</p>\n\n<pre><code>/var/named/run-root/** rw,\n/var/named/run-root/usr/** rw,\n</code></pre>\n\n<p>also I can confirm that this file ;</p>\n\n<pre><code>/var/named/run-root/usr/lib/x86_64-linux-gnu/openssl-1.0.0/engines/libgost.so\n</code></pre>\n\n<p>exist in filesystem.</p>\n\n<p>Literally, I'm stuck, what other options I have, to fix this issue ?</p>\n\n<p>Maybe, removing apparmor completely is a solution, but I didnt wanna do that</p>\n"},{"id":577885,"title":"Bind9 and Name Collison","body":"<p>I have setup BIND9 as a DNS server for my home network so I can reach other machines via their hostnames.  All hosts are on a private network with the domain name hive.local, each reach the global Internet through a router via NAT.  </p>\n\n<p>I have run in to an issue with machines I put on this new DNS server that if I ping certain words that appear to be newly released TLDs (prod, android, chrome, ect.) I get a response from 127.0.53.53. This seems to be due to a a policy enacted by ICANN in order to prevent name collision.  </p>\n\n<p>I would like to make it so that if I ping any of these addresses it returns 'unknown host' as it does if I point any of my clients directly to an external DNS server.  My problem is that I am having a difficult time finding any information on how to do this. Below are the contents of the relevant configuration files.</p>\n\n<p>named.conf.options</p>\n\n<pre><code>acl \"trusted\" {\n    localhost;\n    192.168.0.0/24;\n};\n\ninclude \"/etc/bind/rndc.key\";\n\noptions {\n   directory \"/var/cache/bind\";\n   allows recursive queries from \"trusted\" clients\n   allow-recursion { trusted; };\n   listen-on-v6 { none; };\n   listen-on { 127.0.0.1; 192.168.0.25; };\n   allow-transfer { none; };\n   allow-query { trusted;};\n\nforwarders {\n   192.168.0.1;\n    };  \n\ndnssec-validation auto;\nauth-nxdomain no;    # conform to RFC1035\n};\n</code></pre>\n\n<p>named.conf.local</p>\n\n<pre><code>zone \"hive.local\" {\n   type master;\n   file \"/var/lib/bind/db.hive.local\"; # zone file path\n   check-names ignore;\n   allow-update { key rndc-key; };\n};\n\nzone \"0.168.192.in-addr.arpa\" {\n   type master;\n   file \"/var/lib/bind/db.0.168.192\";  # 192.168.0.0/24 subnet\n   check-names ignore;\n   allow-update { key rndc-key; };\n};\n</code></pre>\n\n<p>db.hive.local</p>\n\n<pre><code>ORIGIN hive.local.\n$TTL 604800 ; 1 week\n@       IN  SOA ns1.hive.local. admin.hive.local. (\n                65         ; serial\n                604800     ; refresh (1 week)\n                86400      ; retry (1 day)\n                2419200    ; expire (4 weeks)\n                604800     ; minimum (1 week)\n                )\n            NS  ns1.hive.local.\n$TTL 3600   ; 1 hour\nandroid-3b634a5ef70519d A   192.168.0.57\n            TXT \"31fb8e76e796718b41a1a502c2798c142d\"\n$TTL 604800 ; 1 week\nash         A   192.168.0.15\nbrix            A   192.168.0.43\nbrother     A   192.168.0.254\ncentos7     A   192.168.0.27\ndebian      A   192.168.0.24\n$TTL 3600   ; 1 hour\niPad            A   192.168.0.52\n            TXT \"31a3dfb1b5eec76ca28b39ad46b92846e2\"\n$TTL 604800 ; 1 week\njohn_henry      A   192.168.0.22\njoshua      A   192.168.0.11\nlinux-mini      A   192.168.0.41\nmunin           A   192.168.0.26\nnagios      A   192.168.0.30\nns1         A   192.168.0.25\nrouter          A   192.168.0.1\nwin8            A   192.168.0.23\n</code></pre>\n\n<p>db.0.168.192</p>\n\n<pre><code>$ORIGIN .\n$TTL 604800 ; 1 week\n0.168.192.in-addr.arpa  IN SOA  ns1.hive.local. admin.hive.local. (\n                36         ; serial\n                604800     ; refresh (1 week)\n                86400      ; retry (1 day)\n                2419200    ; expire (4 weeks)\n                604800     ; minimum (1 week)\n                )\n            NS  ns1.hive.local.\n$ORIGIN 0.168.192.in-addr.arpa.\n1           PTR router.hive.local.\n11          PTR joshua.hive.local.\n15          PTR ash.hive.local.\n22          PTR john_henry.hive.local.\n23          PTR win8.hive.local.\n24          PTR debian.hive.local.\n25          PTR ns1.hive.local.\n254         PTR brother.hive.local.\n26          PTR munin.hive.local.\n27          PTR centos7.hive.local.\n30          PTR nagios.hive.local.\n41          PTR linux-mini.hive.local.\n43          PTR brix.hive.local.\n$TTL 3600   ; 1 hour\n52          PTR iPad.hive.local.\n57          PTR android-3b634a5ef70519d.hive.local.\n</code></pre>\n\n<p>Edited for readbility and clarity.</p>\n"},{"id":571084,"title":"Why won&#39;t my BIND / Apache configuration work?","body":"<p>I am trying to set up a BIND configuration with an Apache webserver. What I am trying to achieve is to by using the URL www.exampler.net access the content that can be found on my Apache webserver's /var/www/html folder. I am doing this on one machine which has the IP address 192.168.1.4. When I dig www.exampler.net while my Wired connection is on, it will only find Google's nameservers, but why I turn off my Wired connection it will instantly find my ns1.exampler.net. Why is that? Furthermore by writing www.exampler.net into the browser it won't redirect me to my local website which can be found in /var/www/html but by writing 192.168.1.4 i it will.</p>\n\n<p>/etc/bind/named.conf.local</p>\n\n<pre><code>zone \"exampler.net\"{\n        type master;\n        file \"/etc/bind/zones/db.exampler.net\";\n};\n</code></pre>\n\n<p>/etc/bind/zones/db.exampler.net</p>\n\n<pre><code>;\n; exampler.net = domain name\n;\n$TTL    604800\nexampler.net.   IN      SOA     ns1.exampler.net. admin.localhost. (\n                              2         ; Serial\n                         604800         ; Refresh\n                          86400         ; Retry\n                        2419200         ; Expire\n                         604800 )       ; Negative Cache TTL\n; name servers\nexampler.net.   IN      NS      ns1.exampler.net.\n\n; ip addresses\nns1     IN      A       192.168.1.4\nwww     IN      A       192.168.1.4\n</code></pre>\n\n<p>/etc/apache2/sites-available/000-default.conf</p>\n\n<pre><code>&lt;VirtualHost *:80&gt;\n        ServerName exampler.net:80\n        ServerAlias www.exampler.net\n\n        ServerAdmin webmaster@localhost\n        DocumentRoot /var/www/html\n\n        ErrorLog ${APACHE_LOG_DIR}/error.log\n        CustomLog ${APACHE_LOG_DIR}/access.log combined\n&lt;/VirtualHost&gt;\n</code></pre>\n\n<p>I am using Ubuntu 14.04.1. I want to do this only locally, so that the hosts on my LAN server can use the given domain name to access the website that can be found on my Apache/NS server. Thanks in advance!</p>\n"},{"id":529026,"title":"Problem with BIND9","body":"<p>I have been fighting with this problem for a long time...</p>\n\n<p>For some unknown reason for me, some addresses seem to don't resolve, when I try </p>\n\n<p><code>dig www.google.com.br @localhost</code></p>\n\n<p>it returns me:</p>\n\n<blockquote>\n  <p>; &lt;&lt;>> DiG 9.8.1-P1 &lt;&lt;>> www.google.com.br @localhost ;; global\n  options: +cmd ;; Got answer: ;; ->>HEADER&lt;&lt;- opcode: QUERY, status:\n  NOERROR, id: 46072 ;; flags: qr rd ra; QUERY: 1, ANSWER: 4, AUTHORITY:\n  4, ADDITIONAL: 4</p>\n  \n  <p>;; QUESTION SECTION: ;www.google.com.br.             IN      A</p>\n  \n  <p>;; ANSWER SECTION: www.google.com.br.      25      IN      A<br>\n  173.194.118.79 www.google.com.br.      25      IN      A       173.194.118.87 www.google.com.br.      25      IN      A       173.194.118.88 www.google.com.br.      25      IN      A       173.194.118.95</p>\n  \n  <p>;; AUTHORITY SECTION: google.com.br.          25      IN      NS<br>\n  ns3.google.com. google.com.br.          25      IN      NS<br>\n  ns1.google.com. google.com.br.          25      IN      NS<br>\n  ns4.google.com. google.com.br.          25      IN      NS<br>\n  ns2.google.com.</p>\n  \n  <p>;; ADDITIONAL SECTION: ns1.google.com.         27      IN      A<br>\n  216.239.32.10 ns2.google.com.         26      IN      A       216.239.34.10 ns3.google.com.         27      IN      A       216.239.36.10 ns4.google.com.         26      IN      A       216.239.38.10</p>\n  \n  <p>;; Query time: 0 msec ;; SERVER: 127.0.0.1#53(127.0.0.1) ;; WHEN: Fri\n  Sep 26 17:46:54 2014 ;; MSG SIZE  rcvd: 245</p>\n</blockquote>\n\n<p>Everything working fine.</p>\n\n<p>But when I try some specific hosts, like <strong>Hotmail</strong> or <strong>YouTube</strong>, it fails:</p>\n\n<pre><code>dig www.hotmail.com @localhost\n</code></pre>\n\n<blockquote>\n  <p>; &lt;&lt;>> DiG 9.8.1-P1 &lt;&lt;>> www.hotmail.com @localhost ;; global options:\n  +cmd ;; Got answer: ;; ->>HEADER&lt;&lt;- opcode: QUERY, status: SERVFAIL, id: 56204 ;; flags: qr rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 0,\n  ADDITIONAL: 0</p>\n  \n  <p>;; QUESTION SECTION: ;www.hotmail.com.               IN      A</p>\n  \n  <p>;; Query time: 44 msec ;; SERVER: 127.0.0.1#53(127.0.0.1) ;; WHEN: Fri\n  Sep 26 17:48:41 2014 ;; MSG SIZE  rcvd: 33</p>\n</blockquote>\n\n<p>But, if I try <code>dig +tcp www.hotmail.com @localhost</code> it works:</p>\n\n<blockquote>\n  <p>; &lt;&lt;>> DiG 9.8.1-P1 &lt;&lt;>> +tcp www.hotmail.com @localhost ;; global\n  options: +cmd ;; Got answer: ;; ->>HEADER&lt;&lt;- opcode: QUERY, status:\n  NOERROR, id: 41319 ;; flags: qr rd ra; QUERY: 1, ANSWER: 3, AUTHORITY:\n  5, ADDITIONAL: 5</p>\n  \n  <p>;; QUESTION SECTION: ;www.hotmail.com.               IN      A</p>\n  \n  <p>;; ANSWER SECTION: www.hotmail.com.        23      IN      CNAME<br>\n  dispatch.kahuna.glbdns2.microsoft.com.\n  dispatch.kahuna.glbdns2.microsoft.com. 23 IN A  65.55.85.12\n  dispatch.kahuna.glbdns2.microsoft.com. 23 IN A  157.55.104.76</p>\n  \n  <p>;; AUTHORITY SECTION: hotmail.com.            26      IN      NS<br>\n  ns5.msft.net. hotmail.com.            26      IN      NS<br>\n  ns2.msft.net. hotmail.com.            26      IN      NS<br>\n  ns3.msft.net. hotmail.com.            26      IN      NS<br>\n  ns1.msft.net. hotmail.com.            26      IN      NS<br>\n  ns4.msft.net.</p>\n  \n  <p>;; ADDITIONAL SECTION: ns5.msft.net.           25      IN      A<br>\n  65.55.226.140 ns2.msft.net.           25      IN      A       208.84.2.53 ns3.msft.net.           25      IN      A       213.199.180.53 ns1.msft.net.           25      IN      A       65.55.37.62 ns4.msft.net.           25      IN      A       208.76.45.53</p>\n  \n  <p>;; Query time: 7 msec ;; SERVER: 127.0.0.1#53(127.0.0.1) ;; WHEN: Fri\n  Sep 26 17:49:58 2014 ;; MSG SIZE  rcvd: 291</p>\n</blockquote>\n\n<p>Can anyone help me?</p>\n"},{"id":411521,"title":"Ubuntu Bind9 set up and resolv.conf","body":"<p>I found this tutorial the best I've come across and it works! Well done although I can't vote and comment on it due to my site privilege as yet.</p>\n\n<p><a href=\"http://askubuntu.com/questions/330148/how-do-i-do-a-complete-bind9-dns-server-configuration-with-a-hostname\">How do I do a complete BIND9 DNS Server Configuration with a hostname?</a></p>\n\n<p>My question is, I'm unsure about the resolv.conf file, where the tutorial states to insert the nameserver, domain and search. My resolv.conf file has a comment above it saying \"do not edit this file by hand - your changes will be overwritten\". Can anyone clarify this for me please?</p>\n\n<p>Thanks in advance,\nMario.</p>\n"},{"id":254211,"title":"Ubuntu 12.04 and bind9 not responding to queries","body":"<p>I'm trying to set up an authoritative DNS server with bind9 (9.8.1-P1) on Ubuntu 12.04.2 LTS (upgraded from Ubuntu 11.04) and I am encountering some problems. </p>\n\n<h2>External problem</h2>\n\n<p>When trying to check my DNS configuration with the following tools solvedns.com/biotechnics.ro and dnscheck.pingdom.com/?domain=biotechnics.ro they fail with output messages like \"<strong>Name server ns1.biotechnics.ro (89.36.94.53) does not answer queries</strong>\" or \"<strong>Your name server ns1.biotechnics.ro is NOT responding to NS record queries!</strong>\"</p>\n\n<p>Also, external online dig tools such as <a href=\"http://networking.ringofsaturn.com/Tools/dig.php\" rel=\"nofollow\">this</a> give back the following output:</p>\n\n<blockquote>\n  <p>; &lt;&lt;>> DiG 9.8.4-P1 &lt;&lt;>> @ns1.biotechnics.ro -t NS biotechnics.ro</p>\n  \n  <p>; (1 server found)</p>\n  \n  <p>;; global options: +cmd</p>\n  \n  <p>;; connection timed out; no servers could be reached</p>\n</blockquote>\n\n<h2>Primary TLD from Parent</h2>\n\n<p>The parent is set up the following way:</p>\n\n<pre><code>; &lt;&lt;&gt;&gt; DiG 9.8.4-P1 &lt;&lt;&gt;&gt; @primary.rotld.ro -t NS biotechnics.ro\n; (2 servers found)\n;; global options: +cmd\n;; Got answer:\n;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 7740\n;; flags: qr rd; QUERY: 1, ANSWER: 0, AUTHORITY: 2, ADDITIONAL: 2\n;; WARNING: recursion requested but not available\n\n;; QUESTION SECTION:\n;biotechnics.ro.            IN  NS\n\n;; AUTHORITY SECTION:\nbiotechnics.ro.     10800   IN  NS  ns2.biotechnics.ro.\nbiotechnics.ro.     10800   IN  NS  ns1.biotechnics.ro.\n\n;; ADDITIONAL SECTION:\nns1.biotechnics.ro. 10800   IN  A   89.36.94.53\nns2.biotechnics.ro. 10800   IN  A   141.85.169.100\n\n;; Query time: 279 msec\n;; SERVER: 192.162.16.18#53(192.162.16.18)\n;; WHEN: Tue Feb 12 05:40:50 2013\n;; MSG SIZE  rcvd: 100\n</code></pre>\n\n<h1>Configuration on ns1</h1>\n\n<pre><code>rsavu@host:/etc/bind$ head -40 named.conf\n// ----------------------- Options -----------------------\noptions {\n    // all relative paths use this directory as a base\n    directory \"/var/cache/bind\";\n    // version statement changed for security (to avoid hacking known weaknesses)\n    version \"not currently available\";\n    // This prevents bind from serving other than authoritative requests:\n    recursion no;\n    // disables all zone transfer requests for performance as well as security reasons\n    allow-transfer{none;};\n    dnssec-enable no; // zone not signed\n    minimal-responses yes; // optional - improved performance\n    additional-from-auth no; // optional - improved performance\n    additional-from-cache no; // optional - minimal performance change\n};\n\n// ----------------------- Logging -----------------------\n// log to /var/log/named/zytrax-named all events from info UP in severity (no debug)\n// uses 3 files in rotation swaps files when size reaches 250K\n// failure messages up to this point are in (syslog) /var/log/messages\nlogging{\n    channel custom_log{\n        file \"/var/log/bind9_info.log\" versions 3 size 250k;\n        severity debug;\n    };\n    category default{\n        custom_log;\n    };\n};\n\n// ----------------------- Zones -----------------------\nzone \"biotechnics.ro\" in{\n    type master;\n    file \"/etc/bind/db.biotechnics.ro\";\n    allow-transfer { 141.85.169.100; };\n    also-notify {141.85.169.100; };\n    allow-query { any; };\n};\n</code></pre>\n\n<h1>Zone file</h1>\n\n<pre><code>$ORIGIN .\n$TTL 36000      ; 10 hours\nbiotechnics.ro          IN SOA  ns1.biotechnics.ro. admin.biotechnics.ro. (\n                                2013021201 ; serial\n                                28800      ; refresh (8 hours)\n                                7200       ; retry (2 hours)\n                                604800     ; expire (1 week)\n                                86400      ; minimum (1 day)\n                                )\n                        NS      ns1.biotechnics.ro.\n                        NS      ns2.biotechnics.ro.\n                        A       81.181.152.23\n $ORIGIN biotechnics.ro.\nftp                     A       81.181.152.23\nns1.biotechnics.ro.                     A       89.36.94.53\nns2.biotechnics.ro.                     A       141.85.169.100\nwww                     A       81.181.152.23\n</code></pre>\n\n<h1>What I checked</h1>\n\n<ul>\n<li>There is no problem with the firewall (i disabled it for the moment)</li>\n<li>Dig from inside the hosts work</li>\n<li>Dig from slave works</li>\n<li>Putting recursion yes; doesn't solve the problem</li>\n<li>Netstat shows that port 53 is in use on UDP and TCP by named</li>\n<li>named-checkconf and named-checkzone issue no warning.</li>\n</ul>\n\n<p>What can be the problem? Any ideas? I don't understand what's happening and why isn't my host replying to queries.</p>\n\n<p>[Later edit] The slave is on Debian 4.0 and works very well (as you can see in the dns solvers above.</p>\n"}]}]